{{- $name := .Get 0 -}}
{{- $title := .Get "title" | default $name -}}

{{/* 核心：尝试从当前文章资源中匹配该文件 */}}
{{- $audio := .Page.Resources.GetMatch $name -}}
{{- $src := "" -}}

{{- if $audio -}}
    {{- $src = $audio.RelPermalink -}}
{{- else -}}
    {{/* 如果找不到，则视为 static 目录下的绝对路径 */}}
    {{- $src = $name | safeURL -}}
{{- end -}}

<div class="local-audio-wrapper" style="margin: 20px 0; background: var(--card-background); padding: 15px; border-radius: var(--card-border-radius); box-shadow: var(--shadow-l2);">
    <div class="audio-title" style="font-size: 14px; color: var(--card-text-color-main); margin-bottom: 10px; font-weight: bold; display: flex; align-items: center; gap: 8px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
        <span>{{ $title }}</span>
    </div>
    <audio controls preload="metadata" style="width: 100%; height: 40px;">
        <source src="{{ $src }}" type="audio/mpeg">
        </audio>
</div>