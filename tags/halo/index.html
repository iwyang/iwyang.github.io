<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="åšè§‚è€Œçº¦å–ï¼Œåšç§¯è€Œè–„å‘"><title>Halo</title><link rel=canonical href=https://bore.vip/tags/halo/><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap"><link rel=stylesheet href=/scss/style.min.e0ca62bfdf40e4f4a995690d2a23469b3b89812fad1113b54d41fbfbd567c077.css><meta property='og:title' content="Halo"><meta property='og:description' content="åšè§‚è€Œçº¦å–ï¼Œåšç§¯è€Œè–„å‘"><meta property='og:url' content='https://bore.vip/tags/halo/'><meta property='og:site_name' content="Bore's Notes"><meta property='og:type' content='website'><meta property='og:updated_time' content=' 2026-02-21T11:56:46+08:00 '><meta name=twitter:title content="Halo"><meta name=twitter:description content="åšè§‚è€Œçº¦å–ï¼Œåšç§¯è€Œè–„å‘"><link rel=alternate type=application/rss+xml href=https://bore.vip/tags/halo/index.xml><link rel="shortcut icon" href=/img/avatar.png><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar.png width=170 height=170 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Bore's Notes</a></h1><h2 class=site-description>åšè§‚è€Œçº¦å–ï¼Œåšç§¯è€Œè–„å‘</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/link/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>é“¾æ¥</span></a></li><li><a href=/shuoshuo/><svg class="icon icon-tabler icon-tabler-message-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 20l1.3-3.9A9 8 0 117.7 19L3 20"/><line x1="12" y1="12" x2="12" y2="12.01"/><line x1="8" y1="12" x2="8" y2="12.01"/><line x1="16" y1="12" x2="16" y2="12.01"/></svg>
<span>è¯´è¯´</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><main class="main full-width"><main class="main list-container"><style>.shuoshuo-tags-nav{display:flex;flex-wrap:wrap;gap:12px;margin-top:10px;margin-bottom:30px}.shuoshuo-tags-nav a{display:inline-flex;align-items:center;padding:6px 16px;border-radius:20px;background:var(--card-background);color:var(--card-text-color-secondary);font-size:14px;text-decoration:none;transition:all .3s ease;box-shadow:0 2px 4px rgba(0,0,0,4%);border:1px solid transparent}.shuoshuo-tags-nav a:hover{color:#1e90ff;border-color:#1e90ff}.shuoshuo-tags-nav a.active{background:#1e90ff;color:#fff!important;border-color:#1e90ff;box-shadow:0 4px 8px rgba(30,144,255,.3)}.shuoshuo-tags-nav a .tag-count{margin-left:4px;font-size:12px;opacity:.9}.meta-wrapper{display:flex!important;align-items:center!important;flex-wrap:wrap!important;line-height:1!important;gap:20px!important}.meta-item,.shuoshuo-edit-link a,.shuoshuo-time,.shuoshuo-updated-time{display:flex!important;align-items:center!important;gap:8px!important;font-size:14px!important;line-height:1!important;text-decoration:none;margin:0!important;padding:0!important;border:0!important;background:0 0!important;color:var(--card-text-color-secondary)!important;opacity:1!important;-webkit-tap-highlight-color:transparent!important;outline:none!important}.shuoshuo-meta svg,.shuoshuo-edit-link svg,.shuoshuo-time svg,.shuoshuo-updated-time svg{width:14px!important;height:14px!important;min-width:14px!important;display:block!important;margin:0!important;padding:0!important;position:static!important;transform:none!important;opacity:1!important;color:inherit!important}.meta-item span,.meta-item time,.shuoshuo-updated-time span,.shuoshuo-edit-link span{display:block!important;margin:0!important;padding:0!important;line-height:1!important;font-size:14px!important;font-family:inherit;font-weight:400!important;color:inherit!important}.shuoshuo-edit-link a,.shuoshuo-edit-link .git-hash-text{color:#1e90ff!important;transition:opacity .3s ease}.shuoshuo-edit-link .separator{color:#1e90ff!important;opacity:1!important}.shuoshuo-edit-link a:hover{opacity:.7!important;text-decoration:underline}.shuoshuo-tag{transition:color .3s ease,opacity .3s ease}.shuoshuo-tag:hover{color:#1e90ff!important;opacity:.8!important}</style><div class=shuoshuo-tags-nav><a href=/shuoshuo/>ğŸ·ï¸ å…¨éƒ¨ <span class=tag-count>20</span>
</a><a href=/tags/%E6%97%A5%E5%B8%B8/>#æ—¥å¸¸ <span class=tag-count>11</span>
</a><a href=/tags/%E6%8A%98%E8%85%BE/>#æŠ˜è…¾ <span class=tag-count>5</span>
</a><a href=/tags/%E8%BF%BD%E7%95%AA/>#è¿½ç•ª <span class=tag-count>4</span></a></div><div class=shuoshuo-list id=masonry-container style="opacity:0;transition:opacity .4s ease"><div class=waterfall-column id=waterfall-left><article class=shuoshuo-card><div class=shuoshuo-header><div class="shuoshuo-meta meta-wrapper"><time class="shuoshuo-time meta-item" datetime=2022-05-25T21:27:46Z><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span>2022-05-25</span>
</time><span class="shuoshuo-updated-time meta-item" datetime=2026-02-18T15:52:01+08:00><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4A2 2 0 002 6v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121.0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
<span>2026-02-18</span></span></div></div><div class="shuoshuo-content style-cs-content article-post"><p>æœ¬æ–‡å‚è€ƒï¼š</p><ul><li><a class=link href=https://bbchin.com/archives/halo-theme-joe20 target=_blank rel=noopener>Halo-theme-joe2.0 é£Ÿç”¨æ–‡æ¡£</a></li><li><a class=link href=https://bbchin.com/archives/style-guideline target=_blank rel=noopener>Joe2.0 æ ·å¼æŒ‡å—</a></li></ul><h2 id=å®‰è£…--æ›´æ–°>å®‰è£… & æ›´æ–°</h2><blockquote><p>å®‰è£…å‰è¯·ç¡®ä¿ Haloç‰ˆæœ¬ å’Œä¸»é¢˜çš„å…¼å®¹æ€§ï¼ŒV1.0.10 åŠä»¥ä¸Šç‰ˆæœ¬ä»…æ”¯æŒ Halo 1.5+ï¼Œä»¥ä¸‹ç‰ˆæœ¬å…¼å®¹åˆ° Halo 1.4.11ï¼Œè¯·çŸ¥æ‚‰ã€‚</p></blockquote><ol><li><p>å¤åˆ¶ä¸»é¢˜ä»“åº“åœ°å€ <a class=link href=https://github.com/qinhua/halo-theme-joe2.0.git target=_blank rel=noopener>https://github.com/qinhua/halo-theme-joe2.0.git</a></p></li><li><p>è¿›å…¥åšå®¢åå°ç®¡ç† å¤–è§‚-ä¸»é¢˜-å®‰è£…-è¿œç¨‹ä¸‹è½½ï¼Œè´´å…¥ä»“åº“åœ°å€è¿›è¡Œå®‰è£…ï¼ˆå»ºè®®ç›´æ¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ ï¼‰ã€‚
å¦‚æœåœ¨çº¿å®‰è£…å¤±è´¥ï¼ˆå¤§æ¦‚ç‡å¤±è´¥ ğŸ˜† ï¼‰ï¼Œé‚£å°±é€‰æ‹© æœ¬åœ°ä¸Šä¼ ï¼Œåˆ°ä¸»é¢˜ Release é¡µé¢ä¸‹è½½æŒ‡å®šç‰ˆæœ¬ä¸»é¢˜å‹ç¼©åŒ…ï¼Œå¹¶ä¸Šä¼ ä¸Šå»ï¼ˆåŠ¡å¿…åœ¨ Release é¡µé¢ä¸‹è½½å‹ç¼©åŒ…ï¼Œå¦åˆ™å¯èƒ½å‡ºç°èµ„æºåŠ è½½å‡ºé”™çš„é—®é¢˜ï¼‰ï¼›</p></li><li><p>ç­‰å¾…æç¤ºå®‰è£…å®Œæˆå³å¯ï¼›</p></li><li><p>æ›´æ–°ä¸»é¢˜æ—¶ï¼Œå»ºè®®ç›´æ¥é€šè¿‡ å¤–è§‚-ä¸»é¢˜-Joe2.0-æ›´å¤š-ä»ä¸»é¢˜åŒ…æ›´æ–° æŠŠä¸‹è½½å¥½çš„ zip åŒ…ä¸Šä¼ ä¸Šå»ï¼Œç„¶å å…ˆåˆ‡æ¢åˆ°å…¶ä»–ä¸»é¢˜ï¼Œå†åˆ‡å›æœ¬ä¸»é¢˜ï¼Œå¹¶è¿›å…¥ä¸»é¢˜è®¾ç½®æ‰§è¡Œä¸€æ¬¡ä¿å­˜ï¼Œæœ€åå¼ºåˆ·å‰ç«¯é¡µé¢å³å¯ï¼ˆè¿™é‡Œåˆ‡ä¸»é¢˜ä¸»è¦æ˜¯ä¸ºäº†é¿å…æœ‰æ—¶å€™ä¸»é¢˜çŠ¶æ€æœªæ¿€æ´»å’Œç¼“å­˜çš„é—®é¢˜ï¼‰ã€‚</p></li></ol><h2 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</h2><ol><li>å®‰è£…ä¸»é¢˜åè¯·åŠ¡å¿…åˆ° åå°ç®¡ç† - åšå®¢è®¾ç½® - é«˜çº§é€‰é¡¹ ä¸­å¼€å¯ APIæœåŠ¡ å¹¶é…ç½® Access key ä¸º joe2.0ï¼ˆåˆ‡è®°è¦å’Œä¸»é¢˜è®¾ç½®ä¸­çš„ AccessKey ä¸€è‡´ï¼‰ï¼Œä¸ç„¶éƒ¨åˆ†ç”¨åˆ° Content API çš„é¡µé¢ä¼šè¯·æ±‚å¤±è´¥å¹¶æŠ¥é”™ã€‚ï¼ˆè¯·å‚è€ƒä»¥ä¸‹æŠ¥é”™ï¼‰</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â€œAPI has been disabled by blogger currentlyâ€ â€”â€” åå°ç®¡ç†ä¸­æœªå¼€å¯APIæœåŠ¡
</span></span><span class=line><span class=cl>â€œAPI access key is mismatchâ€ â€”â€” ä¸»é¢˜ä¸­çš„ AccessKey å’Œåå°ç®¡ç†ä¸­çš„ä¸ä¸€è‡´
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><p>å¦‚æœåå°ç®¡ç†ä¸­ä¹‹å‰å·²ç»é…ç½®äº†å…¶å®ƒçš„ Access Keyï¼ˆå†…å®¹ä¸æ˜¯ joe2.0ï¼‰ï¼Œé‚£ä¹ˆéœ€è¦ä½ åˆ°æœ¬ä¸»é¢˜è®¾ç½®ä¸­çš„ åŸºæœ¬è®¾ç½®-AccessKey&lt;å¿…å¡«> åŒæ­¥ä¸€ä¸‹è¿™ä¸ª Access keyï¼Œä¿è¯ä¸¤éƒ¨ä¸€è‡´å³å¯ï¼ˆåˆ‡è®°ä¸€è‡´æ‰è¡Œï¼Œä¸”ä¸è¦å¡«å†™ä¸­æ–‡æˆ–ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚</p></li><li><p>æœ‰æ—¶ï¼Œä¸»é¢˜å‡çº§åé…ç½®é¡¹å˜åŒ–è¾ƒå¤§ï¼Œç›´æ¥è®¿é—®åšå®¢å¯èƒ½ä¼šæŠ¥é”™ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“ä¸å‡ºæ¥ã€‚æ­¤æ—¶ï¼Œåªéœ€è¦è¿›å…¥å½“å‰ä¸»é¢˜çš„è®¾ç½®ç•Œé¢æ‰§è¡Œä¸€ä¸‹ä¿å­˜æ“ä½œæ¥æ›´æ–°æ—§çš„é…ç½®ï¼Œç„¶åå†è®¿é—®é¡µé¢å³å¯ï¼›</p></li><li><p>æœ‰æ—¶ï¼Œæ˜æ˜å·²ç»æç¤ºä¸»é¢˜æ›´æ–°æˆåŠŸäº†ï¼Œä½†è®¿é—®åšå®¢æ—¶é¡µé¢è¿˜æ˜¯åŠ è½½çš„æ—§ç‰ˆæœ¬çš„æ–‡ä»¶ï¼Œå¯èƒ½æ˜¯ç”±äº ä¸»é¢˜æ¿€æ´»çŠ¶æ€ä¸æ­£å¸¸ æˆ– ä¸»é¢˜ç¼“å­˜çš„é—®é¢˜ å¯¼è‡´çš„ã€‚æ­¤æ—¶ï¼Œåªéœ€è¦å…ˆå¯ç”¨å…¶ä»–ä¸»é¢˜å†å¯ç”¨æœ¬ä¸»é¢˜å³å¯ï¼Œå»ºè®®æ¯æ¬¡æ›´æ–°ä¸»é¢˜ä¹‹åéƒ½åšä¸€ä¸‹è¿™ä¸ªæ“ä½œï¼ˆç›®å‰åå°ç®¡ç†ç³»ç»Ÿè¿˜ä¸å¤ªå®Œå–„ï¼‰ã€‚è¿˜æœ‰å°±æ˜¯å¦‚æœä½ é…ç½®äº† CDN æœåŠ¡ï¼Œè®°å¾—æ¸…ç†ç›¸åº”èŠ‚ç‚¹çš„ç¼“å­˜ï¼Œè®©å®ƒå›æºå–æœ€æ–°èµ„æºã€‚</p></li><li><p>å¼ºçƒˆå»ºè®® æ¯æ¬¡æ›´æ–°ä¸»é¢˜åï¼ŒåŠ¡å¿…å…ˆæ¸…ç©ºä¸€ä¸‹æµè§ˆå™¨ç¼“å­˜ï¼Œä¿è¯åŠ è½½çš„èµ„æºéƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ï¼Œå¹¶åˆ°ä¸»é¢˜è®¾ç½®ä¸­æ‰§è¡Œä¸€æ¬¡ä¿å­˜ï¼Œä¿è¯é…ç½®é¡¹æ˜¯æœ€æ–°çš„ï¼Œä¸ç„¶å¯èƒ½æœ‰å„ç§æŠ¥é”™ï¼ˆä½ å¯ä»¥é€šè¿‡ Ctrl + F5 å¼ºåˆ¶åˆ·æ–°æˆ–è€… Ctrl + Shift + DEL æ¸…ç©ºæµè§ˆå™¨æ‰€æœ‰ç¼“å­˜ï¼‰ã€‚</p></li><li><p>æœ€åï¼Œå»ºè®®å¤§å®¶åœ¨ åå°ç®¡ç†-ç³»ç»Ÿ-åšå®¢è®¾ç½®-é«˜çº§é€‰é¡¹-å…¶ä»–è®¾ç½® ä¸­å¼€å¯ å…¨å±€ç»å¯¹è·¯å¾„ã€‚</p></li></ol><h2 id=æ’å…¥å¤šåª’ä½“>æ’å…¥å¤šåª’ä½“</h2><h3 id=æ’å…¥éŸ³ä¹>æ’å…¥éŸ³ä¹</h3><p>æ€æ ·åœ¨æ–‡ç« ä¸­æ’å…¥ç½‘æ˜“äº‘æ’­æ”¾å™¨ï¼Ÿ</p><blockquote><p>idï¼šç½‘æ˜“äº‘æ­Œå• ID æˆ– æ­Œæ›² IDï¼ˆå¯ä»æ­Œæ›²ç½‘å€ä¸­è·å–ï¼‰</p></blockquote><ul><li>æ­Œå•</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-mlist id=&#34;6800335663&#34;&gt;&lt;/joe-mlist&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li>å•æ›²</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-music id=&#34;1303046498&#34;&gt;&lt;/joe-music&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li>æœ¬åœ°éŸ³ä¹</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>joe</span><span class=o>-</span><span class=n>mp3</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=o>=</span><span class=s2>&#34;å¤©ç”Ÿç‹‚é‡-æŸ´å¤å”æ–¯ä¸»é¢˜æ›²&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span><span class=o>=</span><span class=s2>&#34;https://bbchin.com/upload/2022/04/</span><span class=si>%E</span><span class=s2>5%A4%A9</span><span class=si>%E</span><span class=s2>7</span><span class=si>%94%</span><span class=s2>9F</span><span class=si>%E</span><span class=s2>7%8B</span><span class=si>%82%</span><span class=s2>E9</span><span class=si>%87%</span><span class=s2>8E-</span><span class=si>%E</span><span class=s2>6</span><span class=si>%9F</span><span class=s2>%B4</span><span class=si>%E</span><span class=s2>5</span><span class=si>%8F</span><span class=s2>%A4</span><span class=si>%E</span><span class=s2>5</span><span class=si>%94%</span><span class=s2>90</span><span class=si>%E</span><span class=s2>6</span><span class=si>%96%</span><span class=s2>AF</span><span class=si>%E</span><span class=s2>4%B8%BB</span><span class=si>%E</span><span class=s2>9%A2</span><span class=si>%98%</span><span class=s2>E6%9B%B2.mp3&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>theme</span><span class=o>=</span><span class=s2>&#34;red&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>cover</span><span class=o>=</span><span class=s2>&#34;https://bbchin.com/upload/2022/04/cgts.png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>autoplay</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&lt;/</span><span class=n>joe</span><span class=o>-</span><span class=n>mp3</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ’å…¥è§†é¢‘>æ’å…¥è§†é¢‘</h3><p>æ–‡ç« ä¸­å¦‚ä½•æ’å…¥è§†é¢‘ï¼Ÿ</p><blockquote><p>ä¸»é¢˜å·²é›†æˆ dplayerï¼Œåªéœ€è¦åœ¨ç¼–è¾‘æ–‡ç« æ—¶ä½¿ç”¨ joe-dplayer æ ‡ç­¾æ’å…¥è§†é¢‘åœ°å€å³å¯ï¼ˆå»ºè®® MP4 æ ¼å¼ï¼Œå…¶å®ƒæ ¼å¼æœªå¿…æ”¯æŒï¼Œåˆ‡è®°å‰åè¦ç©ºä¸€è¡Œï¼‰ï¼Œå®ƒæ¥å—å¦‚ä¸‹å±æ€§ï¼š</p></blockquote><ul><li>srcï¼šè§†é¢‘åœ°å€ï¼ˆå¿…ä¼ ï¼‰</li><li>widthï¼šé˜…è¯»å™¨å®½åº¦ï¼Œé»˜è®¤ä¸º 100%</li><li>heightï¼šé˜…è¯»å™¨é«˜åº¦ï¼Œé»˜è®¤ 500px</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;joe-dplayer <span class=nv>src</span><span class=o>=</span><span class=s2>&#34;https://xxx.mp4&#34;</span>&gt;&lt;/joe-dplyer&gt;
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœä½ æƒ³åµŒå…¥ <strong>Bç«™è§†é¢‘</strong>ï¼Œå¯ä»¥ä½¿ç”¨ joe-bilibili æ ‡ç­¾ï¼ˆåˆ‡è®°å‰åè¦ç©ºä¸€è¡Œï¼‰ï¼Œå®ƒæ¥å—å¦‚ä¸‹å±æ€§ï¼ˆç›¸å…³å‚æ•°å¯ä»¥ä»è§†é¢‘åœ°å€ä¸­è·å–ï¼‰ã€‚</p><ul><li>bvidï¼šè§†é¢‘çš„ idï¼ˆå¿…ä¼ ï¼‰</li><li>pageï¼šè§†é¢‘çš„ pageï¼Œå³åˆ†é¡µ</li><li>widthï¼šé˜…è¯»å™¨å®½åº¦ï¼Œé»˜è®¤ä¸º 100%</li><li>heightï¼šé˜…è¯»å™¨é«˜åº¦ï¼Œé»˜è®¤ 500px</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-bilibili bvid=&#34;BV12h411k7vr&#34;&gt;&lt;/joe-bilibili&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=æ–‡æœ¬å…ƒç´ >æ–‡æœ¬å…ƒç´ </h2><h3 id=æ®µè½ç¼©è¿›>æ®µè½ç¼©è¿›</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;indent&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  æœ‰äº›ç”·äººå°±åƒçƒ¤é¢ç­‹ï¼Œå¤–è¡¨é»„é»„çš„ï¼Œèº«ä½“åœ†åœ†çš„ï¼Œè¯´è¯æŸ”æŸ”çš„ï¼Œæ— å®³ï¼Œçœ‹ä¸Šå»è¿˜éå¸¸å¥½åƒã€‚å¯å½“ä½ åƒä¸‹å»ï¼Œæ‰çŸ¥é“ä»–ç»µç»µçš„ï¼Œå¹¶æ— ç‰¹åˆ«çš„å‘³é“ï¼Œç”šè‡³åˆ°ä½ åƒå®Œï¼Œä½ éƒ½ä¸çŸ¥é“ä»–æ˜¯ç”¨ä»€ä¹ˆåšçš„ã€‚
</span></span><span class=line><span class=cl>  ---- æä¸ƒæ¯›ã€Šæˆ‘ä»¬éƒ½ä¸æ“…é•¿å‘Šåˆ«ã€‹
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å±…ä¸­æ ‡é¢˜>å±…ä¸­æ ‡é¢˜</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>joe-mtitle</span> <span class=na>title</span><span class=o>=</span><span class=s>&#34;ç‰›é­ç‰›é­&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>joe-mtitle</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æŒ‰é’®å…ƒç´ >æŒ‰é’®å…ƒç´ </h2><h3 id=å¤šå½©æŒ‰é’®>å¤šå½©æŒ‰é’®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-abtn color=&#34;#409eff&#34; content=&#34;å¤šå½©æŒ‰é’®&#34;&gt;&lt;/joe-abtn&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-abtn color=#409eff content="å¤šå½©æŒ‰é’®"></joe-abtn></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-abtn icon=&#34;fa-bell&#34; content=&#34;å¸¦å›¾æ ‡æŒ‰é’®&#34;&gt;&lt;/joe-abtn&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-abtn icon=fa-bell content="å¸¦å›¾æ ‡æŒ‰é’®"></joe-abtn></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-abtn radius=&#34;12px&#34; content=&#34;åœ†è§’æŒ‰é’®&#34;&gt;&lt;/joe-abtn&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-abtn radius=12px content="åœ†è§’æŒ‰é’®"></joe-abtn></p><h3 id=ä¾¿æ¡æŒ‰é’®>ä¾¿æ¡æŒ‰é’®</h3><blockquote><p>ä¾¿æ¡æŒ‰é’®ä¸èƒ½è‡ªå®šä¹‰è‰²å½©ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªå›¾æ ‡ï¼Œå…¶ä»–çš„çš„å’Œä¸Šé¢çš„å¤šå½©æŒ‰é’®ä¸€æ ·</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-anote href=&#34;#&#34; type=&#34;secondary&#34; content=&#34;ä¾¿æ¡æŒ‰é’®&#34;&gt;&lt;/joe-anote&gt;
</span></span><span class=line><span class=cl>&lt;joe-anote icon=&#34;fa-bus&#34; href=&#34;#&#34; type=&#34;success&#34; content=&#34;ä¾¿æ¡æŒ‰é’®&#34;&gt;&lt;/joe-anote&gt;
</span></span><span class=line><span class=cl>&lt;joe-anote icon=&#34;fa-bus&#34; href=&#34;#&#34; type=&#34;warning&#34; content=&#34;ä¾¿æ¡æŒ‰é’®&#34;&gt;&lt;/joe-anote&gt;
</span></span><span class=line><span class=cl>&lt;joe-anote icon=&#34;fa-bus&#34; href=&#34;#&#34; type=&#34;error&#34; content=&#34;ä¾¿æ¡æŒ‰é’®&#34;&gt;&lt;/joe-anote&gt;
</span></span><span class=line><span class=cl>&lt;joe-anote icon=&#34;fa-bus&#34; href=&#34;#&#34; type=&#34;info&#34; content=&#34;ä¾¿æ¡æŒ‰é’®&#34;&gt;&lt;/joe-anote&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-anote href=# type=secondary content="ä¾¿æ¡æŒ‰é’®"></joe-anote><joe-anote icon=fa-bus href=# type=success content="ä¾¿æ¡æŒ‰é’®"></joe-anote><joe-anote icon=fa-bus href=# type=warning content="ä¾¿æ¡æŒ‰é’®"></joe-anote><joe-anote icon=fa-bus href=# type=error content="ä¾¿æ¡æŒ‰é’®"></joe-anote><joe-anote icon=fa-bus href=# type=info content="ä¾¿æ¡æŒ‰é’®"></joe-anote></p><h3 id=ç½‘ç›˜æŒ‰é’®>ç½‘ç›˜æŒ‰é’®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-cloud type=&#34;default&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;360&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;bd&#34; url=&#34;&#34; password=&#34;bn6f&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;ty&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;ct&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;wy&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;github&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;gitee&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span><span class=line><span class=cl>&lt;joe-cloud type=&#34;lz&#34; url=&#34;&#34; password=&#34;&#34;&gt;&lt;/joe-cloud&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-cloud type=default url password></joe-cloud><joe-cloud type=360 url password></joe-cloud><joe-cloud type=bd url password=bn6f></joe-cloud><joe-cloud type=ty url password></joe-cloud><joe-cloud type=ct url password></joe-cloud><joe-cloud type=wy url password></joe-cloud><joe-cloud type=github url password></joe-cloud><joe-cloud type=gitee url password></joe-cloud><joe-cloud type=lz url password></joe-cloud></p><h2 id=è£…é¥°å…ƒç´ >è£…é¥°å…ƒç´ </h2><h3 id=è·‘é©¬ç¯>è·‘é©¬ç¯</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;joe_lamp&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><span class=joe_lamp></span></p><h3 id=è¿›åº¦æ¡>è¿›åº¦æ¡</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-progress percentage=&#34;50%&#34; color=&#34;#6ce766&#34;&gt;&lt;/joe-progress&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-progress percentage=50% color=#6ce766></joe-progress></p><h3 id=å½©è‰²è™šçº¿>å½©è‰²è™šçº¿</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-dotted&gt;&lt;/joe-dotted&gt;
</span></span><span class=line><span class=cl>&lt;joe-dotted startcolor=&#34;#1772e8&#34; endcolor=&#34;#4cd327&#34;&gt;&lt;/joe-dotted&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-dotted></joe-dotted><joe-dotted startcolor=#1772e8 endcolor=#4cd327></joe-dotted></p><h3 id=tabs>Tabs</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-tabs&gt;
</span></span><span class=line><span class=cl>  &lt;div class=&#34;_tpl&#34;&gt;
</span></span><span class=line><span class=cl>    {tabs-pane ç¬¬ä¸€ä¸ª}å•èº«ç‹—çš„æ•…äº‹{/tabs-pane}
</span></span><span class=line><span class=cl>    {tabs-pane ç¬¬äºŒä¸ª}å°è¯´å®¶çš„æ•…äº‹{/tabs-pane}
</span></span><span class=line><span class=cl>  &lt;/div&gt;
</span></span><span class=line><span class=cl>&lt;/joe-tabs&gt;
</span></span></code></pre></td></tr></table></div></div><joe-tabs><div class=_tpl>{tabs-pane ç¬¬ä¸€ä¸ª}å•èº«ç‹—çš„æ•…äº‹{/tabs-pane}
{tabs-pane ç¬¬äºŒä¸ª}å°è¯´å®¶çš„æ•…äº‹{/tabs-pane}</div></joe-tabs><h3 id=æ—¶é—´çº¿>æ—¶é—´çº¿</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-timeline&gt;
</span></span><span class=line><span class=cl> &lt;div class=&#34;_tpl&#34;&gt;
</span></span><span class=line><span class=cl>   {timeline-item 2020}10å…ƒ{/timeline-item}
</span></span><span class=line><span class=cl>   {timeline-item 2021}20å…ƒ{/timeline-item}
</span></span><span class=line><span class=cl>   {timeline-item 2022}100å…ƒ{/timeline-item}
</span></span><span class=line><span class=cl> &lt;/div&gt;
</span></span><span class=line><span class=cl>&lt;/joe-timeline&gt;
</span></span></code></pre></td></tr></table></div></div><joe-timeline><div class=_tpl>{timeline-item 2020}10å…ƒ{/timeline-item}
{timeline-item 2021}20å…ƒ{/timeline-item}
{timeline-item 2022}100å…ƒ{/timeline-item}</div></joe-timeline><h3 id=è¯„è®ºåå¯è§>è¯„è®ºåå¯è§</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-hide&gt;&lt;/joe-hide&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=æç¤ºå…ƒç´ >æç¤ºå…ƒç´ </h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;joe-message type=&#34;success&#34; content=&#34;æˆåŠŸæ¶ˆæ¯&#34;&gt;&lt;/joe-message&gt;
</span></span><span class=line><span class=cl>&lt;joe-message type=&#34;info&#34; content=&#34;æ™®é€šæ¶ˆæ¯&#34;&gt;&lt;/joe-message&gt;
</span></span><span class=line><span class=cl>&lt;joe-message type=&#34;warning&#34; content=&#34;è­¦å‘Šæ¶ˆæ¯&#34;&gt;&lt;/joe-message&gt;
</span></span><span class=line><span class=cl>&lt;joe-message type=&#34;error&#34; content=&#34;é”™è¯¯æ¶ˆæ¯&#34;&gt;&lt;/joe-message&gt;
</span></span></code></pre></td></tr></table></div></div><p><joe-message type=success content="æˆåŠŸæ¶ˆæ¯"></joe-message><joe-message type=info content="æ™®é€šæ¶ˆæ¯"></joe-message><joe-message type=warning content="è­¦å‘Šæ¶ˆæ¯"></joe-message><joe-message type=error content="é”™è¯¯æ¶ˆæ¯"></joe-message></p><h2 id=å¸¸è§é—®é¢˜>å¸¸è§é—®é¢˜</h2><p>1.å¦‚ä½•è‡ªå®šä¹‰å¯¼èˆªæ¡èœå•å›¾æ ‡ï¼Ÿ</p><blockquote><p>ä¸»é¢˜è‡ªèº«å·²ç»å¼•å…¥äº†éƒ¨åˆ† iconfont å›¾æ ‡ï¼Œä½ å¯ä»¥ç›´æ¥ç”¨ï¼ˆå…¨åœ¨è¿™é‡Œï¼‰ï¼Œå¦‚æœæƒ³åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¢åŠ å›¾æ ‡ï¼Œå¯è”ç³»æˆ‘åŠ å…¥è¯¥é¡¹ç›®çš„å›¾æ ‡ç»„ï¼ŒåŠ å…¥åå³å¯è·å–æœ€æ–°çš„å­—ä½“é“¾æ¥è¿›è¡Œæ›¿æ¢ï¼ˆtemplate/module/link.ftl ä¸­ç¬¬ 25 è¡Œï¼‰ã€‚iconfont ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
ï¼ˆç›®å‰ä¸»é¢˜èœå•åªæ”¯æŒå­—ä½“å›¾æ ‡ï¼Œè‹¥è¦ç”¨å›¾ç‰‡è¯·è‡ªè¡Œä¿®æ”¹ä»£ç ï¼‰</p></blockquote><p>2.å¦‚ä½•è®¾ç½®æ–‡ç« ä»…è¯„è®ºåå¯è§ï¼Ÿ</p><blockquote><p>ä¸»é¢˜ç›®å‰æ”¯æŒæ–‡ç« é¡µçš„ è¯„è®ºåå¯è§åŠŸèƒ½ï¼Œåªè¦åœ¨åå°ç®¡ç†ä¸­å‘å¸ƒæ–‡ç« æ—¶è®¾ç½®-å…ƒæ•°æ® enable_read_limit ä¸º true å³å¯ã€‚è®¾ç½®ä¹‹å>æ–‡ç« é¡µé»˜è®¤åªå±•ç¤ºä¸€å±é«˜åº¦çš„å†…å®¹ï¼Œå‰©ä½™å†…å®¹éœ€è¦è¯„è®ºåæ‰å¯è§ï¼ˆå¦‚æœæ–‡ç« å†…å®¹å°äºä¸€å±é«˜åº¦ï¼Œåˆ™æ­¤åŠŸèƒ½ä¼šè¢«å¿½ç•¥ï¼‰ã€‚</p></blockquote><p>3.æ€æ ·å¼€å¯é˜²ç›—é“¾</p><p>å¾ˆç®€å•ï¼Œç›´æ¥åœ¨ nginx é‡Œé…ä¸€ä¸‹å°±å¯ä»¥ï¼Œä¸è¿‡è®°å¾—æ·»åŠ ç™½åå•ï¼ˆå¦‚ logo å’Œ avatarï¼‰ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># èµ„æºé˜²ç›—é“¾ï¼ˆæŒ‡å®šç›®å½•oræŒ‡å®šæ–‡ä»¶ç±»å‹ï¼‰
</span></span></span><span class=line><span class=cl><span class=c1># location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
</span></span></span><span class=line><span class=cl><span class=k>location</span> <span class=s>/upload/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kn>access_log</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1># åŸŸåç™½åå•ï¼Œå»æ‰åˆ™é˜»æ­¢æ‰€æœ‰éæœ¬ç«™è¯·æ±‚
</span></span></span><span class=line><span class=cl>  <span class=kn>valid_referers</span> <span class=s>none</span> <span class=s>blocked</span> <span class=s>server_names</span> <span class=s>*.bbchin.com</span> <span class=n>127.0.0.1</span> <span class=s>localhost</span> <span class=p>~</span><span class=sr>\.google\.</span> <span class=p>~</span><span class=sr>\.baidu\.</span> <span class=p>~</span><span class=sr>\.qq\.;</span>
</span></span><span class=line><span class=cl>  <span class=s>if</span> <span class=s>(</span><span class=nv>$invalid_referer</span><span class=s>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>rewrite</span> <span class=s>^/</span> <span class=s>https://cdn.jsdelivr.net/gh/qinhua/cdn_assets/img/robber.jpg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kn>proxy_pass</span> <span class=s>http://127.0.0.1:8090</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>4.æ€æ ·é…ç½®åˆé€‚çš„ç¼“å­˜ç­–ç•¥</p><p>åˆç†åˆ©ç”¨æµè§ˆå™¨çš„ç¼“å­˜åŒæ ·å¯ä»¥ä¼˜åŒ–é¡µé¢æ€§èƒ½ï¼Œæé«˜åŠ è½½é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nginx å¯¹ç›¸å…³èµ„æºçš„å“åº”å¤´è¿›è¡Œé…ç½®ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>location / {
</span></span><span class=line><span class=cl>    gzip_static on; # é™æ€å‹ç¼©
</span></span><span class=line><span class=cl>    add_header Cache-Control public,max-age=60,s-maxage=60; # é…ç½®ç¼“å­˜
</span></span><span class=line><span class=cl>    proxy_set_header HOST $host;
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>    proxy_pass http://127.0.0.1:8090;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h2 id=ä¸»é¢˜ä¿®æ”¹>ä¸»é¢˜ä¿®æ”¹</h2><p>ä¿®æ”¹é¦–é¡µæ–‡ç« æ•°ã€åˆ†ç±»æ•°ã€æ ‡ç­¾æ•°é¡ºåºï¼š
è‡ªè¡Œä¿®æ”¹ template/module/blogger.ftl æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=err>&lt;</span>#if settings.overview_type == &#39;A&#39;&gt;
</span></span><span class=line><span class=cl>	  <span class=err>&lt;</span>@postTag method=&#34;count&#34;&gt;
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item&#34;</span> <span class=na>title</span><span class=o>=</span><span class=s>&#34;ç´¯è®¡æ–‡ç« æ•° ${count!&#39;0&#39;}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;num&#34;</span><span class=p>&gt;</span>${count!&#39;0&#39;}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>æ–‡ç« æ•°<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=err>&lt;</span>/@postTag&gt;
</span></span><span class=line><span class=cl>      <span class=err>&lt;</span>@categoryTag method=&#34;count&#34;&gt;
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item&#34;</span> <span class=na>title</span><span class=o>=</span><span class=s>&#34;ç´¯è®¡åˆ†ç±»æ•° ${count!&#39;0&#39;}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;num&#34;</span><span class=p>&gt;</span>${count!&#39;0&#39;}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>åˆ†ç±»æ•°<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=err>&lt;</span>/@categoryTag&gt;
</span></span><span class=line><span class=cl>      <span class=err>&lt;</span>@tagTag method=&#34;count&#34;&gt;
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item&#34;</span> <span class=na>title</span><span class=o>=</span><span class=s>&#34;ç´¯è®¡æ ‡ç­¾æ•° ${count!&#39;0&#39;}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;num&#34;</span><span class=p>&gt;</span>${count!&#39;0&#39;}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>æ ‡ç­¾æ•°<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=err>&lt;</span>/@tagTag&gt;
</span></span></code></pre></td></tr></table></div></div></div><div class="shuoshuo-tags meta-wrapper" style=margin-top:15px!important;margin-bottom:5px!important;gap:10px!important><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px;color:var(--card-text-color-secondary)"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
<a href=/tags/halo/ class="meta-item shuoshuo-tag" title="æŸ¥çœ‹æ ‡ç­¾: halo"><span>#halo</span></a></div><div class=shuoshuo-footer-info><div class="shuoshuo-edit-link meta-wrapper" style=gap:15px!important><a href=https://github.com/iwyang/iwyang.github.io/edit/develop/content/post/Halo-theme-joe2.0%20%e4%bd%bf%e7%94%a8%e6%96%87%e6%a1%a3&&%e6%a0%b7%e5%bc%8f%e6%8c%87%e5%8d%97/index.md target=_blank rel="noopener noreferrer" class=meta-item title="å‰å¾€ GitHub ç¼–è¾‘æ­¤é¡µ"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
<span>ç¼–è¾‘æ­¤é¡µ</span>
</a><span class=separator>|</span>
<a class="meta-item git-hash-text" href=https://github.com/iwyang/iwyang.github.io/commit/26a215ebb8fca78d98f384856b8ab5e0e2056333 target=_blank rel="noopener noreferrer" title="Commit Hash: 26a215e">#26a215e</a></div></div></article><article class=shuoshuo-card><div class=shuoshuo-header><div class="shuoshuo-meta meta-wrapper"><time class="shuoshuo-time meta-item" datetime=2020-07-26T13:49:25Z><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span>2020-07-26</span>
</time><span class="shuoshuo-updated-time meta-item" datetime=2026-02-09T22:08:24+08:00><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4A2 2 0 002 6v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121.0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
<span>2026-02-09</span></span></div></div><div class="shuoshuo-content style-cs-content article-post"><p>åœ¨ç½‘ä¸ŠæŸ¥è¯¢äº†ä¸€ä¸‹haloå®šæ—¶å¤‡ä»½æœ‰ä¸‰ç§æ–¹æ¡ˆï¼šé‚®ç®±å’ŒDropboxï¼Œä»¥åŠgithubã€‚</p><h2 id=å¤‡ä»½åˆ°qqé‚®ç®±>å¤‡ä»½åˆ°QQé‚®ç®±</h2><h3 id=å®‰è£…é‚®ä»¶å‘é€ä¾èµ–ç»„ä»¶><strong>å®‰è£…é‚®ä»¶å‘é€ä¾èµ–ç»„ä»¶</strong></h3><h4 id=centos-7>Centos 7</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install sendmail mailx -y
</span></span></code></pre></td></tr></table></div></div><h4 id=centos-8>Centos 8</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum -y install postfix sendmail-cf mailx
</span></span><span class=line><span class=cl>service postfix start
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> postfix
</span></span></code></pre></td></tr></table></div></div><h4 id=debian>Debian</h4><ol><li>å®‰è£… mailtuils:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install mailutils -y
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>å®‰è£…postfixåç¼€:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install postfix
</span></span></code></pre></td></tr></table></div></div><p>åœ¨å®‰è£…è¿‡ç¨‹å³å°†ç»“æŸæ—¶ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºä¸‹å›¾ä¸­çš„çª—å£çš„çª—å£ã€‚é»˜è®¤é€‰é¡¹æ˜¯<code>Internet Site</code>ã€‚è¿™æ˜¯æœ¬æ•™ç¨‹çš„æ¨èé€‰é¡¹ï¼Œè¯·æŒ‰<code>TAB</code>ï¼Œç„¶åæŒ‰<code>ENTER</code>ã€‚
ä¹‹åï¼Œæ‚¨å°†è·å¾—å¦ä¸€ä¸ªçª—å£ï¼Œå°±åƒä¸‹ä¸€ä¸ªå›¾åƒä¸­çš„çª—å£ä¸€æ ·ã€‚è¯¥ç³»ç»Ÿé‚®ä»¶åç§°åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œä½ åˆ†é…ç»™æœåŠ¡å™¨ï¼Œå½“ä½ åœ¨åˆ›é€ å®ƒçš„åå­—ã€‚å¦‚æœå®ƒæ˜¾ç¤ºå­åŸŸ<code>subdomain.example.com</code>ï¼Œè¯·å°†å…¶æ›´æ”¹ä¸º<code>ust example.com</code>ã€‚å®Œæˆåï¼ŒæŒ‰<code>TAB</code>ï¼Œç„¶å<code>ENTER</code>ã€‚</p><h3 id=ä¿®æ”¹é™„ä»¶å‘é€å¤§å°é™åˆ¶>ä¿®æ”¹é™„ä»¶å‘é€å¤§å°é™åˆ¶</h3><p>çœ‹ä¸‹ç°åœ¨é‚®ä»¶çš„å¤§å°é™åˆ¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo postconf message_size_limit
</span></span></code></pre></td></tr></table></div></div><div class="note info">message_size_limit = 20480000</div><p>å·®ä¸å¤šæ˜¯10Mï¼Œæ”¾å¤§20å€ï¼Œåº”è¯¥å·®ä¸å¤šäº†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo postconf -e <span class=s2>&#34;message_size_limit = 204800000&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è·å¾—ç¼–è¾‘å¤‡ä»½è„šæœ¬>è·å¾—&ç¼–è¾‘å¤‡ä»½è„šæœ¬</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://raw.githubusercontent.com/iwyang/scripts/master/halo_email_backup.sh
</span></span></code></pre></td></tr></table></div></div><h4 id=åˆ›å»ºå¤‡ä»½æ–‡ä»¶å¤¹>åˆ›å»ºå¤‡ä»½æ–‡ä»¶å¤¹</h4><div class="note primary">å¦‚æœé€‰æ‹©å°†æ–‡ä»¶å¤‡ä»½åˆ°ä¸´æ—¶ç›®å½•çš„è¯ï¼Œè¿™æ­¥å¯è·³è¿‡ï¼Œç›´æ¥ä¿®æ”¹è„šæœ¬å³å¯ã€‚æˆ‘ç›´æ¥è·³è¿‡äº†è¿™ä¸€æ­¥ã€‚</div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -p /home/back
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¿®æ”¹è„šæœ¬>ä¿®æ”¹è„šæœ¬</h4><p>è„šæœ¬åŸæ¥æ¨¡æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>è¿›å…¥åˆ°å¤‡ä»½æ–‡ä»¶å¤¹</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>/</span><span class=nx>home</span><span class=o>/</span><span class=nx>back</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>å‹ç¼©ç½‘ç«™æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>zcvf</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span> <span class=nx>ç½‘ç«™ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å¯¼å‡ºæ•°æ®åº“åˆ°å¤‡ä»½æ–‡ä»¶å¤¹å†…</span>
</span></span><span class=line><span class=cl><span class=nx>mysqldump</span> <span class=o>-</span><span class=nx>uroot</span> <span class=o>-</span><span class=nx>pæ•°æ®åº“å¯†ç </span> <span class=nx>æ•°æ®åº“åç§°</span> <span class=o>&gt;</span> <span class=nx>web_data_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>sql</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>ä»¥é™„ä»¶å½¢å¼å‘é€æ•°æ®åº“åˆ°æŒ‡å®šé‚®ç®±</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;Blog date&#34;</span><span class=o>|</span><span class=nx>mail</span> <span class=o>-</span><span class=nx>s</span> <span class=s2>&#34;Backup$(date +%Y-%m-%d)&#34;</span> <span class=o>-</span><span class=nx>a</span> <span class=nx>web_data_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>sql</span> <span class=nx>æ”¶ä»¶äººé‚®ç®±</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>åˆ é™¤æœ¬åœ°3å¤©å‰çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>rf</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>3</span><span class=nx>day</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span> <span class=nx>web_data_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>3</span><span class=nx>day</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>sql</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>ç™»å½•FTP</span>
</span></span><span class=line><span class=cl><span class=nx>lftp</span> <span class=nx>ftpåœ°å€</span> <span class=o>-</span><span class=nx>u</span> <span class=nx>ftpç”¨æˆ·å</span><span class=p>,</span><span class=nx>ftpå¯†ç </span> <span class=o>&lt;&lt;</span> <span class=nx>EOF</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>è¿›å…¥FTPæ ¹ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=nx>ftpæ ¹ç›®å½•æ–‡ä»¶å¤¹</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>åˆ é™¤3å¤©å‰å¤‡ä»½æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>mrm</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>3</span><span class=nx>day</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl><span class=nx>mrm</span> <span class=nx>web_data_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>3</span><span class=nx>day</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>sql</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>ä¸Šä¼ å½“å¤©å¤‡ä»½æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>mput</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl><span class=nx>mput</span> <span class=nx>web_data_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>3</span><span class=nx>day</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>sql</span>
</span></span><span class=line><span class=cl><span class=nx>bye</span>
</span></span><span class=line><span class=cl><span class=nx>EOF</span>
</span></span></code></pre></td></tr></table></div></div><p>æ ¹æ®å®é™…éœ€æ±‚ï¼Œæ”¹æˆä¸‹é¢æ¨¡æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>vi email.sh
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>/</span><span class=nx>tmp</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>zcvf</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span> <span class=o>/</span><span class=nx>root</span><span class=o>/</span><span class=p>.</span><span class=nx>halo</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;Blog date&#34;</span><span class=o>|</span><span class=nx>mail</span> <span class=o>-</span><span class=nx>s</span> <span class=s2>&#34;Backup$(date +%Y-%m-%d)&#34;</span> <span class=o>-</span><span class=nx>a</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span> <span class=mi>455343442</span><span class=err>@</span><span class=nx>qq</span><span class=p>.</span><span class=nx>com</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>f</span> <span class=nx>web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y%m%d&#34;</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šé¢ä»£ç ä¸­æœ€åçš„<code>rm -f web_$(date +"%Y%m%d").tar.gz</code>ï¼Œè¡¨ç¤ºåˆ é™¤æœ¬åœ°çš„ä¸´æ—¶æ–‡ä»¶ã€‚</p><blockquote><p><strong>æ³¨æ„</strong>åœ¨<strong>Debian</strong>ä¸‹è¦è®²<code>-a</code> æ”¹æˆ <code>-A</code>ï¼ˆå¦‚ä¸‹ï¼‰</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>- echo &#34;Blog date&#34;|mail -s &#34;Backup$(date +%Y-%m-%d)&#34; -a web_$(date +&#34;%Y%m%d&#34;).tar.gz 455343442@qq.com
</span></span></span><span class=line><span class=cl><span class=gi>+ echo &#34;Blog date&#34;|mail -s &#34;Backup$(date +%Y-%m-%d)&#34; -A web_$(date +&#34;%Y%m%d&#34;).tar.gz 455343442@qq.com
</span></span></span></code></pre></td></tr></table></div></div><h4 id=è®¾ç½®å®šæ—¶ä»»åŠ¡>è®¾ç½®å®šæ—¶ä»»åŠ¡</h4><h5 id=èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™>èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x /root/email.sh
</span></span></code></pre></td></tr></table></div></div><p>è¿è¡Œçš„æ—¶å€™å°±è¾“å…¥ä¸‹é¢çš„ä»£ç å³å¯ï¼š<code>./email.sh</code></p><h5 id=è®¾å®šè‡ªåŠ¨ä»»åŠ¡>è®¾å®šè‡ªåŠ¨ä»»åŠ¡</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>01</span> <span class=m>00</span> * * * /root/email.sh
</span></span></code></pre></td></tr></table></div></div><p>æ„æ€æ˜¯æ¯å¤©å‡Œæ™¨0:01è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚</p><h2 id=å¤‡ä»½åˆ°dropbox>å¤‡ä»½åˆ°Dropbox</h2><h3 id=åˆ›å»ºdropboxåº”ç”¨>åˆ›å»ºDropboxåº”ç”¨</h3><p>é¦–å…ˆï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªDropboxåº”ç”¨ï¼Œå¯ä»¥ä»è¯¥ç½‘å€è¿›è¡Œåˆ›å»ºï¼šhttps://www.dropbox.com/developers/apps/create</p><p>åœ¨è¿™é‡Œï¼Œåº”ç”¨ç±»å‹é€‰æ‹©<code>Dropbox API</code>ï¼Œæ•°æ®å­˜å‚¨ç±»å‹é€‰æ‹©<code>App folder</code>ï¼Œç„¶å<code>å‘½å</code>åˆ›å»ºã€‚ç„¶ååˆ‡æ¢åˆ°<code>Permissions</code>é€‰é¡¹å¡ï¼Œå‹¾é€‰ç›¸åº”æƒé™ã€‚æœ€åè®°å½•ä¸‹<code>App key</code>ï¼Œ<code>App secret</code>ï¼Œä¸‹é¢è¦ç”¨ã€‚</p><p><img src=/archives/3a4bd17/dropbox_uploader.jpg width=800 height=419 loading=lazy class=gallery-image data-flex-grow=190 data-flex-basis=458px></p><h3 id=ä¸‹è½½dropbox_uploadersh>ä¸‹è½½dropbox_uploader.sh</h3><p><a class=link href=https://github.com/andreafabrizi/Dropbox-Uploader/ target=_blank rel=noopener>dropbox_uploader</a> æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹Dropboxå¤‡ä»½è„šæœ¬ï¼Œé¦–å…ˆä¸‹è½½è„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl <span class=s2>&#34;https://raw.githubusercontent.com/andreafabrizi/Dropbox-Uploader/master/dropbox_uploader.sh&#34;</span> -o dropbox_uploader.sh
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åï¼Œä¸ºè¯¥è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x dropbox_uploader.sh
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œè¯¥è„šæœ¬ï¼Œç»‘å®šAPPï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./dropbox_uploader.sh
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ç»ˆç«¯é‡Œè¾“å…¥<code>App key</code>ï¼Œ<code>App secret</code>ï¼Œæ¥ç€ä¼šè¿”å›ä¸€ä¸ªç½‘å€ï¼Œæµè§ˆå™¨æ‰“å¼€ï¼Œå¤åˆ¶å¾—åˆ°çš„<code>token</code>ï¼Œæœ€ååœ¨ç»ˆç«¯é‡Œå®Œæˆç»‘å®šã€‚</p><p>ä¹‹åå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æµ‹è¯•ä¸Šä¼ ï¼Œæç¤ºDoneå°±æ˜¯ç»‘å®šæˆåŠŸäº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./dropbox_uploader.sh upload /etc/passwd /backup/passwd.old
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæŠ¥é”™<code>unlink</code>,å…ˆæ‰§è¡Œå‘½ä»¤<code>rm ~/.dropbox_uploader</code>ï¼Œåˆ é™¤ç›¸åº”æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ é™¤ä¸Šé¢ç”³è¯·çš„APPã€‚æŒ‰ä¸Šé¢çš„æ“ä½œé‡æ–°ç”³è¯·</p><p>APPã€é‡æ–°ç»‘å®šï¼Œä¸€èˆ¬ç¬¬äºŒæ¬¡ç”³è¯·å°±ä¼šæˆåŠŸã€‚</p><h3 id=ç¼–å†™å¤‡ä»½è„šæœ¬>ç¼–å†™å¤‡ä»½è„šæœ¬</h3><p>ç¼–å†™å®šæ—¶å¤‡ä»½è„šæœ¬ï¼Œå–åä¸º<code>backup.sh</code>ã€‚ä»£ç åŸæ¥æ¨¡æ ·å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi backup.sh
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=nx>SCRIPT_DIR</span><span class=o>=</span><span class=s2>&#34;/root&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ”¹æˆä½ å­˜æ”¾åˆšåˆšä¸‹è½½ä¸‹æ¥çš„dropbox_uploader</span><span class=p>.</span><span class=nx>shçš„æ–‡ä»¶å¤¹ä½ç½®</span>
</span></span><span class=line><span class=cl><span class=nx>DROPBOX_DIR</span><span class=o>=</span><span class=s2>&#34;/backup&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ”¹æˆä½ çš„å¤‡ä»½æ–‡ä»¶æƒ³è¦æ”¾åœ¨Dropboxä¸‹é¢çš„æ–‡ä»¶å¤¹åç§°</span><span class=err>ï¼Œ</span><span class=nx>å¦‚æœä¸å­˜åœ¨</span><span class=err>ï¼Œ</span><span class=nx>è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»º</span>
</span></span><span class=line><span class=cl><span class=nx>BACKUP_SRC</span><span class=o>=</span><span class=s2>&#34;/home/wwwroot /usr/local/nginx/conf&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ˜¯ä½ æƒ³è¦å¤‡ä»½çš„æœ¬åœ°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶</span><span class=err>ï¼Œ</span><span class=nx>ä¸åŒçš„ç›®å½•ç”¨ç©ºæ ¼åˆ†å¼€</span>
</span></span><span class=line><span class=cl><span class=nx>BACKUP_DST</span><span class=o>=</span><span class=s2>&#34;/tmp&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ˜¯ä½ æš‚æ—¶å­˜æ”¾å¤‡ä»½å‹ç¼©æ–‡ä»¶çš„åœ°æ–¹</span><span class=err>ï¼Œ</span><span class=nx>ä¸€èˆ¬ç”¨</span><span class=o>/</span><span class=nx>tmpå³å¯</span>
</span></span><span class=line><span class=cl><span class=nx>MYSQL_SERVER</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ˜¯ä½ mysqlæœåŠ¡å™¨çš„åœ°å€</span><span class=err>ï¼Œ</span><span class=nx>ä¸€èˆ¬å¡«è¿™ä¸ªæœ¬åœ°åœ°å€å³å¯</span>
</span></span><span class=line><span class=cl><span class=nx>MYSQL_USER</span><span class=o>=</span><span class=s2>&#34;mysqluser&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ˜¯ä½ mysqlçš„ç”¨æˆ·ååç§°</span><span class=err>ï¼Œ</span><span class=nx>æ¯”å¦‚rootæˆ–adminä¹‹ç±»çš„</span>
</span></span><span class=line><span class=cl><span class=nx>MYSQL_PASS</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=err>#</span><span class=nx>è¿™ä¸ªæ˜¯ä½ mysqlç”¨æˆ·çš„å¯†ç </span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>ä¸‹é¢çš„ä¸€èˆ¬ä¸ç”¨æ”¹äº†</span>
</span></span><span class=line><span class=cl><span class=nx>NOW</span><span class=o>=</span><span class=nx>$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y.%m.%d&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>DESTFILE</span><span class=o>=</span><span class=s2>&#34;$BACKUP_DST/$NOW.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å¤‡ä»½mysqlæ•°æ®åº“å¹¶å’Œå…¶å®ƒå¤‡ä»½æ–‡ä»¶ä¸€èµ·å‹ç¼©æˆä¸€ä¸ªæ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>mysqldump</span> <span class=o>-</span><span class=nx>u</span> <span class=nx>$MYSQL_USER</span> <span class=o>-</span><span class=nx>h</span> <span class=nx>$MYSQL_SERVER</span> <span class=o>-</span><span class=nx>p$MYSQL_PASS</span> <span class=o>--</span><span class=nx>all</span><span class=o>-</span><span class=nx>databases</span> <span class=o>&gt;</span> <span class=s2>&#34;$NOW-Databases.sql&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;æ•°æ®åº“å¤‡ä»½å®Œæˆï¼Œæ‰“åŒ…ç½‘ç«™æ•°æ®ä¸­...&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>cfzP</span> <span class=s2>&#34;$DESTFILE&#34;</span> <span class=nx>$BACKUP_SRC</span> <span class=s2>&#34;$NOW-Databases.sql&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;æ‰€æœ‰æ•°æ®æ‰“åŒ…å®Œæˆï¼Œå‡†å¤‡ä¸Šä¼ ...&#34;</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>ç”¨è„šæœ¬ä¸Šä¼ åˆ°dropbox</span>
</span></span><span class=line><span class=cl><span class=nx>$SCRIPT_DIR</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>upload</span> <span class=s2>&#34;$DESTFILE&#34;</span> <span class=s2>&#34;$DROPBOX_DIR/$NOW.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>[</span> <span class=nx>$</span><span class=o>?</span> <span class=o>-</span><span class=nx>eq</span> <span class=mi>0</span> <span class=p>];</span><span class=nx>then</span>
</span></span><span class=line><span class=cl>     <span class=nx>echo</span> <span class=s2>&#34;ä¸Šä¼ å®Œæˆ&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>     <span class=nx>echo</span> <span class=s2>&#34;ä¸Šä¼ å¤±è´¥ï¼Œé‡æ–°å°è¯•&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>fi</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>åˆ é™¤æœ¬åœ°çš„ä¸´æ—¶æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>f</span> <span class=s2>&#34;$NOW-Databases.sql&#34;</span> <span class=s2>&#34;$DESTFILE&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ ¹æ®å®é™…æƒ…å†µæ”¹æˆä¸‹é¢æ¨¡æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=nx>SCRIPT_DIR</span><span class=o>=</span><span class=s2>&#34;/root&#34;</span> 
</span></span><span class=line><span class=cl><span class=nx>DROPBOX_DIR</span><span class=o>=</span><span class=s2>&#34;/backup&#34;</span> 
</span></span><span class=line><span class=cl><span class=nx>BACKUP_SRC</span><span class=o>=</span><span class=s2>&#34;/root/.halo&#34;</span> 
</span></span><span class=line><span class=cl><span class=nx>BACKUP_DST</span><span class=o>=</span><span class=s2>&#34;/tmp&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>NOW</span><span class=o>=</span><span class=nx>$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+</span><span class=s2>&#34;%Y.%m.%d&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>DESTFILE</span><span class=o>=</span><span class=s2>&#34;$BACKUP_DST/$NOW.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;æ‰“åŒ…ç½‘ç«™æ•°æ®ä¸­...&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>cfzP</span> <span class=s2>&#34;$DESTFILE&#34;</span> <span class=nx>$BACKUP_SRC</span>
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=s2>&#34;æ‰€æœ‰æ•°æ®æ‰“åŒ…å®Œæˆï¼Œå‡†å¤‡ä¸Šä¼ ...&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>$SCRIPT_DIR</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=k>delete</span> <span class=s2>&#34;$DROPBOX_DIR&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>$SCRIPT_DIR</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>upload</span> <span class=s2>&#34;$DESTFILE&#34;</span> <span class=s2>&#34;$DROPBOX_DIR/$NOW.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>[</span> <span class=nx>$</span><span class=o>?</span> <span class=o>-</span><span class=nx>eq</span> <span class=mi>0</span> <span class=p>];</span><span class=nx>then</span>
</span></span><span class=line><span class=cl>     <span class=nx>echo</span> <span class=s2>&#34;ä¸Šä¼ å®Œæˆ&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>     <span class=nx>echo</span> <span class=s2>&#34;ä¸Šä¼ å¤±è´¥ï¼Œé‡æ–°å°è¯•&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>fi</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>f</span> <span class=s2>&#34;$DESTFILE&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>å…ˆç”¨<code>$SCRIPT_DIR/dropbox_uploader.sh delete "$DROPBOX_DIR"</code>åˆ é™¤<code>Dropbox</code>å¤‡ä»½æ–‡ä»¶å¤¹ï¼Œå†ä¸Šä¼ æ–‡ä»¶ã€‚è¿™æ ·å°±ä¿è¯<code>Dropbox</code>æ°¸è¿œåªæœ‰ä¸€ä¸ªæœ€æ–°çš„å¤‡ä»½æ–‡ä»¶ï¼Œä¸ç”¨æ‰‹åŠ¨åˆ é™¤å¤šä½™çš„å¤‡ä»½æ–‡ä»¶äº†</strong>ã€‚</p><hr><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬è®¾ç½®ä¿ç•™æ—§æ•°æ®çš„æ—¶é•¿ã€‚å¦‚ä¸‹é¢ä¸€ä¸ªè„šæœ¬å°±æ˜¯è®©æ—§æ•°æ®åœ¨Dropboxä¿ç•™7å¤©ï¼Œæœ¬åœ°ä¿ç•™10å¤©ã€‚ï¼ˆä¸è¿‡è§‰å¾—æ²¡æœ‰å¿…è¦ï¼Œè¿˜æ˜¯ä¸Šé¢çš„æ–¹æ³•ç®€å•ï¼Œä¸‹é¢æ–¹æ³•å°è¯•è¿‡ï¼Œè€æ˜¯å‡ºç°é—®é¢˜ï¼Œæ—§æ•°æ®åˆ é™¤ä¸äº†ï¼Œä¸æƒ³æŠ˜è…¾äº†ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å®šä¹‰éœ€è¦å¤‡ä»½çš„ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=nx>WEB_DIR</span><span class=o>=</span><span class=err>/home/www # ç½‘ç«™æ•°æ®å­˜æ”¾ç›®å½•</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å®šä¹‰å¤‡ä»½å­˜æ”¾ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=nx>DROPBOX_DIR</span><span class=o>=</span><span class=err>/$(date +%Y-%m-%d) # Dropboxä¸Šçš„å¤‡ä»½ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=nx>LOCAL_BAK_DIR</span><span class=o>=</span><span class=err>/home/backup # æœ¬åœ°å¤‡ä»½æ–‡ä»¶å­˜æ”¾ç›®å½•</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å®šä¹‰å¤‡ä»½æ–‡ä»¶åç§°</span>
</span></span><span class=line><span class=cl><span class=nx>DBBakName</span><span class=o>=</span><span class=nx>DB_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+%</span><span class=nx>Y</span><span class=o>%</span><span class=nx>m</span><span class=o>%</span><span class=nx>d</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl><span class=nx>WebBakName</span><span class=o>=</span><span class=nx>Web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>+%</span><span class=nx>Y</span><span class=o>%</span><span class=nx>m</span><span class=o>%</span><span class=nx>d</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>å®šä¹‰æ—§æ•°æ®åç§°</span>
</span></span><span class=line><span class=cl><span class=nx>Old_DROPBOX_DIR</span><span class=o>=</span><span class=err>/$(date -d -7day +%Y-%m-%d)</span>
</span></span><span class=line><span class=cl><span class=nx>OldDBBakName</span><span class=o>=</span><span class=nx>DB_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>10</span><span class=nx>day</span> <span class=o>+%</span><span class=nx>Y</span><span class=o>%</span><span class=nx>m</span><span class=o>%</span><span class=nx>d</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl><span class=nx>OldWebBakName</span><span class=o>=</span><span class=nx>Web_$</span><span class=p>(</span><span class=nx>date</span> <span class=o>-</span><span class=nx>d</span> <span class=o>-</span><span class=mi>10</span><span class=nx>day</span> <span class=o>+%</span><span class=nx>Y</span><span class=o>%</span><span class=nx>m</span><span class=o>%</span><span class=nx>d</span><span class=p>).</span><span class=nx>tar</span><span class=p>.</span><span class=nx>gz</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=nx>$LOCAL_BAK_DIR</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>ä½¿ç”¨å‘½ä»¤å¯¼å‡ºæ•°æ®åº“</span>
</span></span><span class=line><span class=cl><span class=nx>mongodump</span> <span class=o>--</span><span class=nx>out</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>mongodb</span><span class=o>/</span> <span class=o>--</span><span class=nx>db</span> <span class=nx>bastogne</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>å‹ç¼©æ•°æ®åº“æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå‹ç¼©æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>zcf</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$DBBakName</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>mongodb</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>rf</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>mongodb</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>å‹ç¼©ç½‘ç«™æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=nx>$WEB_DIR</span>
</span></span><span class=line><span class=cl><span class=nx>tar</span> <span class=nx>zcf</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$WebBakName</span> <span class=p>.</span><span class=o>/*</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>~</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>å¼€å§‹ä¸Šä¼ </span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>upload</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$DBBakName</span> <span class=nx>$DROPBOX_DIR</span><span class=o>/</span><span class=nx>$DBBakName</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>upload</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$WebBakName</span> <span class=nx>$DROPBOX_DIR</span><span class=o>/</span><span class=nx>$WebBakName</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>åˆ é™¤æ—§æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>rf</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$OldDBBakName</span> <span class=nx>$LOCAL_BAK_DIR</span><span class=o>/</span><span class=nx>$OldWebBakName</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=o>/</span><span class=nx>dropbox_uploader</span><span class=p>.</span><span class=nx>sh</span> <span class=k>delete</span> <span class=nx>$Old_DROPBOX_DIR</span><span class=o>/</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=o>-</span><span class=nx>e</span> <span class=s2>&#34;Backup Done!&#34;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™-1>èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x backup.sh
</span></span></code></pre></td></tr></table></div></div><p>è¿è¡Œçš„æ—¶å€™å°±è¾“å…¥ä¸‹é¢çš„ä»£ç å³å¯ï¼š<code>./backup.sh</code></p><h3 id=è®¾ç½®å®šæ—¶ä»»åŠ¡-1>è®¾ç½®å®šæ—¶ä»»åŠ¡</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>02</span> <span class=m>00</span> * * * /root/backup.sh
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ ·ï¼Œå°±å¯ä»¥æ¯å¤©å‡Œæ™¨00:02è‡ªåŠ¨å¤‡ä»½åˆ°Dropboxäº†ã€‚</p><h2 id=å¤‡ä»½åˆ°github>å¤‡ä»½åˆ°github</h2><h3 id=å‡†å¤‡å·¥ä½œ>å‡†å¤‡å·¥ä½œ</h3><p>é¦–å…ˆå½“ç„¶æ˜¯åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…<code>GIt</code>ï¼Œé…ç½®<code>sshå…¬é’¥</code>ï¼Œå¹¶ä¸”åœ¨<code>github</code>ä¸Šæ·»åŠ æœåŠ¡å™¨<code>sshå…¬é’¥</code>ã€‚å…·ä½“è¿‡ç¨‹ç•¥ã€‚</p><h3 id=åˆå§‹åŒ–ä»“åº“>åˆå§‹åŒ–ä»“åº“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /root/.halo
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git remote add origin git@github.com:iwyang/halo.git
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;site backup&#34;</span>
</span></span><span class=line><span class=cl>git push --force origin master
</span></span></code></pre></td></tr></table></div></div><hr><p>æ³¨æ„è¦åˆ é™¤ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„<code>.git</code>æ–‡ä»¶å¤¹ï¼Œä¸ç„¶çš„è¯å°±æ— æ³•å¤‡ä»½ä¸»é¢˜äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸å¤‡ä»½ä¸»é¢˜ï¼Œå› ä¸ºä¸»é¢˜æ‰€æœ‰é…ç½®é€‰é¡¹éƒ½åœ¨æ•°æ®åº“é‡Œã€‚å¦‚æœè¿™æ ·çš„è¯ï¼Œå‘½ä»¤è¦ä½œå¦‚ä¸‹è°ƒæ•´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add application.yaml upload/ db/
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=è®¾ç½®å®šæ—¶ä»»åŠ¡-2>è®¾ç½®å®šæ—¶ä»»åŠ¡</h3><h4 id=ç¼–å†™å¤‡ä»½è„šæœ¬-1>ç¼–å†™å¤‡ä»½è„šæœ¬</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /root
</span></span><span class=line><span class=cl>vi github.sh
</span></span></code></pre></td></tr></table></div></div><p>è„šæœ¬åŸæ¥æ¨¡æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>è¿›å…¥åˆ°ç½‘ç«™æ ¹ç›®å½•</span><span class=err>ï¼Œ</span><span class=nx>è®°å¾—ä¿®æ”¹ä¸ºè‡ªå·±çš„ç«™ç‚¹</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>/</span><span class=nx>home</span><span class=o>/</span><span class=nx>xxx</span><span class=p>.</span><span class=nx>com</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>å°†æ•°æ®åº“å¯¼å…¥åˆ°è¯¥ç›®å½•</span><span class=err>ï¼Œ</span><span class=nx>è¿™é‡Œä»¥mysqlä¸ºä¾‹</span><span class=err>ï¼Œ</span><span class=nx>passwdä¸ºæ•°æ®åº“å¯†ç </span><span class=err>ï¼Œ</span><span class=nx>typechoä¸ºæ•°æ®åº“åç§°</span><span class=err>ï¼Œ</span><span class=nx>typecho</span><span class=p>.</span><span class=nx>sqlä¸ºå¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=nx>mysqldump</span> <span class=o>-</span><span class=nx>uroot</span> <span class=o>-</span><span class=nx>ppasswd</span> <span class=nx>typecho</span> <span class=o>&gt;</span> <span class=nx>typecho</span><span class=p>.</span><span class=nx>sql</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>add</span> <span class=o>-</span><span class=nx>A</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>commit</span> <span class=o>-</span><span class=nx>m</span> <span class=s2>&#34;backsite&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>push</span> <span class=o>-</span><span class=nx>u</span> <span class=nx>origin</span> <span class=nx>master</span>
</span></span></code></pre></td></tr></table></div></div><p>æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=o>-</span><span class=nx>e</span> <span class=s2>&#34;\033[0;32mDeploying updates to github...\033[0m&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>/</span><span class=nx>root</span><span class=o>/</span><span class=p>.</span><span class=nx>halo</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>add</span> <span class=p>.</span>	
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>commit</span> <span class=o>-</span><span class=nx>m</span> <span class=s2>&#34;site backup&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>push</span> <span class=o>--</span><span class=nx>force</span> <span class=nx>origin</span> <span class=nx>master</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨é‡Œ<code>.git</code>æ–‡ä»¶å¤¹è¿‡å¤§ï¼Œè„šæœ¬å¯ä»¥ä½œå¦‚ä¸‹è°ƒæ•´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=nx>echo</span> <span class=o>-</span><span class=nx>e</span> <span class=s2>&#34;\033[0;32mDeploying updates to github...\033[0m&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>cd</span> <span class=o>/</span><span class=nx>root</span><span class=o>/</span><span class=p>.</span><span class=nx>halo</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>rf</span> <span class=p>.</span><span class=nx>git</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>init</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>remote</span> <span class=nx>add</span> <span class=nx>origin</span> <span class=nx>git</span><span class=err>@</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>:</span><span class=nx>iwyang</span><span class=o>/</span><span class=nx>halo</span><span class=p>.</span><span class=nx>git</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>add</span> <span class=p>.</span>    
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>commit</span> <span class=o>-</span><span class=nx>m</span> <span class=s2>&#34;site backup&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>git</span> <span class=nx>push</span> <span class=o>--</span><span class=nx>force</span> <span class=nx>origin</span> <span class=nx>master</span>
</span></span><span class=line><span class=cl><span class=nx>rm</span> <span class=o>-</span><span class=nx>rf</span> <span class=p>.</span><span class=nx>git</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™-2>èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x /root/github.sh
</span></span></code></pre></td></tr></table></div></div><h4 id=è®¾å®šè‡ªåŠ¨ä»»åŠ¡-1>è®¾å®šè‡ªåŠ¨ä»»åŠ¡</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=mi>03</span> <span class=mi>00</span> <span class=o>*</span> <span class=o>*</span> <span class=o>*</span> <span class=err>/root/github.sh</span>
</span></span></code></pre></td></tr></table></div></div><p>æ„æ€æ˜¯æ¯å¤©å‡Œæ™¨0:03è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚</p><h3 id=è¿˜åŸåšå®¢>è¿˜åŸåšå®¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone git@github.com:iwyang/halo.git .halo
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥å°±æ˜¯é…ç½®ä¸ª Java ç¯å¢ƒï¼Œä¸‹è½½ä¸ª Halo è¿è¡ŒåŒ…ï¼Œé…ç½®åŸŸåè®¿é—®ã€‚å…·ä½“å¯å‚è€ƒ<a class=link href=https://halo.run/ target=_blank rel=noopener>å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h2 id=æ€»ç»“>æ€»ç»“</h2><p><code>halo</code>åšå®¢è¿ç§»åï¼Œæœ€å¥½åˆ é™¤<code>logs</code>æ–‡ä»¶å¤¹ä¸‹çš„æ—¥å¿—æ–‡ä»¶ã€‚</p><hr><h2 id=scpå‘½ä»¤>SCPå‘½ä»¤</h2><h3 id=ä¸‹è½½æ–‡ä»¶>ä¸‹è½½æ–‡ä»¶</h3><p>ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œåœ¨<code>Git Bash</code>æ‰§è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>scp root@104.224.191.88:/root/.ssh/mysite ssh
</span></span></code></pre></td></tr></table></div></div><p>æ„æ€æ˜¯å°†æœåŠ¡å™¨<code>/root/.ssh</code>ç›®å½•ä¸‹çš„mysiteæ–‡ä»¶å¤åˆ¶åˆ°å½“å‰è·¯å¾„ä¸‹<code>ssh</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p><h3 id=ä¸Šä¼ æ–‡ä»¶>ä¸Šä¼ æ–‡ä»¶</h3><p>ä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œåœ¨<code>Git Bash</code>æ‰§è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>scp .halo.zip root@137.220.43.191:/root/
</span></span></code></pre></td></tr></table></div></div><p>æ„æ€æ˜¯å°†å½“å‰ç›®å½•ä¸‹<code>.halo.ip</code>æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨<code>/root/ç›®å½•ä¸‹</code>ã€‚</p><h2 id=wordpressç›¸å…³>wordpressç›¸å…³</h2><h3 id=wordpresså¸¸ç”¨mysqlå‘½ä»¤>wordpresså¸¸ç”¨mysqlå‘½ä»¤</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># 1.åˆ é™¤æ•°æ®åº“</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>mysqladmin -u root -p drop wordpress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 2.æ–°å»ºä¸€ä¸ªç©ºæ•°æ®åº“</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>mysqladmin -u root -p create wordpress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 3.å¯¼å…¥æ•°æ®</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>mysql -uroot -pâ€ä½ çš„å¯†ç â€ wordpress &lt; ä½ çš„æ•°æ®sqlæ–‡ä»¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 4.æ›´æ–°Url</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 4.1.è¿æ¥æ•°æ®åº“</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>mysql -u root -p</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 4.2. é€‰æ‹©æ•°æ®åº“</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>use wordpress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># 4.3.æ›´æ–°URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>SELECT * FROM wp_options WHERE option_name = &#39;home&#39;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>UPDATE wp_options SET option_value=&#34;https://new_url/&#34; WHERE option_name = &#34;home&#34;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>SELECT * FROM wp_options WHERE option_name = &#39;siteurl&#39;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>UPDATE wp_options SET option_value=&#34;https://new_url/&#34; WHERE option_name = &#34;siteurl&#34;;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><hr><h3 id=debian-10-äº”åˆ†é’Ÿä¸€é”®å®‰è£…wordpress>Debian 10 äº”åˆ†é’Ÿ/ä¸€é”®å®‰è£…Wordpress</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Debian8ä¸‹è½½è„šæœ¬</span>
</span></span><span class=line><span class=cl>wget http://w3.gubo.org/pubfiles/tylemp/10/tylemp.sh 
</span></span><span class=line><span class=cl><span class=c1>#å®‰è£…ç¨³å®šç‰ˆNginx+PHP+MariaDB</span>
</span></span><span class=line><span class=cl>bash tylemp.sh stable
</span></span><span class=line><span class=cl><span class=c1>#å®‰è£…wordpressï¼Œwww.yourdomain.comå³ä¸ºä½ çš„åŸŸå</span>
</span></span><span class=line><span class=cl>bash tylemp.sh wordpress www.yourdomain.com 
</span></span></code></pre></td></tr></table></div></div><p>å‘½ä»¤åˆ—è¡¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash tylemp.sh system <span class=c1># ä¼˜åŒ–ç³»ç»Ÿï¼Œåˆ é™¤ä¸éœ€è¦ç»„ä»¶ï¼Œdropbearæ›¿ä»£sshd </span>
</span></span><span class=line><span class=cl>bash tylemp.sh exim4 <span class=c1># æ›´è½»é‡çº§é‚®ä»¶ç³»ç»Ÿ </span>
</span></span><span class=line><span class=cl>bash tylemp.sh mysql <span class=c1># å®‰è£…mysql </span>
</span></span><span class=line><span class=cl>bash tylemp.sh nginx <span class=c1># å®‰è£…nginxï¼Œé»˜è®¤ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯è°ƒæ•´</span>
</span></span><span class=line><span class=cl>bash tylemp.sh php <span class=c1># å®‰è£…phpï¼ŒåŒ…å«php5-gdï¼Œå¯ä½¿ç”¨éªŒè¯ç </span>
</span></span><span class=line><span class=cl>bash tylemp.sh stable <span class=c1># å®‰è£…ä¸Šé¢æ‰€æœ‰ï¼Œè½¯ä»¶æ˜¯debianå®˜æ–¹stableæºï¼Œç‰ˆæœ¬è¾ƒæ—§</span>
</span></span><span class=line><span class=cl>bash tylemp.sh wordpress www.yourdomain.com <span class=c1># ä¸€é”®å®‰è£…wordpress, æ•°æ®åº“è‡ªåŠ¨é…ç½®å¥½ã€‚ </span>
</span></span><span class=line><span class=cl>bash tylemp.sh vhost www.yourdomain.com <span class=c1># ä¸€é”®å®‰è£…é™æ€è™šæ‹Ÿä¸»æœºã€‚</span>
</span></span><span class=line><span class=cl>bash tylemp.sh dhost www.yourdomain.com <span class=c1># ä¸€é”®å®‰è£…åŠ¨æ€è™šæ‹Ÿä¸»æœºï¼Œæ–¹ä¾¿ç›´æ¥ä¸Šä¼ ç½‘ç«™ç¨‹åºã€‚</span>
</span></span><span class=line><span class=cl>bash tylemp.sh typecho www.yourdomain.com <span class=c1># å®‰è£…typechoï¼Œæä¾›æ•°æ®åº“åï¼Œå¯†ç ç­‰è‡ªä¸»æ·»åŠ å®Œæˆå®‰è£…</span>
</span></span><span class=line><span class=cl>bash tylemp.sh phpmyadmin www.yourdomain.com <span class=c1># ä¸€é”®å®‰è£…phpmyadmin æ•°æ®åº“ç®¡ç†è½¯ä»¶ï¼Œç”¨http://www.yourdomain.com/phpMyAdminè®¿é—® </span>
</span></span><span class=line><span class=cl>bash tylemp.sh addnginx <span class=m>2</span> <span class=c1>#è°ƒæ•´nginxè¿›ç¨‹ï¼Œè¿™é‡Œ2è¡¨ç¤ºè°ƒæ•´åçš„è¿›ç¨‹æ•°ï¼Œè¯·æ ¹æ®vpsé…ç½®ï¼ˆcpuæ ¸å¿ƒæ•°ï¼‰æ›´æ”¹</span>
</span></span><span class=line><span class=cl>bash tylemp.sh sshport <span class=m>22022</span> <span class=c1>#æ›´æ”¹sshç«¯å£å·22022ï¼Œå»ºè®®æ›´æ”¹10000ä»¥ä¸Šç«¯å£ã€‚é‡å¯åç”Ÿæ•ˆã€‚</span>
</span></span><span class=line><span class=cl>bash tylemp.sh rainloop www.yourdomain.com  <span class=c1># å¢åŠ Gmailçš„webå®¢æˆ·ç«¯ä¸€é”®å®‰è£…</span>
</span></span><span class=line><span class=cl>bash tylemp.sh carbon www.yourdomain.com  <span class=c1># å¢åŠ Carbon Forumçš„ä¸€é”®å®‰è£…</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¿®æ”¹-wordpress-ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶>ä¿®æ”¹ WordPress ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶</h3><p>1.æŸ¥æ‰¾php.inié…ç½®æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>find / -name &#34;php.ini&#34;
</span></span></code></pre></td></tr></table></div></div><p>ä¼šå‡ºç°ä¸¤ä¸ªç»“æœï¼Œä¿®æ”¹ç±»ä¼¼<code>/etc/php/7.3/fpm/php.ini</code></p><p>2.ä¿®æ”¹ <code>php.ini</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>vi /etc/php/7.3/fpm/php.ini
</span></span></code></pre></td></tr></table></div></div><p>åœ¨å…¶ä¸­æœç´¢å¹¶ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>upload_max_filesize</span> <span class=o>=</span> 512M
</span></span><span class=line><span class=cl><span class=nv>post_max_size</span> <span class=o>=</span> 512M
</span></span><span class=line><span class=cl><span class=nv>max_execution_time</span> <span class=o>=</span> <span class=m>3000</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œé…ç½®ä¸Šé™ä¸º 512 MBï¼ŒåŒæ—¶å¢åŠ äº†æœ€å¤§å¤„ç†æ—¶é—´ã€‚</p><p>3.ä¿®æ”¹ nginx.conf</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>vi /etc/nginx/conf.d/blog.bore.vip.conf
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ <code>http</code> æˆ– <code>server</code> é…ç½®ä¸‹æ·»åŠ </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>client_max_body_size 512M;
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œé…ç½®ä¸Šé™ä¸º 512 MBã€‚</p><p>4.é‡å¯nginxå’Œphp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>service nginx restart
</span></span><span class=line><span class=cl>service php7.3-fpm restart
</span></span></code></pre></td></tr></table></div></div><h2 id=nginx-command-not-found-è§£å†³æ–¹æ¡ˆ><code>nginx</code>: command not found è§£å†³æ–¹æ¡ˆ</h2><p>åªéœ€è¦è¾“å…¥<code>source /etc/profile</code> ï¼Œè®©é…ç½®æ–‡ä»¶é‡æ–°ç”Ÿæ•ˆä¸€ä¸‹å³å¯ã€‚</p><h2 id=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥</h2><ul><li><a class=link href=https://www.moerats.com/archives/69/ target=_blank rel=noopener>1.Linux æ¯æ—¥è‡ªåŠ¨å¤‡ä»½åˆ°FTPåŠæ•°æ®åº“é€šè¿‡é‚®ç®±å‘é€æ–¹æ³•</a></li><li><a class=link href=http://blog.sina.com.cn/s/blog_7edf8b9f0100to4p.html target=_blank rel=noopener>2.fetchmail: SMTP error: 552 5.3.4 Message size exceeds fixed limit</a></li><li><a class=link href="http://sufaming.com/?p=189" target=_blank rel=noopener>3.å¦‚ä½•å°†æœåŠ¡å™¨ä¸Šçš„ç½‘ç«™æ•°æ®å®šæ—¶è‡ªåŠ¨å¤‡ä»½åˆ°Dropbox</a></li><li><a class=link href=https://www.moerats.com/archives/858/ target=_blank rel=noopener>4.Linux å®šæ—¶å¤‡ä»½æœåŠ¡å™¨/ç½‘ç«™æ•°æ®åˆ°Githubç§äººä»“åº“</a></li><li><a class=link href=https://www.runoob.com/mysql/mysql-tutorial.html target=_blank rel=noopener>5.MySQL æ•™ç¨‹</a></li><li><a class=link href=https://precisionsec.com/changing-the-wordpress-site-url-using-the-mysql-command-line/ target=_blank rel=noopener>6.Changing the WordPress site URL using the MySQL command line</a></li><li><a class=link href=https://blog.csdn.net/jia12216/article/details/106098267 target=_blank rel=noopener>7.CentOs8ç³»ç»Ÿå®‰è£…mailxå‘é‚®ä»¶</a></li><li><a class=link href=https://github.com/andreafabrizi/Dropbox-Uploader/issues/459 target=_blank rel=noopener>8.Impossible to unlink</a></li><li><a class=link href=https://cloud.tencent.com/developer/article/1363216 target=_blank rel=noopener>9.å¦‚ä½•åœ¨Debian 9ä¸Šå®‰è£…å’Œé…ç½®Postfixä½œä¸ºä»…å‘é€SMTPæœåŠ¡</a></li><li><a class=link href=https://www.gubo.org/debian-lemp-script/ target=_blank rel=noopener>10.Debian LNMP/LEMP/WordPressä¸€é”®è„šæœ¬</a></li><li><a class=link href=https://blog.nex3z.com/2020/07/14/%E4%BF%AE%E6%94%B9-wordpress-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E9%99%90%E5%88%B6/ target=_blank rel=noopener>11.ä¿®æ”¹ WordPress ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶</a></li></ul></div><div class="shuoshuo-tags meta-wrapper" style=margin-top:15px!important;margin-bottom:5px!important;gap:10px!important><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px;color:var(--card-text-color-secondary)"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
<a href=/tags/halo/ class="meta-item shuoshuo-tag" title="æŸ¥çœ‹æ ‡ç­¾: halo"><span>#halo</span></a></div><div class=shuoshuo-footer-info><div class="shuoshuo-edit-link meta-wrapper" style=gap:15px!important><a href=https://github.com/iwyang/iwyang.github.io/edit/develop/content/post/halo%e5%ae%9a%e6%97%b6%e5%a4%87%e4%bb%bd%e7%9a%84%e6%96%b9%e6%b3%95/index.md target=_blank rel="noopener noreferrer" class=meta-item title="å‰å¾€ GitHub ç¼–è¾‘æ­¤é¡µ"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
<span>ç¼–è¾‘æ­¤é¡µ</span>
</a><span class=separator>|</span>
<a class="meta-item git-hash-text" href=https://github.com/iwyang/iwyang.github.io/commit/84e6bb501103ad84c414f9f438bf4cb7c38b876b target=_blank rel="noopener noreferrer" title="Commit Hash: 84e6bb5">#84e6bb5</a></div></div></article><article class=shuoshuo-card><div class=shuoshuo-header><div class="shuoshuo-meta meta-wrapper"><time class="shuoshuo-time meta-item" datetime=2020-07-24T02:21:25Z><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span>2020-07-24</span>
</time><span class="shuoshuo-updated-time meta-item" datetime=2026-02-18T15:52:01+08:00><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4A2 2 0 002 6v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121.0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
<span>2026-02-18</span></span></div></div><div class="shuoshuo-content style-cs-content article-post"><p>æœ¬æ•™ç¨‹ä»¥ <code>CentOS 7.x</code> ä¸ºä¾‹ï¼Œé…ç½®å¹¶è¿è¡Œ <code>Halo</code>ï¼Œå…¶ä»– Linux å‘è¡Œç‰ˆå¤§åŒå°å¼‚ã€‚</p><h2 id=å†™åœ¨å‰é¢>å†™åœ¨å‰é¢</h2><ol><li>å…·å¤‡ä¸€å®šçš„ Linux åŸºç¡€ã€‚</li><li>å¦‚éœ€åŸŸåç»‘å®šï¼Œè¯·å…ˆä¿è¯å·²ç»æ­£ç¡®è§£æ IPï¼Œä»¥åŠç¡®è®¤æœåŠ¡å™¨æ˜¯å¦éœ€è¦å¤‡æ¡ˆã€‚</li><li>å¦‚éœ€ä½¿ç”¨ IP è®¿é—®ï¼Œè¯·å…ˆç¡®ä¿ Halo çš„è¿è¡Œç«¯å£å·²ç»æ‰“å¼€ï¼Œé™¤éä½ ä½¿ç”¨ 80 ç«¯å£è¿è¡Œ Haloã€‚</li><li>å¦‚ 3 æ‰€è¿°ï¼Œå¦‚æœä½ ä½¿ç”¨äº†ç±»ä¼¼ <code>å®å¡”é¢æ¿</code> ä¹‹ç±»çš„ Linux ç®¡ç†é¢æ¿ï¼Œå¯èƒ½è¿˜éœ€è¦åœ¨é¢æ¿é‡Œè®¾ç½®ç«¯å£ã€‚</li><li>ä¸è¦æƒ³å½“ç„¶ï¼Œè¯·ä¸¥æ ¼æŒ‰ç…§æ–‡æ¡£çš„æµç¨‹æ“ä½œã€‚</li></ol><h2 id=win10é…ç½®javaç¯å¢ƒå˜é‡>Win10é…ç½®javaç¯å¢ƒå˜é‡</h2><h3 id=ä¸‹è½½-å®‰è£…jdk>ä¸‹è½½&& å®‰è£…JDK</h3><p>ä¸‹è½½åœ°å€ï¼šhttps://www.oracle.com/java/technologies/downloads/</p><p>2022.5.26 java18 æœ¬åœ°ä¸å¯ç”¨ï¼Œjava17 æœ¬åœ°å¯ç”¨ã€‚ï¼ˆhaloç‰ˆæœ¬ï¼š1.5.3ï¼‰</p><h3 id=ç¯å¢ƒå˜é‡é…ç½®>ç¯å¢ƒå˜é‡é…ç½®</h3><ol><li><p>æ‰“å¼€ ç¯å¢ƒå˜é‡çª—å£ï¼Œå³é”® <strong>This PC(æ­¤ç”µè„‘) -> Propertiesï¼ˆå±æ€§ï¼‰ -> Advanced system settingsï¼ˆé«˜çº§ç³»ç»Ÿè®¾ç½®ï¼‰ -> Environment Variablesï¼ˆç¯å¢ƒå˜é‡ï¼‰&mldr;</strong></p></li><li><p>æ–°å»ºJAVA_HOME å˜é‡ï¼Œç‚¹å‡» Newï¼ˆæ–°å»ºï¼‰&mldr; æŒ‰é’®ï¼Œè¾“å…¥:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>å˜é‡åï¼šJAVA_HOME
</span></span><span class=line><span class=cl>å˜é‡å€¼ï¼šç”µè„‘ä¸ŠJDKå®‰è£…çš„ç»å¯¹è·¯å¾„(ä¾‹å¦‚ï¼šC:\Program Files\Java\jdk-17.0.2)
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>æ–°å»º/ä¿®æ”¹ CLASSPATH å˜é‡ï¼Œå¦‚æœå­˜åœ¨ <strong>CLASSPATH</strong> å˜é‡ï¼Œé€‰ä¸­ç‚¹å‡» <strong>Edit(ç¼–è¾‘)</strong>ã€‚å¦‚æœæ²¡æœ‰ï¼Œç‚¹å‡» <strong>Newï¼ˆæ–°å»ºï¼‰&mldr;</strong> æ–°å»ºã€‚è¾“å…¥/åœ¨å·²æœ‰çš„å˜é‡å€¼åé¢æ·»åŠ ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>å˜é‡åï¼š</span><span class=n>CLASSPATH</span>
</span></span><span class=line><span class=cl><span class=err>å˜é‡å€¼ï¼š</span><span class=o>.</span><span class=p>;</span><span class=o>%</span><span class=n>JAVA_HOME</span><span class=o>%</span>\<span class=n>lib</span>\<span class=n>dt</span><span class=o>.</span><span class=n>jar</span><span class=p>;</span><span class=o>%</span><span class=n>JAVA_HOME</span><span class=o>%</span>\<span class=n>lib</span>\<span class=n>tools</span><span class=o>.</span><span class=n>jar</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>ä¿®æ”¹Path å˜é‡ã€‚ç”±äº win10 çš„ä¸åŒï¼Œå½“é€‰ä¸­ <strong>Path</strong> å˜é‡çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šå¾ˆæ–¹ä¾¿çš„æŠŠæ‰€æœ‰ä¸åŒè·¯å¾„éƒ½åˆ†å¼€äº†ï¼Œä¸ä¼šåƒ win7 æˆ–è€… win8 é‚£æ ·è¿åœ¨ä¸€èµ·ã€‚æ–°å»ºä¸¤æ¡è·¯å¾„ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>%</span><span class=n>JAVA_HOME</span><span class=p>%\</span><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=k>%</span><span class=n>JAVA_HOME</span><span class=p>%\</span><span class=n>jre</span><span class=p>\</span><span class=n>bin</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>æ£€æŸ¥ æ‰“å¼€ cmdï¼Œè¾“å…¥ <strong>java</strong>ï¼Œå‡ºç°ä¸€è¿ä¸²çš„æŒ‡ä»¤æç¤ºï¼Œè¯´æ˜é…ç½®æˆåŠŸäº†ã€‚</li></ol><h2 id=ç¯å¢ƒè¦æ±‚>ç¯å¢ƒè¦æ±‚</h2><p>ä¸ºäº†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸å‡ºç°æ„å¤–çš„äº‹æ•…ï¼Œç»™å‡ºä¸‹åˆ—æ¨èçš„é…ç½®</p><ul><li>CentOS 7.x</li><li>512 MB ä»¥ä¸Šå†…å­˜</li></ul><h2 id=æœåŠ¡å™¨é…ç½®>æœåŠ¡å™¨é…ç½®</h2><h3 id=æ›´æ–°è½¯ä»¶åŒ…>æ›´æ–°è½¯ä»¶åŒ…</h3><p>è¯·ç¡®ä¿æœåŠ¡å™¨çš„è½¯ä»¶åŒ…å·²ç»æ˜¯æœ€æ–°çš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum update -y
</span></span></code></pre></td></tr></table></div></div><h3 id=è£…-java-è¿è¡Œç¯å¢ƒ>è£… Java è¿è¡Œç¯å¢ƒ</h3><blockquote><p>è‹¥å·²ç»å­˜åœ¨ Java è¿è¡Œç¯å¢ƒçš„å¯ç•¥è¿‡è¿™ä¸€æ­¥ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£… OpenJRE</span>
</span></span><span class=line><span class=cl>sudo yum install java-11-openjdk -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ</span>
</span></span><span class=line><span class=cl>java -version
</span></span></code></pre></td></tr></table></div></div><p>å½“ç„¶ï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€ç§æ¯”è¾ƒç®€å•çš„å®‰è£…æ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å…¶ä»–æ–¹å¼ï¼Œå¹¶ä¸æ˜¯å¼ºåˆ¶è¦æ±‚ä½¿ç”¨è¿™ç§æ–¹å¼å®‰è£…ã€‚</p><h2 id=åˆ›å»º-halo-ç”¨æˆ·>åˆ›å»º Halo ç”¨æˆ·</h2><p><del>æˆ‘ä»¬æ¨èåˆ›å»ºä¸€ä¸ªä½æƒé™çš„ç”¨æˆ·è¿è¡Œ <code>halo</code></del>ï¼šï¼ˆè¿™ä¸€æ­¥æˆ‘æ²¡æœ‰è¿›è¡Œï¼Œç›´æ¥ç”¨rootï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># åˆ›å»º halo ç”¨æˆ·</span>
</span></span><span class=line><span class=cl>sudo useradd -m halo
</span></span><span class=line><span class=cl><span class=c1># ç›´æ¥ç™»å½•è¯¥ç”¨æˆ·</span>
</span></span><span class=line><span class=cl>sudo su halo
</span></span></code></pre></td></tr></table></div></div><h2 id=å®‰è£…-halo>å®‰è£… Halo</h2><h3 id=åˆ›å»ºå­˜æ”¾è¿è¡ŒåŒ…çš„ç›®å½•>åˆ›å»ºå­˜æ”¾è¿è¡ŒåŒ…çš„ç›®å½•</h3><p>åˆ›å»ºå­˜æ”¾ è¿è¡ŒåŒ… çš„ç›®å½•ï¼Œè¿™é‡Œä»¥ ~/app ä¸ºä¾‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir ~/app <span class=o>&amp;&amp;</span> <span class=nb>cd</span> ~/app
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¸‹è½½è¿è¡ŒåŒ…>ä¸‹è½½è¿è¡ŒåŒ…</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://dl.halo.run/release/halo-1.5.3.jar -O halo.jar
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆ›å»ºå·¥ä½œç›®å½•>åˆ›å»ºå·¥ä½œç›®å½•</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir ~/.halo <span class=o>&amp;&amp;</span> <span class=nb>cd</span> ~/.halo
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¸‹è½½é…ç½®æ–‡ä»¶>ä¸‹è½½é…ç½®æ–‡ä»¶</h3><p>è€ƒè™‘åˆ°éƒ¨åˆ†ç”¨æˆ·çš„éœ€è¦ï¼Œå¯èƒ½éœ€è¦è‡ªå®šä¹‰æ¯”å¦‚ç«¯å£ç­‰è®¾ç½®é¡¹ï¼Œæˆ‘ä»¬æä¾›äº†å…¬å…±çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”è¯¥é…ç½®æ–‡ä»¶æ˜¯å®Œå…¨ç‹¬ç«‹äºå®‰è£…åŒ…çš„ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®‰è£…åŒ…å†…çš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯å®‰è£…åŒ…å†…çš„é…ç½®æ–‡ä»¶æ˜¯ä¸å¯ä¿®æ”¹çš„ã€‚è¯·æ³¨æ„ï¼šé…ç½®æ–‡ä»¶çš„è·¯å¾„ä¸º <code>~/.halo/application.yaml</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä¸‹è½½é…ç½®æ–‡ä»¶åˆ° ~/.halo ç›®å½•</span>
</span></span><span class=line><span class=cl>wget https://dl.halo.run/config/application-template.yaml -O ./application.yaml 
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¿®æ”¹é…ç½®æ–‡ä»¶>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p>å®Œæˆä¸Šä¸€æ­¥æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±é…ç½® <code>Halo</code> çš„è¿è¡Œç«¯å£ï¼Œä»¥åŠæ•°æ®åº“ç›¸å…³çš„é…ç½®äº†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä½¿ç”¨ Vi å·¥å…·ä¿®æ”¹é…ç½®æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>vi ~/.halo/application.yaml
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>server</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8090</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Response data gzip.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>compression</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>datasource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># H2 database configuration.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>driver-class-name</span><span class=p>:</span><span class=w> </span><span class=l>org.h2.Driver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>jdbc:h2:file:~/.halo/db/halo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>admin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=m>123456</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># MySQL database configuration.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#    driver-class-name: com.mysql.cj.jdbc.Driver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#    url: jdbc:mysql://127.0.0.1:3306/halodb?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#    username: root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#    password: 123456</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># H2 database console configuration.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>h2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>console</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>settings</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>web-allow-others</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/h2-console</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>halo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Your admin client path is https://your-domain/{admin-path}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>admin-path</span><span class=p>:</span><span class=w> </span><span class=l>admin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># memory or level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cache</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol><li>å¦‚æœéœ€è¦è‡ªå®šä¹‰ç«¯å£ï¼Œä¿®æ”¹ <code>server</code> èŠ‚ç‚¹ä¸‹çš„ <code>port</code> å³å¯ã€‚</li><li>é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>H2 Database</code> æ•°æ®åº“ï¼Œè¿™æ˜¯ä¸€ç§åµŒå…¥å¼çš„æ•°æ®åº“ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç ä¸º <code>admin</code> å’Œ <code>123456</code>ï¼Œè¿™ä¸ªæ˜¯è‡ªå®šä¹‰çš„ï¼Œæœ€å¥½å°†å…¶ä¿®æ”¹ï¼Œå¹¶å¦¥å–„ä¿å­˜ã€‚</li><li>å¦‚æœéœ€è¦ä½¿ç”¨ <code>MySQL</code> æ•°æ®åº“ï¼Œéœ€è¦å°† <code>H2 Database</code> çš„æ‰€æœ‰ç›¸å…³é…ç½®éƒ½æ³¨é‡Šæ‰ï¼Œå¹¶å–æ¶ˆ <code>MySQL</code> çš„ç›¸å…³é…ç½®ã€‚å¦å¤–ï¼Œ<code>MySQL</code> çš„é»˜è®¤æ•°æ®åº“åä¸º <code>halodb</code>ï¼Œè¯·è‡ªè¡Œé…ç½® <code>MySQL</code> å¹¶åˆ›å»ºæ•°æ®åº“ï¼Œä»¥åŠä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</li><li><code>h2</code> èŠ‚ç‚¹ä¸º <code>H2 Database</code> çš„æ§åˆ¶å°é…ç½®ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¦‚éœ€ä½¿ç”¨è¯·å°† <code>h2.console.settings.web-allow-others</code> å’Œ <code>h2.console.enabled</code> è®¾ç½®ä¸º <code>true</code>ã€‚æ§åˆ¶å°åœ°å€å³ä¸º <code>åŸŸå/h2-console</code>ã€‚æ³¨æ„ï¼šéç´§æ€¥æƒ…å†µï¼Œä¸å»ºè®®å¼€å¯è¯¥é…ç½®ã€‚</li><li><code>server.compression.enabled</code> ä¸º <code>Gzip</code> åŠŸèƒ½é…ç½®ï¼Œå¦‚æœ‰éœ€è¦è¯·è®¾ç½®ä¸º <code>true</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨ <code>Nginx</code> æˆ–è€… <code>Caddy</code> è¿›è¡Œåå‘ä»£ç†çš„è¯ï¼Œé»˜è®¤æ˜¯æœ‰å¼€å¯ <code>Gzip</code> çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä¿æŒé»˜è®¤ã€‚</li><li><code>halo.admin-path</code> ä¸ºåå°ç®¡ç†çš„æ ¹è·¯å¾„ï¼Œé»˜è®¤ä¸º <code>admin</code>ï¼Œå¦‚æœä½ å®³æ€•åˆ«äººçŒœå‡ºæ¥é»˜è®¤çš„ <code>admin</code>ï¼ˆå°±ç®—çŒœå‡ºæ¥ï¼Œå¯¹æ–¹ä»€ä¹ˆéƒ½åšä¸äº†ï¼‰ï¼Œè¯·è‡ªè¡Œè®¾ç½®ã€‚ä»…æ”¯æŒä¸€çº§ï¼Œä¸”å‰åä¸å¸¦ <code>/</code>ã€‚</li><li><code>halo.cache</code> ä¸ºç³»ç»Ÿç¼“å­˜å½¢å¼çš„é…ç½®ï¼Œå¯é€‰ <code>memory</code> å’Œ <code>level</code>ï¼Œé»˜è®¤ä¸º <code>memory</code>ï¼Œå°†æ•°æ®ç¼“å­˜åˆ°å†…å­˜ï¼Œä½¿ç”¨è¯¥æ–¹å¼çš„è¯ï¼Œé‡å¯åº”ç”¨ä¼šå¯¼è‡´ç¼“å­˜æ¸…ç©ºã€‚å¦‚æœé€‰æ‹© <code>level</code>ï¼Œåˆ™ä¼šå°†æ•°æ®ç¼“å­˜åˆ°ç£ç›˜ï¼Œé‡å¯ä¸ä¼šæ¸…ç©ºç¼“å­˜ã€‚å¦‚ä¸çŸ¥é“å¦‚ä½•é€‰æ‹©ï¼Œå»ºè®®é»˜è®¤ã€‚</li></ol><p>æ³¨æ„ï¼šä½¿ç”¨ MySQL ä¹‹å‰ï¼Œå¿…é¡»è¦å…ˆæ–°å»ºä¸€ä¸ª <code>halodb</code> æ•°æ®åº“ï¼ŒMySQL ç‰ˆæœ¬éœ€ 5.7 ä»¥ä¸Šã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>halodb</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=n>utf8mb4</span><span class=w> </span><span class=k>collate</span><span class=w> </span><span class=n>utf8mb4_bin</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„ï¼šä½¿ç”¨ MySQL ä¹‹å‰ï¼Œå¿…é¡»è¦å…ˆæ–°å»ºä¸€ä¸ª halodb æ•°æ®åº“ï¼ŒMySQL ç‰ˆæœ¬éœ€ 5.7 ä»¥ä¸Šã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>create database halodb character <span class=nb>set</span> utf8mb4 collate utf8mb4_bin<span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è¿è¡Œ-halo>è¿è¡Œ Halo</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/app <span class=o>&amp;&amp;</span> java -jar halo.jar
</span></span></code></pre></td></tr></table></div></div><p>å¦‚çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—è¾“å‡ºï¼Œåˆ™ä»£è¡¨å¯åŠ¨æˆåŠŸ.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>run.halo.app.listener.StartedListener    : Halo started at         http://127.0.0.1:8090
</span></span><span class=line><span class=cl>run.halo.app.listener.StartedListener    : Halo admin started at   http://127.0.0.1:8090/admin
</span></span><span class=line><span class=cl>run.halo.app.listener.StartedListener    : Halo has started successfully!
</span></span></code></pre></td></tr></table></div></div><p>æç¤ºï¼šä»¥ä¸Šçš„å¯åŠ¨ä»…ä»…ä¸ºæµ‹è¯• Halo æ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¦‚æœæˆ‘ä»¬å…³é—­ ssh è¿æ¥ï¼ŒHalo ä¹Ÿå°†è¢«å…³é—­ã€‚è¦æƒ³ä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè¯·ç»§ç»­çœ‹ä¸‹é¢çš„æ•™ç¨‹ã€‚</p><h3 id=ä½œä¸ºæœåŠ¡è¿è¡Œ>ä½œä¸ºæœåŠ¡è¿è¡Œ</h3><p>ä¸Šé¢æˆ‘ä»¬å·²ç»å®Œæˆäº† Halo çš„æ•´ä¸ªé…ç½®å’Œå®‰è£…è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯¹å…¶è¿›è¡Œæ›´å®Œå–„çš„é…ç½®ï¼Œæ¯”å¦‚ï¼š<code>éœ€è¦å¼€æœºè‡ªå¯ï¼Ÿ</code>ï¼Œ<code>æ›´ç®€å•çš„å¯åŠ¨æ–¹å¼ï¼Ÿ</code></p><p>å®ç°ä»¥ä¸ŠåŠŸèƒ½æˆ‘ä»¬åªéœ€è¦æ–°å¢ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ <code>Systemd</code> æ¥å®Œæˆè¿™äº›å·¥ä½œã€‚</p><p>1.é€€å‡º halo è´¦æˆ·ï¼Œç™»å½•åˆ° root è´¦æˆ·</p><blockquote><p>å¦‚æœå½“å‰å°±æ˜¯ root è´¦æˆ·ï¼Œè¯·ç•¥è¿‡æ­¤æ­¥éª¤ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>exit</span>
</span></span></code></pre></td></tr></table></div></div><p>2.ä¸‹è½½ Halo å®˜æ–¹çš„ halo.service æ¨¡æ¿</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://dl.halo.run/config/halo.service -O /etc/systemd/system/halo.service
</span></span></code></pre></td></tr></table></div></div><p>3.ä¿®æ”¹ halo.service</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/systemd/system/halo.service
</span></span></code></pre></td></tr></table></div></div><p>4.ä¿®æ”¹é…ç½®</p><h3 id=ä¸‹è½½-halo-å®˜æ–¹çš„-haloservice-æ¨¡æ¿>ä¸‹è½½ Halo å®˜æ–¹çš„ halo.service æ¨¡æ¿</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>wget https://dl.halo.run/config/halo.service -O /etc/systemd/system/halo.service
</span></span></code></pre></td></tr></table></div></div><p>3.ä¿®æ”¹ halo.service
ä¸‹è½½å®Œæˆä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/systemd/system/halo.service
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p><ul><li><code>YOUR_JAR_PATH</code>ï¼šHalo è¿è¡ŒåŒ…çš„ç»å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ <code>/root/app/halo.jar</code>ï¼Œæ³¨æ„ï¼šæ­¤è·¯å¾„ä¸æ”¯æŒ ~ ç¬¦å·ã€‚</li><li><code>USER</code>ï¼šè¿è¡Œ Halo çš„ç³»ç»Ÿç”¨æˆ·ï¼Œå¦‚æœæœ‰æŒ‰ç…§ä¸Šæ–¹æ•™ç¨‹åˆ›å»ºæ–°çš„ç”¨æˆ·æ¥è¿è¡Œ Haloï¼Œä¿®æ”¹ä¸ºä½ åˆ›å»ºçš„ç”¨æˆ·åç§°å³å¯ã€‚åä¹‹è¯·åˆ é™¤ <strong>User=USER</strong>ã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[Unit]
</span></span><span class=line><span class=cl>Description=Halo Service
</span></span><span class=line><span class=cl>Documentation=https://halo.run
</span></span><span class=line><span class=cl>After=network-online.target
</span></span><span class=line><span class=cl>Wants=network-online.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[Service]
</span></span><span class=line><span class=cl>Type=simple
</span></span><span class=line><span class=cl>User=USER
</span></span><span class=line><span class=cl>ExecStart=/usr/bin/java -server -Xms256m -Xmx256m -jar YOUR_JAR_PATH
</span></span><span class=line><span class=cl>ExecStop=/bin/kill -s QUIT $MAINPID
</span></span><span class=line><span class=cl>Restart=always
</span></span><span class=line><span class=cl>StandOutput=syslog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>StandError=inherit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[Install]
</span></span><span class=line><span class=cl>WantedBy=multi-user.target
</span></span></code></pre></td></tr></table></div></div><p>å‚æ•°ï¼š</p><ul><li>-Xms256mï¼šä¸º JVM å¯åŠ¨æ—¶åˆ†é…çš„å†…å­˜ï¼Œè¯·æŒ‰ç…§æœåŠ¡å™¨çš„å†…å­˜åšé€‚å½“è°ƒæ•´ï¼Œ512 M å†…å­˜çš„æœåŠ¡å™¨æ¨èè®¾ç½®ä¸º 128ï¼Œ1G å†…å­˜çš„æœåŠ¡å™¨æ¨èè®¾ç½®ä¸º 256ï¼Œé»˜è®¤ä¸º 256ã€‚</li><li>-Xmx256mï¼šä¸º JVM è¿è¡Œè¿‡ç¨‹ä¸­åˆ†é…çš„æœ€å¤§å†…å­˜ï¼Œé…ç½®åŒä¸Šã€‚</li><li>YOUR_JAR_PATHï¼šHalo å®‰è£…åŒ…çš„ç»å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ <code>/www/wwwroot/halo-latest.jar</code>ã€‚</li></ul><p>æç¤ºï¼š</p><ol><li>å¦‚æœä½ ä¸æ˜¯æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å®‰è£…çš„ JDKï¼Œè¯·ç¡®ä¿ <code>/usr/bin/java</code> æ˜¯æ­£ç¡®æ— è¯¯çš„ã€‚</li><li>systemd ä¸­çš„æ‰€æœ‰è·¯å¾„å‡è¦å†™ä¸ºç»å¯¹è·¯å¾„ï¼Œå¦å¤–ï¼Œ<code>~</code> åœ¨ systemd ä¸­ä¹Ÿæ˜¯æ— æ³•è¢«è¯†åˆ«çš„ï¼Œæ‰€ä»¥ä½ ä¸èƒ½å†™æˆç±»ä¼¼ <code>~/halo-latest.jar</code> è¿™ç§è·¯å¾„ã€‚</li><li>å¦‚ä½•æ£€éªŒæ˜¯å¦ä¿®æ”¹æ­£ç¡®ï¼šæŠŠ ExecStart ä¸­çš„å‘½ä»¤æ‹¿å‡ºæ¥æ‰§è¡Œä¸€éã€‚</li></ol><p>5.é‡æ–°åŠ è½½ systemd</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä¿®æ”¹ service æ–‡ä»¶ä¹‹åéœ€è¦åˆ·æ–° Systemd</span>
</span></span><span class=line><span class=cl>systemctl daemon-reload
</span></span></code></pre></td></tr></table></div></div><p>6.è¿è¡ŒæœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl start halo
</span></span></code></pre></td></tr></table></div></div><p>7.åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl <span class=nb>enable</span> halo
</span></span></code></pre></td></tr></table></div></div><p>æ‚¨å¯ä»¥æŸ¥çœ‹æœåŠ¡æ—¥å¿—æ£€æŸ¥å¯åŠ¨çŠ¶æ€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>journalctl -n <span class=m>20</span> -u halo
</span></span></code></pre></td></tr></table></div></div><h2 id=é…ç½®åŸŸåè®¿é—®>é…ç½®åŸŸåè®¿é—®</h2><ol><li>å‡è®¾ä½ å·²ç»æˆåŠŸé…ç½®å¹¶è¿è¡Œå¥½äº† Haloï¼Œä¸”ä¸æ˜¯ä½¿ç”¨ 80 ç«¯å£è¿è¡Œã€‚</li><li>è¯·ç¡®ä¿åŸŸåå·²ç»æˆåŠŸè§£æåˆ°æœåŠ¡å™¨ IPï¼Œå¹¶ç¡®è®¤æœåŠ¡å™¨æ˜¯å¦éœ€è¦å¤‡æ¡ˆã€‚</li><li>è¯·æ£€æŸ¥æœåŠ¡å™¨çš„ 80 å’Œ 443 ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</li><li>å¦‚ 3 æ‰€è¿°ï¼Œå¦‚æœä½ ä½¿ç”¨äº†ç±»ä¼¼ <code>å®å¡”é¢æ¿</code> ä¹‹ç±»çš„ Linux ç®¡ç†é¢æ¿ï¼Œå¯èƒ½è¿˜éœ€è¦åœ¨é¢æ¿é‡Œè®¾ç½®ç«¯å£ã€‚</li><li>å¹¶ä¸ä¸€å®šè¦æ±‚æŒ‰ç…§ä¸‹åˆ—æ•™ç¨‹æ“ä½œï¼Œè¿™é‡Œä»…ä»…ä»¥ä¾›å‚è€ƒã€‚</li><li>å¦‚ 2 æ‰€è¿°ï¼Œä½ éœ€è¦åšçš„ä»…ä»…æ˜¯åå‘ä»£ç† Halo è¿è¡Œç«¯å£ï¼Œå¹¶é…ç½® SSL è¯ä¹¦è€Œå·²ï¼Œæ‰€ä»¥å¹¶ä¸è¦æ±‚é…ç½®æ–¹å¼ã€‚</li></ol><h3 id=ä½¿ç”¨-nginx-è¿›è¡Œåå‘ä»£ç†>ä½¿ç”¨ Nginx è¿›è¡Œåå‘ä»£ç†</h3><p>æˆ‘ä½¿ç”¨çš„æ˜¯è¿™ä¸€ç§æ–¹æ³•ã€‚</p><h4 id=å®‰è£…-nginx>å®‰è£… Nginx</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æ·»åŠ  Nginx æº</span>
</span></span><span class=line><span class=cl>sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®‰è£… Nginx</span>
</span></span><span class=line><span class=cl>sudo yum install -y nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨ Nginx</span>
</span></span><span class=line><span class=cl>sudo systemctl start nginx.service
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¾ç½®å¼€æœºè‡ªå¯ Nginx</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> nginx.service
</span></span></code></pre></td></tr></table></div></div><h4 id=é…ç½®-nginx>é…ç½® Nginx</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä¸‹è½½ Halo å®˜æ–¹çš„ Nginx é…ç½®æ¨¡æ¿</span>
</span></span><span class=line><span class=cl>curl -o /etc/nginx/conf.d/halo.conf --create-dirs https://dl.halo.run/config/nginx.conf
</span></span></code></pre></td></tr></table></div></div><p>ä¸‹è½½å®Œæˆä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä½¿ç”¨ vim ç¼–è¾‘ halo.conf</span>
</span></span><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>upstream</span> <span class=s>halo</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kn>server</span> <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>8090</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kn>listen</span> <span class=s>[::]:80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kn>server_name</span> <span class=s>www.yourdomain.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kn>client_max_body_size</span> <span class=mi>1024m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_pass</span> <span class=s>http://halo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>HOST</span> <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-Proto</span> <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„ï¼šNginx é»˜è®¤çš„ client_max_body_size é…ç½®å¤§å°ä¸º 1mï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½ åœ¨ Halo åå°ä¸Šä¼ æ–‡ä»¶è¢« Nginx é™åˆ¶ï¼Œæ‰€ä»¥æ­¤ç¤ºä¾‹é…ç½®æ–‡ä»¶åŠ ä¸Šäº† client_max_body_size 1024m; è¿™è¡Œé…ç½®ã€‚å½“ç„¶ï¼Œ1024m å¯æ ¹æ®ä½ çš„éœ€è¦è‡ªè¡Œä¿®æ”¹ã€‚</p><p>ä¿®æ”¹å®Œæˆä¹‹å</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æ£€æŸ¥é…ç½®æ˜¯å¦æœ‰è¯¯</span>
</span></span><span class=line><span class=cl>sudo nginx -t
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é‡è½½ Nginx é…ç½®</span>
</span></span><span class=line><span class=cl>sudo nginx -s reload
</span></span></code></pre></td></tr></table></div></div><h3 id=é…ç½®é˜¿é‡Œäº‘å…è´¹è¯ä¹¦ssl-è¯ä¹¦>é…ç½®é˜¿é‡Œäº‘å…è´¹è¯ä¹¦SSL è¯ä¹¦</h3><p>ç›®å‰ä½¿ç”¨çš„æ˜¯Letâ€™s Encrypt å…è´¹è¯ä¹¦ã€‚</p><p>1.åœ¨nginxæ ¹ç›®å½•ï¼ˆé»˜è®¤ä¸º/etc/nginxï¼‰ä¸‹åˆ›å»ºç›®å½•certã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd /etc/nginx
</span></span><span class=line><span class=cl>mkdir cert
</span></span></code></pre></td></tr></table></div></div><p>2.æŠŠä¸‹è½½çš„è¯ä¹¦ä¸¤ä¸ªæ–‡ä»¶.pemå’Œ.keyä¸Šä¼ åˆ°ç›®å½•certä¸­ã€‚</p><p>3.ä¿®æ”¹nginxé…ç½®æ–‡ä»¶ï¼ˆç›®å‰ä½¿ç”¨çš„æ˜¯ä¸‹é¢çš„å®˜æ–¹æ¨èé…ç½®ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><p><del>è‡ªå®šä¹‰é…ç½®</del>(ä¸è¦ç”¨è¿™ä¸ªï¼Œç”¨ä¸‹é¢çš„å®˜æ–¹é…ç½®ï¼‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>server {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>listen 80;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>server_name bore.vip www.bore.vip;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>rewrite ^(.*)$ https://$host$1 permanent;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>client_max_body_size 1024m;</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=l>server {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>listen 443 ssl;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>server_name bore.vip;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_certificate /etc/nginx/cert/bore.vip.pem;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_certificate_key /etc/nginx/cert/bore.vip.key;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_session_timeout 5m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>ssl_prefer_server_ciphers on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>location / {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>proxy_set_header HOST $host;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>proxy_set_header X-Forwarded-Proto $scheme;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>proxy_set_header X-Real-IP $remote_addr;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>proxy_pass http://127.0.0.1:8090/;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>}<span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å®˜æ–¹æ¨èé…ç½®ï¼ˆç”¨è¿™ä¸ªï¼‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>upstream halo {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>server 127.0.0.1:8090;</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=l>server {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen 80;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen [::]:80;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen 443 ssl http2;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen [::]:443 ssl http2;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>server_name bore.vip www.bore.vip;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>if ($host != &#39;bore.vip&#39; ) {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>rewrite ^/(.*)$ https://bore.vip/$1 permanent;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>client_max_body_size 1024m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_certificate /etc/nginx/cert/bore.vip.pem;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_certificate_key /etc/nginx/cert/bore.vip.key;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_prefer_server_ciphers on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_session_timeout 10m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_session_cache builtin:1000 shared:SSL:10m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_buffer_size 1400;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>add_header Strict-Transport-Security max-age=15768000;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_stapling on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_stapling_verify on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>index index.html index.htm index.php;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>root /data/wwwroot/bore.vip;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>if ($ssl_protocol = &#34;&#34;) { return 301 https://$host$request_uri; }</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#error_page 404 /404.html;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#error_page 502 /502.html;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>expires 30d;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>access_log off;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ .*\.(js|css)?$ {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>expires 7d;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>access_log off;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ /(\.user\.ini|\.ht|\.git|\.svn|\.project|LICENSE|README\.md) {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>deny all;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location / {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header HOST $host;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Forwarded-Proto $scheme;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Real-IP $remote_addr;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>4.é‡å¯nginxæœåŠ¡ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><h3 id=æ·»åŠ -lets-encrypt-å…è´¹è¯ä¹¦>æ·»åŠ  Let&rsquo;s Encrypt å…è´¹è¯ä¹¦</h3><h4 id=centos-8><strong>Centos 8</strong></h4><ol><li>å®‰è£…Certbot</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install epel-release -y
</span></span><span class=line><span class=cl>yum install certbot -y
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>æ–°å»ºç›¸åº”æ–‡ä»¶å¤¹
ç”±äºé…ç½®äº†åå‘ä»£ç†ï¼Œä¸ºäº†é¡ºåˆ©ç”³è¯·è¯ä¹¦ï¼Œéœ€è¦æ–°å»ºæ–‡ä»¶å¤¹ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -p /data/wwwroot/bore.vip
</span></span><span class=line><span class=cl>mkdir -p /data/wwwlogs
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>é…ç½®Nginx http 80ç«¯å£</li></ol><p>ä¸ºäº†ä½¿ä¸‹é¢ç”³è¯·è¯ä¹¦æ—¶èƒ½è®¿é—®http://bore.vip/.well-known/acme-challenge/&mldr;&mldr;.è¿™ä¸ªé“¾æ¥ï¼Œé¦–å…ˆé…ç½®å¥½</p><p>Nginx 80ç«¯å£ï¼Œä¿è¯ä¸Šè¿°ç½‘å€èƒ½é¡ºåˆ©è®¿é—®ï¼Œä»è€Œé¡ºåˆ©ç”³è¯·è¯ä¹¦ã€‚</p><p>ç”±äºé…ç½®äº†åå‘ä»£ç†ï¼Œæ‰€ä»¥åœ¨éªŒè¯çš„æ—¶å€™æ˜¯æ— æ³•ç›´æ¥è®¿é—®åˆ°ç«™ç‚¹ç›®å½•ä¸‹çš„ .well-known æ–‡ä»¶å¤¹ä¸‹çš„éªŒè¯æ–‡</p><p>ä»¶çš„ã€‚æ‰€ä»¥åœ¨nginxé…ç½®çš„serverèŠ‚ç‚¹ä¸‹æ·»åŠ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>  default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/demo.halo.run/<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šè¿°ä»£ç å¦‚æœä¸è¡Œï¼Œè¯•ä¸‹ä¸‹é¢çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ /.well-known <span class=o>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â allow all<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¼–è¾‘<code>halo.conf</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>  listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>  server_name bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  client_max_body_size 1024m<span class=p>;</span>
</span></span><span class=line><span class=cl>  location / <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>    default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /data/wwwroot/bore.vip/<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>ç”³è¯·è¯ä¹¦</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certbot certonly --webroot -w /data/wwwroot/bore.vip -d bore.vip -m 455343442@qq.com --agree-tos
</span></span></code></pre></td></tr></table></div></div><p>ç›¸å…³å‚æ•°å«ä¹‰ï¼š</p><ul><li>â€“webrootæ˜¯è¿è¡Œæ¨¡å¼</li><li>standaloneæ¨¡å¼ï¼šéœ€è¦åœæ­¢å½“å‰çš„ web server æœåŠ¡ï¼Œè®©å‡º 80 ç«¯å£ï¼Œç”±å®¢æˆ·ç«¯å†…ç½®çš„ web server å¯åŠ¨ä¸Letâ€™ s Encrypté€šä¿¡ã€‚</li></ul><ul><li>webrootæ¨¡å¼ï¼šä¸éœ€è¦åœæ­¢å½“å‰ web serverï¼Œä½†éœ€è¦åœ¨åŸŸåæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œå¹¶è¦ä¿è¯å¤–ç½‘é€šè¿‡åŸŸåå¯ä»¥è®¿é—®è¿™ä¸ªç›®å½•ã€‚</li></ul><ul><li>-w æŒ‡å®šç½‘ç«™æ‰€åœ¨ç›®å½•</li><li>-d æŒ‡å®šç½‘ç«™åŸŸå</li><li>-m æŒ‡å®šè”ç³»é‚®ç®±ï¼Œå¡«å†™çœŸå®æœ‰æ•ˆçš„ï¼Œletsencryptä¼šåœ¨è¯ä¹¦åœ¨è¿‡æœŸä»¥å‰å‘é€é¢„å‘Šçš„é€šçŸ¥é‚®ä»¶</li><li>agree-tos è¡¨ç¤ºæ¥å—ç›¸å…³åè®®</li></ul><p>ä½¿ç”¨webrootæ¨¡å¼ï¼ŒCertbotåœ¨éªŒè¯æœåŠ¡å™¨åŸŸåçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªéšæœºæ–‡ä»¶ï¼Œç„¶åCertbotçš„æœåŠ¡å™¨ä¼šé€šè¿‡HTTPè®¿é—®ä½ çš„è¿™ä¸ªæ–‡ä»¶ï¼Œå› æ­¤è¦ç¡®ä¿ä½ çš„ Nginx é…ç½®å¥½ï¼Œä»¥ä¾¿å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚å¦åˆ™ä¼šè¿”å›403é”™è¯¯ï¼Œåœ¨nginxé…ç½®çš„serverèŠ‚ç‚¹ä¸‹æ·»åŠ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl> default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> allow all<span class=p>;</span>
</span></span><span class=line><span class=cl> root /data/wwwroot/demo.halo.run/<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šè¿°ä»£ç å¦‚æœä¸è¡Œï¼Œè¯•ä¸‹ä¸‹é¢çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ /.well-known <span class=o>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â allow all<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>é…ç½®Nginx</li></ol><p>ç¼–è¾‘<code>halo.conf</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>  listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=m>443</span> ssl http2<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:443 ssl http2<span class=p>;</span>
</span></span><span class=line><span class=cl>  server_name bore.vip www.bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$host</span> !<span class=o>=</span> <span class=s1>&#39;bore.vip&#39;</span> <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      rewrite ^/<span class=o>(</span>.*<span class=o>)</span>$ https://bore.vip/<span class=nv>$1</span> permanent<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  client_max_body_size 1024m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate /etc/letsencrypt/live/bore.vip/fullchain.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate_key /etc/letsencrypt/live/bore.vip/privkey.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_prefer_server_ciphers on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_timeout 10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_cache builtin:1000 shared:SSL:10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_buffer_size 1400<span class=p>;</span>
</span></span><span class=line><span class=cl>  add_header Strict-Transport-Security max-age<span class=o>=</span>15768000<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling_verify on<span class=p>;</span>
</span></span><span class=line><span class=cl>  access_log /data/wwwlogs/bore.vip_nginx.log combined<span class=p>;</span>
</span></span><span class=line><span class=cl>  index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$ssl_protocol</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$host$request_uri</span><span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 404 /404.html;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 502 /502.html;</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>gif<span class=p>|</span>jpg<span class=p>|</span>jpeg<span class=p>|</span>png<span class=p>|</span>bmp<span class=p>|</span>swf<span class=p>|</span>flv<span class=p>|</span>mp4<span class=p>|</span>ico<span class=o>)</span>$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 30d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>js<span class=p>|</span>css<span class=o>)</span>?$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 7d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ /<span class=o>(</span><span class=se>\.</span>user<span class=se>\.</span>ini<span class=p>|</span><span class=se>\.</span>ht<span class=p>|</span><span class=se>\.</span>git<span class=p>|</span><span class=se>\.</span>svn<span class=p>|</span><span class=se>\.</span>project<span class=p>|</span>LICENSE<span class=p>|</span>README<span class=se>\.</span>md<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    deny all<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location / <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>    default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /data/wwwroot/bore.vip/<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æµ‹è¯•é…ç½®æ˜¯å¦æœ‰é—®é¢˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nginx -t
</span></span></code></pre></td></tr></table></div></div><p>é‡å¯Nginxç”Ÿæ•ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><ol start=6><li>è¯ä¹¦è‡ªåŠ¨æ›´æ–°
ç”±äºè¿™ä¸ªè¯ä¹¦çš„æ—¶æ•ˆåªæœ‰ 90 å¤©ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®è‡ªåŠ¨æ›´æ–°çš„åŠŸèƒ½ï¼Œå¸®æˆ‘ä»¬è‡ªåŠ¨æ›´æ–°è¯ä¹¦çš„æ—¶æ•ˆã€‚é¦–å…ˆå…ˆåœ¨å‘½ä»¤è¡Œæ¨¡æ‹Ÿè¯ä¹¦æ›´æ–°ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certbot renew --dry-run
</span></span></code></pre></td></tr></table></div></div><p>æ¨¡æ‹Ÿæ›´æ–°æˆåŠŸçš„æ•ˆæœå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>special</span><span class=o>-</span><span class=n>beep</span><span class=o>-</span><span class=mi>1</span> <span class=o>~</span><span class=p>]</span><span class=c1># certbot renew --dry-run</span>
</span></span><span class=line><span class=cl><span class=n>Saving</span> <span class=n>debug</span> <span class=nb>log</span> <span class=n>to</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>.</span><span class=n>log</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>Processing</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>/</span><span class=n>renewal</span><span class=o>/</span><span class=n>blog</span><span class=o>.</span><span class=n>bore</span><span class=o>.</span><span class=n>vip</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>Simulating</span> <span class=n>renewal</span> <span class=n>of</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>certificate</span> <span class=k>for</span> <span class=n>blog</span><span class=o>.</span><span class=n>bore</span><span class=o>.</span><span class=n>vip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>Processing</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>/</span><span class=n>renewal</span><span class=o>/</span><span class=n>bore</span><span class=o>.</span><span class=n>vip</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>Simulating</span> <span class=n>renewal</span> <span class=n>of</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>certificate</span> <span class=k>for</span> <span class=n>bore</span><span class=o>.</span><span class=n>vip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>Congratulations</span><span class=p>,</span> <span class=n>all</span> <span class=n>simulated</span> <span class=n>renewals</span> <span class=n>succeeded</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>/</span><span class=n>live</span><span class=o>/</span><span class=n>blog</span><span class=o>.</span><span class=n>bore</span><span class=o>.</span><span class=n>vip</span><span class=o>/</span><span class=n>fullchain</span><span class=o>.</span><span class=n>pem</span> <span class=p>(</span><span class=n>success</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>letsencrypt</span><span class=o>/</span><span class=n>live</span><span class=o>/</span><span class=n>bore</span><span class=o>.</span><span class=n>vip</span><span class=o>/</span><span class=n>fullchain</span><span class=o>.</span><span class=n>pem</span> <span class=p>(</span><span class=n>success</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span> <span class=o>-</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æ— æ³•ç¡®è®¤ä½ çš„ nginx é…ç½®æ˜¯å¦æ­£ç¡®æ—¶ï¼Œä¸€å®šè¦è¿è¡Œæ¨¡æ‹Ÿæ›´æ–°å‘½ä»¤ï¼Œç¡®ä¿certbotå’ŒæœåŠ¡å™¨é€šè®¯æ­£å¸¸ã€‚ä½¿ç”¨ <code>crontab -e</code> çš„å‘½ä»¤æ¥å¯ç”¨è‡ªåŠ¨ä»»åŠ¡ï¼Œå‘½ä»¤è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><p>æ·»åŠ é…ç½®ï¼šï¼ˆæ¯éš”ä¸¤ä¸ªæœˆå‡Œæ™¨2:30è‡ªåŠ¨æ‰§è¡Œè¯ä¹¦æ›´æ–°æ“ä½œï¼‰åä¿å­˜é€€å‡ºã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>30</span> <span class=m>2</span> * */2 * /usr/bin/certbot renew --quiet <span class=o>&amp;&amp;</span> /bin/systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥çœ‹è¯ä¹¦æœ‰æ•ˆæœŸçš„å‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -noout -dates -in /etc/letsencrypt/live/bore.vip/cert.pem
</span></span></code></pre></td></tr></table></div></div><p>PS:å¦‚æœå¤±è´¥ï¼Œå…ˆç”³è¯·é˜¿é‡Œè¯ä¹¦ï¼Œå†ç”³è¯·Let&rsquo;s Encrypt SSLè¯ä¹¦ï¼Œè®°å¾—è¦æ·»åŠ  acme.sh ç»­ç­¾éªŒè¯è·¯ç”±ï¼Œæ‰èƒ½ç”³è¯·Let&rsquo;s Encrypt SSLè¯ä¹¦ã€‚</p><h4 id=debian10>Debian10</h4><ol><li>å®‰è£… Certbot</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install letsencrypt
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>æ–°å»ºç›¸åº”æ–‡ä»¶å¤¹</li></ol><p>ç”±äºé…ç½®äº†åå‘ä»£ç†ï¼Œä¸ºäº†é¡ºåˆ©ç”³è¯·è¯ä¹¦ï¼Œéœ€è¦æ–°å»ºæ–‡ä»¶å¤¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -p /data/wwwroot/bore.vip
</span></span><span class=line><span class=cl>mkdir -p /data/wwwlogs
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>é…ç½®Nginx http 80ç«¯å£</li></ol><p>ä¸ºäº†ä½¿ä¸‹é¢ç”³è¯·è¯ä¹¦æ—¶èƒ½è®¿é—®http://bore.vip/.well-known/acme-challenge/â€¦è¿™ä¸ªé“¾æ¥ï¼Œé¦–å…ˆé…ç½®å¥½</p><p>Nginx 80ç«¯å£ï¼Œä¿è¯ä¸Šè¿°ç½‘å€èƒ½é¡ºåˆ©è®¿é—®ï¼Œä»è€Œé¡ºåˆ©ç”³è¯·è¯ä¹¦ã€‚æ‰€ä»¥åœ¨nginxé…ç½®çš„serverèŠ‚ç‚¹ä¸‹æ·»åŠ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>  default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/demo.halo.run/<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šè¿°ä»£ç å¦‚æœä¸è¡Œï¼Œè¯•ä¸‹ä¸‹é¢çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ /.well-known <span class=o>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â allow all<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>ç¼–è¾‘<code>halo.conf</code></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>  listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>  server_name bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  client_max_body_size 1024m<span class=p>;</span>
</span></span><span class=line><span class=cl>  location / <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>    default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /data/wwwroot/bore.vip/<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é‡å¯ Nginx ç”Ÿæ•ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>ä½¿ç”¨ webroot è‡ªåŠ¨ç”Ÿæˆè¯ä¹¦</li></ol><p>Certbot æ”¯æŒå¤šç§ä¸åŒçš„ã€Œæ’ä»¶ã€æ¥è·å–è¯ä¹¦ï¼Œè¿™é‡Œé€‰æ‹©ä½¿ç”¨ webroot æ’ä»¶ï¼Œå®ƒå¯ä»¥åœ¨ä¸åœæ­¢ Web æœåŠ¡å™¨çš„å‰æä¸‹è‡ªåŠ¨ç”Ÿæˆè¯ä¹¦ï¼Œä½¿ç”¨ &ndash;webroot å‚æ•°æŒ‡å®šç½‘ç«™çš„æ ¹ç›®å½•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certbot certonly --webroot -w /data/wwwroot/bore.vip -d bore.vip -m 455343442@qq.com --agree-tos
</span></span></code></pre></td></tr></table></div></div><blockquote><p>PSï¼šç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œä¸è¦ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>letsencrypt certonly --webroot -w /data/wwwroot/bore.vip -d bore.vip -m 455343442@qq.com --agree-tos
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ ·ï¼Œåœ¨ /var/www/hexo ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶æ–‡ä»¶ .well-known/acme-challenge ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æ¥è¯æ˜å¯¹åŸŸå iwyang.top çš„æ§åˆ¶æƒï¼Œç„¶å Letâ€™s Encrypt éªŒè¯æœåŠ¡å™¨å‘å‡º HTTP è¯·æ±‚ï¼ŒéªŒè¯æ¯ä¸ªè¯·æ±‚çš„åŸŸçš„ DNS è§£æï¼ŒéªŒè¯æˆåŠŸå³é¢å‘è¯ä¹¦ã€‚</p><p>ç”Ÿæˆçš„ pem å’Œ key åœ¨ /etc/letsencrypt/live/ ç›®å½•ä¸‹</p><ol start=6><li>é…ç½®Nginx</li></ol><p>ç¼–è¾‘<code>halo.conf</code>ï¼Œæœªå¼€å¯443ç«¯å£å¤ç”¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>  listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=m>443</span> ssl http2<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:443 ssl http2<span class=p>;</span>
</span></span><span class=line><span class=cl>  server_name bore.vip www.bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$host</span> !<span class=o>=</span> <span class=s1>&#39;bore.vip&#39;</span> <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      rewrite ^/<span class=o>(</span>.*<span class=o>)</span>$ https://bore.vip/<span class=nv>$1</span> permanent<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  client_max_body_size 1024m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate /etc/letsencrypt/live/bore.vip/fullchain.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate_key /etc/letsencrypt/live/bore.vip/privkey.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_prefer_server_ciphers on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_timeout 10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_cache builtin:1000 shared:SSL:10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_buffer_size 1400<span class=p>;</span>
</span></span><span class=line><span class=cl>  add_header Strict-Transport-Security max-age<span class=o>=</span>15768000<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling_verify on<span class=p>;</span>
</span></span><span class=line><span class=cl>  access_log /data/wwwlogs/bore.vip_nginx.log combined<span class=p>;</span>
</span></span><span class=line><span class=cl>  index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$ssl_protocol</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$host$request_uri</span><span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 404 /404.html;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 502 /502.html;</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>gif<span class=p>|</span>jpg<span class=p>|</span>jpeg<span class=p>|</span>png<span class=p>|</span>bmp<span class=p>|</span>swf<span class=p>|</span>flv<span class=p>|</span>mp4<span class=p>|</span>ico<span class=o>)</span>$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 30d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>js<span class=p>|</span>css<span class=o>)</span>?$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 7d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ /<span class=o>(</span><span class=se>\.</span>user<span class=se>\.</span>ini<span class=p>|</span><span class=se>\.</span>ht<span class=p>|</span><span class=se>\.</span>git<span class=p>|</span><span class=se>\.</span>svn<span class=p>|</span><span class=se>\.</span>project<span class=p>|</span>LICENSE<span class=p>|</span>README<span class=se>\.</span>md<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    deny all<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location / <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>    default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /data/wwwroot/bore.vip/<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœå¼€å¯443ç«¯å£å¤ç”¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>  listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen 127.0.0.1:443 ssl http2 proxy_protocol<span class=p>;</span>
</span></span><span class=line><span class=cl>  listen <span class=o>[</span>::<span class=o>]</span>:443 ssl http2<span class=p>;</span>
</span></span><span class=line><span class=cl>  set_real_ip_from 127.0.0.1<span class=p>;</span>
</span></span><span class=line><span class=cl>  real_ip_header proxy_protocol<span class=p>;</span>
</span></span><span class=line><span class=cl>  server_name bore.vip www.bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$host</span> !<span class=o>=</span> <span class=s1>&#39;bore.vip&#39;</span> <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      rewrite ^/<span class=o>(</span>.*<span class=o>)</span>$ https://bore.vip/<span class=nv>$1</span> permanent<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span> 
</span></span><span class=line><span class=cl>  client_max_body_size 1024m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate /etc/letsencrypt/live/bore.vip/fullchain.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_certificate_key /etc/letsencrypt/live/bore.vip/privkey.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_prefer_server_ciphers on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_timeout 10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_session_cache builtin:1000 shared:SSL:10m<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_buffer_size 1400<span class=p>;</span>
</span></span><span class=line><span class=cl>  add_header Strict-Transport-Security max-age<span class=o>=</span>15768000<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling on<span class=p>;</span>
</span></span><span class=line><span class=cl>  ssl_stapling_verify on<span class=p>;</span>
</span></span><span class=line><span class=cl>  access_log /data/wwwlogs/bore.vip_nginx.log combined<span class=p>;</span>
</span></span><span class=line><span class=cl>  index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/bore.vip<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(</span><span class=nv>$ssl_protocol</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$host$request_uri</span><span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 404 /404.html;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#error_page 502 /502.html;</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>gif<span class=p>|</span>jpg<span class=p>|</span>jpeg<span class=p>|</span>png<span class=p>|</span>bmp<span class=p>|</span>swf<span class=p>|</span>flv<span class=p>|</span>mp4<span class=p>|</span>ico<span class=o>)</span>$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 30d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ .*<span class=se>\.</span><span class=o>(</span>js<span class=p>|</span>css<span class=o>)</span>?$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>    expires 7d<span class=p>;</span>
</span></span><span class=line><span class=cl>    access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ~ /<span class=o>(</span><span class=se>\.</span>user<span class=se>\.</span>ini<span class=p>|</span><span class=se>\.</span>ht<span class=p>|</span><span class=se>\.</span>git<span class=p>|</span><span class=se>\.</span>svn<span class=p>|</span><span class=se>\.</span>project<span class=p>|</span>LICENSE<span class=p>|</span>README<span class=se>\.</span>md<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    deny all<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location / <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>    default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /data/wwwroot/bore.vip/<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span> 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æµ‹è¯•é…ç½®æ˜¯å¦æœ‰é—®é¢˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nginx -t
</span></span></code></pre></td></tr></table></div></div><p>é‡å¯Nginxç”Ÿæ•ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><ol start=7><li>è‡ªåŠ¨ç»­æœŸ</li></ol><p>Letâ€™s Encrypt çš„è¯ä¹¦æœ‰æ•ˆæœŸä¸º 90 å¤©ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ crontab å®šæ—¶è¿è¡Œå‘½ä»¤æ›´æ–°è¯ä¹¦ã€‚</p><p>å…ˆè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•è¯ä¹¦çš„è‡ªåŠ¨æ›´æ–°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certbot renew --dry-run
</span></span></code></pre></td></tr></table></div></div><blockquote><p>PSï¼šç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œä¸è¦ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p></blockquote><p><code>letsencrypt renew --dry-run --agree-tos</code></p><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°±å¯ä»¥ç¼–è¾‘ crontab å®šæœŸè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>30</span> <span class=m>2</span> * */2 * /usr/bin/certbot renew --quiet <span class=o>&amp;&amp;</span> /bin/systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><h2 id=haloæ›´æ”¹è¯„è®ºæ¨¡å—>haloæ›´æ”¹è¯„è®ºæ¨¡å—</h2><p>é¦–å…ˆè¿›å…¥åå°ï¼Œä¾æ¬¡ç‚¹å‡»ï¼š<code>ç³»ç»Ÿ</code>â€”<code>åšå®¢è®¾ç½®</code>â€”<code>è¯„è®ºè®¾ç½®</code>ï¼Œæ›´æ”¹<code>è¯„è®ºæ¨¡å—JS</code>ã€‚ç³»ç»Ÿé»˜è®¤ï¼ˆhalo 1.3.2ï¼‰<code>è¯„è®ºæ¨¡å—JS</code>ä¸ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>//cdn.jsdelivr.net/npm/halo-comment@latest/dist/halo-comment.min.js
</span></span></code></pre></td></tr></table></div></div><p>æ›´æ”¹ä¸º<a class=link href=https://github.com/halo-dev/halo-comment-fly target=_blank rel=noopener>halo-comment-fly</a>è¯„è®ºæ¨¡å—JSï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>https://cdn.jsdelivr.net/gh/hshanx/halo-comment-fly@latest/dist/halo-comment.min.js
</span></span></code></pre></td></tr></table></div></div><p>æˆ–è€…ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>https://cdn.jsdelivr.net/gh/hshanx/halo-comment-hshan@2.0.6/dist/halo-comment.min.js
</span></span></code></pre></td></tr></table></div></div><p>æ›´å¤š<code>è¯„è®ºæ¨¡å—JS</code>ï¼Œå¯ä»¥åœ¨<code>github</code>ä¸­æœç´¢<a class=link href="https://github.com/search?q=halo+comment" target=_blank rel=noopener>halo comment</a>ã€‚</p><h2 id=å®šæ—¶åˆ é™¤haloæ—¥å¿—>å®šæ—¶åˆ é™¤haloæ—¥å¿—</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>0</span> <span class=m>0</span> * * * rm -rf /root/.halo/logs/*
</span></span></code></pre></td></tr></table></div></div><p>æ„æ€æ˜¯æ¯å¤©åˆ é™¤æ—¥å¿—æ–‡ä»¶ã€‚</p><h2 id=æ›´æ”¹æ—¶åŒº>æ›´æ”¹æ—¶åŒº</h2><p>å¦‚æœä½ ä¸çŸ¥é“æœåŠ¡å™¨å½“å‰æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰æ—¶é—´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>date -R
</span></span></code></pre></td></tr></table></div></div><p>ä¿®æ”¹å½“å‰æ—¶åŒºä¸ºä¸Šæµ·ï¼ˆä¸ºäº†é¿å…æ—¥å¿—å‘è¡¨æ—¶é—´å‡ºç°é”™è¯¯ï¼‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo timedatectl set-timezone Asia/Shanghai
</span></span></code></pre></td></tr></table></div></div><p>å†æ¬¡ä¸å¸¦ä»»ä½•é€‰é¡¹å‚æ•°è°ƒç”¨timedatectlå‘½ä»¤ï¼Œæ‰“å°ç³»ç»Ÿå½“å‰è®¾ç½®çš„æ—¶åŒºå³å¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>timedatectl
</span></span></code></pre></td></tr></table></div></div><h2 id=ç‰ˆæœ¬å‡çº§>ç‰ˆæœ¬å‡çº§</h2><blockquote><p>æˆ‘ä»¬å‡è®¾ä½ å­˜æ”¾è¿è¡ŒåŒ…çš„è·¯å¾„ä¸º ~/appï¼Œè¿è¡ŒåŒ…çš„æ–‡ä»¶åä¸º halo.jarï¼Œä¸”ä½¿ç”¨äº† systemd è¿›è¡Œè¿›ç¨‹ç®¡ç†ï¼Œå¦‚æœ‰ä¸åŒï¼Œä¸‹åˆ—å‘½ä»¤è¯·æŒ‰éœ€ä¿®æ”¹ã€‚</p></blockquote><ol><li>åœæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>service halo stop
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>å¤‡ä»½æ•°æ®ä»¥åŠæ—§çš„è¿è¡ŒåŒ…ï¼ˆé‡è¦ï¼‰</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp -r ~/.halo ~/.halo.archive
</span></span><span class=line><span class=cl>mv ~/app/halo.jar ~/app/halo.jar.archive
</span></span></code></pre></td></tr></table></div></div><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ.halo.archive å’Œ halo.jar.archive æ–‡ä»¶åä¸ä¸€å®šè¦æ ¹æ®æ­¤æ–‡æ¡£å‘½åï¼Œè¿™é‡Œä»…ä»…æ˜¯ä¸ªç¤ºä¾‹ã€‚</p></blockquote><ol start=3><li>æ¸…ç©º leveldb ç¼“å­˜ï¼ˆå¦‚æœæœ‰ä½¿ç”¨ leveldb ä½œä¸ºç¼“å­˜ç­–ç•¥ï¼‰</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm -rf ~/.halo/.leveldb
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„è¿è¡ŒåŒ…</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/app <span class=o>&amp;&amp;</span> wget https://dl.halo.run/release/halo-1.5.3.jar -O halo.jar
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>å¯åŠ¨æµ‹è¯•</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -jar halo.jar
</span></span></code></pre></td></tr></table></div></div><p><joe-message type=info content="å¦‚æµ‹è¯•å¯åŠ¨æ­£å¸¸ï¼Œè¯·ç»§ç»­ä¸‹ä¸€æ­¥ã€‚ä½¿ç”¨ CTRL+C åœæ­¢è¿è¡Œæµ‹è¯•è¿›ç¨‹ã€‚"></joe-message></p><ol start=6><li>é‡å¯æœåŠ¡</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>service halo start
</span></span></code></pre></td></tr></table></div></div><h2 id=å¤‡ä»½è¿ç§»>å¤‡ä»½è¿ç§»</h2><p>ç›®å‰ Halo åœ¨åå°çš„å°å·¥å…·ä¸­æä¾›äº†æ•°æ®å¯¼å‡ºçš„åŠŸèƒ½ï¼Œæ­¤åŠŸèƒ½çš„ä½œç”¨ä¸ºå¯¼å‡ºæ•°æ®åº“çš„æ‰€æœ‰æ•°æ®ï¼Œæ ¼å¼ä¸º JSONã€‚é€šå¸¸å¯ä»¥ä½œä¸ºåˆ‡æ¢æ•°æ®åº“ç±»å‹çš„æ—¶å€™ä½¿ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤‡ä»½ä»…ä»…ä¸ºå¤‡ä»½æ•°æ®ï¼Œä¸åŒ…å«å…¶ä»–è¯¸å¦‚ä¸»é¢˜ã€é™„ä»¶ç­‰èµ„æ–™ã€‚å¦‚ä¸‹å›¾ï¼š</p><h3 id=æ•´ç«™å¤‡ä»½>æ•´ç«™å¤‡ä»½</h3><p>é€šè¿‡ ã€Šå†™åœ¨å‰é¢ã€‹ çš„åè¯è§£é‡Šéƒ¨åˆ†æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒHalo çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨å½“å‰ç”¨æˆ·ç›®å½•çš„å·¥ä½œç›®å½•ï¼ˆ.haloï¼‰ä¸‹çš„ï¼ˆä½¿ç”¨ MySQL æ•°æ®åº“é™¤å¤–ï¼Œä½ è¿˜éœ€è¦å¯¼å‡º MySQL æ•°æ®ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å¤‡ä»½æ•´ç«™çš„æ•°æ®ä»…éœ€å¤‡ä»½è¿™ä¸ªç›®å½•å³å¯ï¼Œä¸ç®¡ä½ ä½¿ç”¨ä½•ç§æ–¹å¼ã€‚ä¸è¿‡ï¼Œä¸ºäº†æ“ä½œæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨åå°çš„å°å·¥å…·ä¸­æä¾›äº†å¤‡ä»½æ•´ç«™æ•°æ®çš„åŠŸèƒ½ï¼Œå’Œä¸Šé¢æ‰€è¯´çš„æ•°æ®å¤‡ä»½ä¸€è‡´ï¼Œç‚¹å‡»å¤‡ä»½æŒ‰é’®å³å¯æ‰“åŒ…å·¥ä½œç›®å½•æ–‡ä»¶å¤¹ã€‚å¦‚ä¸‹å›¾ï¼š</p><h3 id=å¯¼å…¥æ•°æ®>å¯¼å…¥æ•°æ®</h3><p>æ­¤åŠŸèƒ½ä¸ºå¯¼å…¥ä¸Šé¢æ‰€è¯´çš„æ•°æ®å¤‡ä»½äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶ï¼ˆJSON æ ¼å¼ï¼‰ï¼Œå¹¶éæ•´ç«™å¤‡ä»½çš„å·¥ä½œç›®å½•æ–‡ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤åŠŸèƒ½ä»…åœ¨ç«™ç‚¹åˆå§‹åŒ–çš„æ—¶å€™æ”¯æŒã€‚å¦‚ä¸‹å›¾ï¼š</p><h3 id=æ•´ç«™è¿ç§»>æ•´ç«™è¿ç§»</h3><p>æ­¤æ“ä½œé€šå¸¸ç”¨äºè¿ç§»æœåŠ¡å™¨ï¼ŒåŸºäºä¸Šé¢ æ•´ç«™å¤‡ä»½ æ‰€è¯´ï¼ŒHalo çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯å­˜æ”¾äºå½“å‰ç”¨æˆ·ç›®å½•çš„å·¥ä½œç›®å½•ï¼ˆ.haloï¼‰ä¸‹çš„ã€‚å½“ç„¶ï¼Œè¿™ä»…é™äºä½¿ç”¨ H2 Database çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ ä½¿ç”¨çš„ MySQLï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ‰‹åŠ¨å¯¼å‡º MySQL æ•°æ®ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿ç§»æœåŠ¡å™¨ä»…ä»…éœ€è¦éœ€è¦å°†å·¥ä½œç›®å½•çš„å¤‡ä»½æ–‡ä»¶ä¸Šä¼ åˆ°æ–°æœåŠ¡å™¨çš„ç”¨æˆ·ç›®å½•ä¸‹è§£å‹ï¼Œç„¶åæŒ‰ç…§ ã€Šå®‰è£…æŒ‡å—ã€‹ é‡æ–°å®‰è£…å³å¯ã€‚MySQL ç”¨æˆ·è¿˜éœ€è¦åšçš„å°±æ˜¯æ‰‹åŠ¨å¯¼å‡º MySQL æ•°æ®ï¼Œå¹¶åœ¨æ–°æœåŠ¡å™¨ä¸Šå¯¼å…¥ã€‚</p><h2 id=å¸¸è§é—®é¢˜>å¸¸è§é—®é¢˜</h2><p>1.å¿˜è®°äº†ç®¡ç†å‘˜å¯†ç ï¼Œå¦‚ä½•é‡ç½®ï¼Ÿ</p><p>ç›®å‰åœ¨ç™»å½•é¡µé¢å«æœ‰éšè—çš„ æ‰¾å›å¯†ç  é“¾æ¥ï¼Œç‚¹å‡»å³å¯è¿›å…¥æ‰¾å›å¯†ç é¡µé¢ï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>åœ¨ç™»å½•é¡µé¢æŒ‰ä¸‹é”®ç›˜å¿«æ·é”®ï¼ˆWindows / Linuxï¼šShift + Alt + Hï¼ŒmacOSï¼šShift + Command + Hï¼‰å³å¯æ˜¾ç¤º æ‰¾å›å¯†ç  é“¾æ¥ã€‚</li><li>æŒ‰ç…§è¡¨å•æç¤ºè¾“å…¥ç”¨æˆ·åå’Œé‚®ç®±ï¼Œç‚¹å‡» è·å– æŒ‰é’®å³å¯å‘é€å¸¦æœ‰éªŒè¯ç çš„é‚®ä»¶ã€‚</li><li>æŒ‰ç…§è¡¨å•å¡«å†™éªŒè¯ç å’Œæ–°å¯†ç ï¼Œç‚¹å‡»é‡ç½®å¯†ç å³å¯ã€‚</li></ol><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ 2 æ­¥ä¸­çš„è·å–éªŒè¯ç éœ€è¦äº‹å…ˆé…ç½®äº† SMTP å‘ä¿¡è®¾ç½®ï¼Œå¦åˆ™æ— æ³•å‘é€éªŒè¯ç ã€‚ä½†ä½ å¯ä»¥ç™»å½•æœåŠ¡å™¨æŸ¥çœ‹ Halo è¿è¡Œæ—¥å¿—ï¼Œæœç´¢ Got reset password code å…³é”®å­—å³å¯è·å–åˆ°éªŒè¯ç ã€‚</p></blockquote><h2 id=é™„ä¿®æ”¹-nginx-é…ç½®æ–‡ä»¶>é™„ï¼šä¿®æ”¹ Nginx é…ç½®æ–‡ä»¶</h2><ol><li>ä½¿ç”¨ä½ ç†Ÿæ‚‰çš„å·¥å…·æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œæ­¤æ•™ç¨‹ä½¿ç”¨ viã€‚</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/nginx/conf.d/halo.conf
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>æ·»åŠ  upstream é…ç½®
åœ¨ <code>server</code> çš„åŒçº§èŠ‚ç‚¹æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upstream halo <span class=o>{</span>
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>åœ¨ server èŠ‚ç‚¹æ·»åŠ å¦‚ä¸‹é…ç½®</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location / <span class=o>{</span>
</span></span><span class=line><span class=cl>  proxy_set_header HOST <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>ä¿®æ”¹ location ~ .*.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ èŠ‚ç‚¹</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ .*<span class=se>\.</span><span class=o>(</span>gif<span class=p>|</span>jpg<span class=p>|</span>jpeg<span class=p>|</span>png<span class=p>|</span>bmp<span class=p>|</span>swf<span class=p>|</span>flv<span class=p>|</span>mp4<span class=p>|</span>ico<span class=o>)</span>$ <span class=o>{</span>
</span></span><span class=line><span class=cl>  proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>  expires 30d<span class=p>;</span>
</span></span><span class=line><span class=cl>  access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>ä¿®æ”¹ location ~ .*.(js|css)?$ èŠ‚ç‚¹</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ .*<span class=se>\.</span><span class=o>(</span>js<span class=p>|</span>css<span class=o>)</span>?$ <span class=o>{</span>
</span></span><span class=line><span class=cl>  proxy_pass http://halo<span class=p>;</span>
</span></span><span class=line><span class=cl>  expires 7d<span class=p>;</span>
</span></span><span class=line><span class=cl>  access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœä¸æŒ‰ç…§ç¬¬ 4ï¼Œ5 æ­¥æ“ä½œï¼Œè¯·æ±‚ä¸€äº›å›¾ç‰‡æˆ–è€…æ ·å¼æ–‡ä»¶ä¸ä¼šç»è¿‡ Haloï¼Œæ‰€ä»¥è¯·ä¸è¦å¿½ç•¥æ­¤é…ç½®ã€‚</p><p><del>6. æ·»åŠ  acme.sh ç»­ç­¾éªŒè¯è·¯ç”±</del></p><p><del>OneinStack ä½¿ç”¨çš„ acme.sh ç®¡ç†è¯ä¹¦ï¼Œå¦‚æœä½ åœ¨åˆ›å»º vhost çš„æ—¶å€™é€‰æ‹©äº†ä½¿ç”¨ Let&rsquo;s Encrypt ç”³è¯·è¯ä¹¦ï¼Œé‚£ä¹ˆ OneinStack ä¼šåœ¨ç³»ç»Ÿå†…æ·»åŠ ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å»è‡ªåŠ¨ç»­ç­¾è¯ä¹¦ï¼Œacme.sh é»˜è®¤éªŒè¯ç«™ç‚¹æ‰€æœ‰æƒçš„æ–¹å¼ä¸ºåœ¨ç«™ç‚¹æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼ˆ.well-knownï¼‰æ¥åšéªŒè¯ï¼Œç”±äºé…ç½®äº†åå‘ä»£ç†ï¼Œæ‰€ä»¥åœ¨éªŒè¯çš„æ—¶å€™æ˜¯æ— æ³•ç›´æ¥è®¿é—®åˆ°ç«™ç‚¹ç›®å½•ä¸‹çš„ .well-known æ–‡ä»¶å¤¹ä¸‹çš„éªŒè¯æ–‡ä»¶çš„ã€‚éœ€è¦æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</del></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ^~ /.well-known/acme-challenge/ <span class=o>{</span>
</span></span><span class=line><span class=cl>  default_type <span class=s2>&#34;text/plain&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>  root /data/wwwroot/demo.halo.run/<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœä¸Šè¿°ä»£ç å¤±æ•ˆï¼Œå¯ä»¥è¯•ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location ~ /.well-known <span class=o>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â allow all<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è‡³æ­¤ï¼Œé…ç½®ä¿®æ”¹å®Œæ¯•ï¼Œä¿å­˜å³å¯ã€‚æœ€ç»ˆä½ çš„é…ç½®æ–‡ä»¶å¯èƒ½å¦‚ä¸‹é¢é…ç½®ä¸€æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>upstream halo {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>server 127.0.0.1:8090;</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=l>server {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen 80;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen [::]:80;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen 443 ssl http2;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>listen [::]:443 ssl http2;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_certificate /usr/local/nginx/conf/ssl/demo.halo.run.crt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_certificate_key /usr/local/nginx/conf/ssl/demo.halo.run.key;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_prefer_server_ciphers on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_session_timeout 10m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_session_cache builtin:1000 shared:SSL:10m;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_buffer_size 1400;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>add_header Strict-Transport-Security max-age=15768000;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_stapling on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>ssl_stapling_verify on;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>server_name demo.halo.run;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>access_log /data/wwwlogs/demo.halo.run_nginx.log combined;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>index index.html index.htm index.php;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>root /data/wwwroot/demo.halo.run;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>if ($ssl_protocol = &#34;&#34;) { return 301 https://$host$request_uri; }</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>include /usr/local/nginx/conf/rewrite/none.conf;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#error_page 404 /404.html;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#error_page 502 /502.html;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>expires 30d;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>access_log off;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ .*\.(js|css)?$ {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>expires 7d;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>access_log off;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ~ /(\.user\.ini|\.ht|\.git|\.svn|\.project|LICENSE|README\.md) {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>deny all;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location / {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header HOST $host;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Forwarded-Proto $scheme;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Real-IP $remote_addr;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>proxy_pass http://halo;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>location ^~ /.well-known/acme-challenge/ {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>default_type &#34;text/plain&#34;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>allow all;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>root /data/wwwroot/demo.halo.run/;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=https-wwwè·³è½¬>https wwwè·³è½¬</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>upstream halo {
</span></span><span class=line><span class=cl>  server 127.0.0.1:8090;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>server {
</span></span><span class=line><span class=cl>  listen 80;
</span></span><span class=line><span class=cl>  listen [::]:80;
</span></span><span class=line><span class=cl>  listen 443 ssl http2;
</span></span><span class=line><span class=cl>  listen [::]:443 ssl http2;
</span></span><span class=line><span class=cl>  server_name bore.vip www.bore.vip;
</span></span><span class=line><span class=cl><span class=gi>+  if ($host != &#39;bore.vip&#39; ) {
</span></span></span><span class=line><span class=cl><span class=gi>+      rewrite ^/(.*)$ https://bore.vip/$1 permanent;
</span></span></span><span class=line><span class=cl><span class=gi>+  }
</span></span></span></code></pre></td></tr></table></div></div><h2 id=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥</h2><ul><li><a class=link href=https://docs.halo.run/getting-started/install/linux target=_blank rel=noopener>1.åœ¨ Linux æœåŠ¡å™¨éƒ¨ç½² Halo</a></li><li><a class=link href=https://halo.run/archives/install-reverse-proxy.html target=_blank rel=noopener>2.é…ç½®åŸŸåè®¿é—®</a></li><li><a class=link href=https://juejin.im/entry/5b59c3f26fb9a04fda4e2238 target=_blank rel=noopener>3.CentOS 7 Nginxé…ç½®Let&rsquo;s Encrypt SSLè¯ä¹¦</a></li><li><a class=link href=https://www.jianshu.com/p/9fc41ea941aa target=_blank rel=noopener>4.windows 10 é…ç½®Java ç¯å¢ƒå˜é‡</a></li><li><a class=link href=https://www.myfreax.com/how-to-set-or-change-timezone-on-centos-8/ target=_blank rel=noopener>5.å¦‚ä½•è®¾ç½®æˆ–æ›´æ”¹ç³»ç»Ÿæ—¶åŒºåœ¨CentOS 8</a></li></ul></div><div class="shuoshuo-tags meta-wrapper" style=margin-top:15px!important;margin-bottom:5px!important;gap:10px!important><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px;color:var(--card-text-color-secondary)"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
<a href=/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/ class="meta-item shuoshuo-tag" title="æŸ¥çœ‹æ ‡ç­¾: æœåŠ¡å™¨"><span>#æœåŠ¡å™¨</span>
</a><a href=/tags/halo/ class="meta-item shuoshuo-tag" title="æŸ¥çœ‹æ ‡ç­¾: halo"><span>#halo</span></a></div><div class=shuoshuo-footer-info><div class="shuoshuo-edit-link meta-wrapper" style=gap:15px!important><a href=https://github.com/iwyang/iwyang.github.io/edit/develop/content/post/%e5%9c%a8Centos%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%83%a8%e7%bd%b2Halo/index.md target=_blank rel="noopener noreferrer" class=meta-item title="å‰å¾€ GitHub ç¼–è¾‘æ­¤é¡µ"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
<span>ç¼–è¾‘æ­¤é¡µ</span>
</a><span class=separator>|</span>
<a class="meta-item git-hash-text" href=https://github.com/iwyang/iwyang.github.io/commit/26a215ebb8fca78d98f384856b8ab5e0e2056333 target=_blank rel="noopener noreferrer" title="Commit Hash: 26a215e">#26a215e</a></div></div></article></div><div class=waterfall-column id=waterfall-right></div></div><div class=shuoshuo-pagination></div><footer class=site-footer><style>.site-footer .running-time,.site-footer .powerby{font-size:14px!important;line-height:1.6!important;margin:10px 0!important;display:block!important;font-weight:400!important}.site-footer .running-time,.site-footer .running-time *,[data-scheme=dark] .site-footer .running-time,[data-scheme=dark] .site-footer .running-time *{color:#1e90ff!important}.site-footer .powerby,.site-footer .powerby *{color:var(--sys-color-text-muted)!important}[data-scheme=dark] .site-footer .powerby,[data-scheme=dark] .site-footer .powerby *{color:rgba(255,255,255,.7)!important}.footer-separator{margin:0 6px!important;font-size:14px!important}.site-footer .running-time .footer-separator{color:#1e90ff!important;opacity:1!important}.site-footer .powerby .footer-separator{color:inherit!important}.site-footer a{text-decoration:none!important;cursor:pointer}.site-footer a:hover{text-decoration:underline!important}.site-footer .powerby a:hover{color:var(--accent-color)!important}</style><section class=copyright>&copy;
2020 -
2026 Bore's Notes</section><section class=running-time>æœ€è¿‘æ›´æ–°ï¼š<span id=site-last-update data-time=2026-02-21T04:21:27Z title="2026-02-21 04:21">--</span><span class=footer-separator>|</span>
<a href=https://github.com/iwyang/iwyang.github.io/commit/e4c2c10eae419f7074d0f651e0d1ad8745adcf5c target=_blank rel=noopener title="Commit Hash: e4c2c10">#e4c2c10</a></section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º
<span class=footer-separator>|</span>
ä¸»é¢˜ <a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=4.0.0>Stack</a> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><script>(function(){var e,t,n,o,i,a,r,c,l,d,s=document.getElementById("site-last-update");s&&(n=new Date(s.getAttribute("data-time")),o=new Date,e=(o-n)/1e3,i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),c=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),d=i+"-"+a+"-"+r+" "+c+":"+l,s.setAttribute("title",d),t="",e<60?t="åˆšåˆš":e<3600?t=Math.floor(e/60)+" åˆ†é’Ÿå‰":e<86400?t=Math.floor(e/3600)+" å°æ—¶å‰":e<2592e3?t=Math.floor(e/86400)+" å¤©å‰":e<31536e3?t=Math.floor(e/2592e3)+" ä¸ªæœˆå‰":t=Math.floor(e/31536e3)+" å¹´å‰",s.innerText=t)})()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css><script src=https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js></script><script>document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("masonry-container"),t=document.getElementById("waterfall-left"),i=document.getElementById("waterfall-right"),a=Array.from(t.querySelectorAll(".shuoshuo-card"));function n(){if(window.innerWidth<=768){a.forEach(e=>t.appendChild(e)),o.style.opacity=1;return}t.innerHTML="",i.innerHTML="",a.forEach(e=>{t.offsetHeight<=i.offsetHeight?t.appendChild(e):i.appendChild(e)}),o.style.opacity=1}n(),window.addEventListener("resize",n);const s=o.querySelectorAll("img");let e=0;s.length>0?s.forEach(t=>{t.complete?(e++,e===s.length&&n()):(t.addEventListener("load",()=>{e++,e===s.length&&n()}),t.addEventListener("error",()=>{e++,e===s.length&&n()}))}):o.style.opacity=1;const r=document.querySelectorAll(".shuoshuo-content img");r.forEach(e=>{const t=e.parentElement;if(t.tagName==="A")t.hasAttribute("data-fancybox")||(t.setAttribute("data-fancybox","gallery"),t.setAttribute("data-caption",e.alt||e.title||"è¯´è¯´å›¾ç‰‡"),t.classList.add("shuoshuo-image"),t.style.display="block");else{const t=document.createElement("a");t.href=e.src,t.setAttribute("data-fancybox","gallery"),t.setAttribute("data-caption",e.alt||e.title||"è¯´è¯´å›¾ç‰‡"),t.classList.add("shuoshuo-image"),t.style.display="block",e.parentNode.insertBefore(t,e),t.appendChild(e)}}),typeof Fancybox!="undefined"&&Fancybox.bind('[data-fancybox="gallery"]',{Hash:!1,Thumbs:{autoStart:!1},Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW"],right:["slideshow","download","close"]}}});const c=new Date,l=document.querySelectorAll(".shuoshuo-time, .shuoshuo-updated-time");l.forEach(e=>d(e,c));function d(e,t){const n=e.getAttribute("datetime");if(!n)return;const s=new Date(n),o=(t-s)/1e3,i=e.querySelector("span")||e,a=u(s);if(!e.hasAttribute("title")){const t=e.classList.contains("shuoshuo-updated-time")?"æ›´æ–°äº ":"å‘å¸ƒäº ";e.setAttribute("title",t+a)}i.innerText=h(o)}function u(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return t+"-"+n+"-"+s+" "+o+":"+i}function h(e){return e<60?"åˆšåˆš":e<3600?Math.floor(e/60)+" åˆ†é’Ÿå‰":e<86400?Math.floor(e/3600)+" å°æ—¶å‰":e<2592e3?Math.floor(e/86400)+" å¤©å‰":e<31536e3?Math.floor(e/2592e3)+" ä¸ªæœˆå‰":Math.floor(e/31536e3)+" å¹´å‰"}})</script></main></main></div><script type=text/javascript src=/ts/main.acaf849f2b273f6a8368a58b001f336738d0c948d92e79b116467d0c7515f932.js defer></script></body></html>