<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>利用企业微信实现twikoo新消息提醒&amp;&amp;数据导出等 | Bore's Notes</title><meta name="author" content="Bore"><meta name="copyright" content="Bore"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="注册企业微信1．搜索下载企业，并使用手机号进行企业微信注册 2．选择成立企业 3．输入企业名称等信息 4．完成后，在通讯录内添加成员 企业微信创建一个应用在 “企业微信 —— 应用管理” 最底部的 “自建” 应用处，新建一个 “应用”。名称比如就叫消息通知，配置完成后记录下应用页面的 AgentId 和 Secret。注意，查看 Secret 需要安装一个企业微信，查看完可以卸载。 在 “企业微信">
<meta property="og:type" content="article">
<meta property="og:title" content="利用企业微信实现twikoo新消息提醒&amp;&amp;数据导出等">
<meta property="og:url" content="https://bore.vip/archives/9a366c6/index.html">
<meta property="og:site_name" content="Bore&#39;s Notes">
<meta property="og:description" content="注册企业微信1．搜索下载企业，并使用手机号进行企业微信注册 2．选择成立企业 3．输入企业名称等信息 4．完成后，在通讯录内添加成员 企业微信创建一个应用在 “企业微信 —— 应用管理” 最底部的 “自建” 应用处，新建一个 “应用”。名称比如就叫消息通知，配置完成后记录下应用页面的 AgentId 和 Secret。注意，查看 Secret 需要安装一个企业微信，查看完可以卸载。 在 “企业微信">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bore.vip/img/avatar.jpg">
<meta property="article:published_time" content="2022-02-06T01:27:38.000Z">
<meta property="article:modified_time" content="2025-08-31T05:21:52.072Z">
<meta property="article:author" content="Bore">
<meta property="article:tag" content="hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bore.vip/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://bore.vip/archives/9a366c6/index.html"><link rel="preconnect"/><meta name="google-site-verification" content="qEczu2lhPn2fSX-0ejGU0PZ7R60n_mDcTi-aQmUlrfA"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.33" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过了","messageNext":"天，文章所描述的內容可能已经发生变化，请留意。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '利用企业微信实现twikoo新消息提醒&&数据导出等',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-31 13:21:52'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Bore's Notes" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-hot"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/say/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-user-friends"></i><span> 友圈</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Bore's Notes"><span class="site-name">Bore's Notes</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-hot"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/say/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-user-friends"></i><span> 友圈</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">利用企业微信实现twikoo新消息提醒&amp;&amp;数据导出等</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-06T01:27:38.000Z" title="发表于 2022-02-06 09:27:38">2022-02-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-31T05:21:52.072Z" title="更新于 2025-08-31 13:21:52">2025-08-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span></div></div></div><article class="post-content" id="article-container"><h2 id="注册企业微信"><a href="#注册企业微信" class="headerlink" title="注册企业微信"></a>注册企业微信</h2><p>1．搜索下载企业，并使用手机号进行企业微信注册</p>
<p>2．选择成立企业</p>
<p>3．输入企业名称等信息</p>
<p>4．完成后，在通讯录内添加成员</p>
<h2 id="企业微信创建一个应用"><a href="#企业微信创建一个应用" class="headerlink" title="企业微信创建一个应用"></a>企业微信创建一个应用</h2><p>在 “企业微信 —— 应用管理” 最底部的 “自建” 应用处，新建一个 “应用”。名称比如就叫消息通知，配置完成后记录下应用页面的 AgentId 和 Secret。注意，查看 Secret 需要安装一个企业微信，查看完可以卸载。</p>
<p>在 “企业微信 —— 我的企业” 底部，记录下 “企业 ID”。</p>
<p>至此，微信配置完成，开始配置提醒 API。</p>
<h2 id="创建-API-云函数"><a href="#创建-API-云函数" class="headerlink" title="创建 API 云函数"></a>创建 API 云函数</h2><p>首先参考 Heo 的教程，创建一个腾讯云或 vercel 版本的云函数。</p>
<h3 id="Vercel版本"><a href="#Vercel版本" class="headerlink" title="Vercel版本"></a>Vercel版本</h3><p>我之前使用vercel部署过twikoo，因此不需要再创建新的云函数。如果你不是使用vercel，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.zhheo.com/p/1e9f35bc.html#%E4%BD%BF%E7%94%A8vercel%E5%BC%80%E5%8F%91%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89">参考这里</a>。</p>
<h4 id="安装python"><a href="#安装python" class="headerlink" title="安装python"></a>安装python</h4><p>下载并安装python，安装时注意勾选<code>Add Python 3.10 to PATH</code></p>
<h4 id="安装pipenv"><a href="#安装pipenv" class="headerlink" title="安装pipenv"></a>安装pipenv</h4><p>找到你的twikoo github仓库，clone到本地，进入<code>api/</code>，执行以下命令：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pipenv</span><br></pre></td></tr></table></figure>

<p>如果安装时报错：<code>ERROR: Exception: Traceback (most recent call last)</code>，就使用一下命令安装：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pipenv <span class="literal">-i</span> http://pypi.douban.com/simple <span class="literal">--trusted-host</span> pypi.douban.com</span><br></pre></td></tr></table></figure>

<h4 id="下载requests"><a href="#下载requests" class="headerlink" title="下载requests"></a>下载requests</h4><p>继续在<code>api/</code>文件夹下执行以下命令：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install requests</span><br></pre></td></tr></table></figure>

<p>如果按照报错，请先关闭dl。</p>
<h4 id="新建python-py"><a href="#新建python-py" class="headerlink" title="新建python.py"></a>新建python.py</h4><p>然后在该目录创建一个<code>python.py</code>文件，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> BaseHTTPRequestHandler</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> parse_qs</span><br><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">handler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">getTocken</span>(<span class="params"><span class="built_in">id</span>, secert, msg, agentId</span>):</span><br><span class="line">            url = <span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&quot;</span> + \</span><br><span class="line">                <span class="built_in">id</span> + <span class="string">&quot;&amp;corpsecret=&quot;</span> + secert</span><br><span class="line"></span><br><span class="line">            r = requests.get(url)</span><br><span class="line">            tocken_json = json.loads(r.text)</span><br><span class="line">            <span class="comment"># print(tocken_json[&#x27;access_token&#x27;])</span></span><br><span class="line">            sendText(tocken=tocken_json[<span class="string">&#x27;access_token&#x27;</span>], agentId=agentId, msg=msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">sendText</span>(<span class="params">tocken, agentId, msg</span>):</span><br><span class="line">            sendUrl = <span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&quot;</span> + tocken</span><br><span class="line">            <span class="comment"># print(sendUrl)</span></span><br><span class="line">            data = json.dumps(&#123;</span><br><span class="line">                <span class="string">&quot;safe&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="string">&quot;touser&quot;</span>: <span class="string">&quot;@all&quot;</span>,</span><br><span class="line">                <span class="string">&quot;msgtype&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                <span class="string">&quot;agentid&quot;</span>: agentId,</span><br><span class="line">                <span class="string">&quot;text&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;content&quot;</span>: <span class="built_in">str</span>(msg)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            requests.post(sendUrl, data)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            params = parse_qs(self.path[<span class="number">12</span>:])</span><br><span class="line">            apiid = params[<span class="string">&#x27;id&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">            apisecert = params[<span class="string">&#x27;secert&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">            apiagentId = params[<span class="string">&#x27;agentId&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">            apimsg = params[<span class="string">&#x27;msg&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            apimsg = self.path</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment">#try:</span></span><br><span class="line">            <span class="comment"># 执行主程序</span></span><br><span class="line">            getTocken(<span class="built_in">id</span>=apiid, secert=apisecert,</span><br><span class="line">                        msg=apimsg, agentId=apiagentId)</span><br><span class="line">            <span class="comment">#except:</span></span><br><span class="line">            <span class="comment">#    status = 1</span></span><br><span class="line">            <span class="comment">#    apimsg = &#x27;主程序运行时出现错误，请检查参数是否填写正确。详情可以参阅：https://blog.zhheo.com/p/1e9f35bc.html&#x27;</span></span><br><span class="line">            <span class="comment">#else:</span></span><br><span class="line">            <span class="comment">#    status = 0</span></span><br><span class="line">        <span class="comment"># print(event)</span></span><br><span class="line">        <span class="comment"># print(&quot;Received event: &quot; + json.dumps(event, indent = 2))</span></span><br><span class="line">        <span class="comment"># print(&quot;Received context: &quot; + str(context))</span></span><br><span class="line">        <span class="comment"># print(&quot;Hello world&quot;)</span></span><br><span class="line"></span><br><span class="line">        self.send_response(<span class="number">200</span>)</span><br><span class="line">        self.send_header(<span class="string">&#x27;Content-type&#x27;</span>, <span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        self.wfile.write(apimsg)</span><br><span class="line">        <span class="keyword">return</span></span><br></pre></td></tr></table></figure>

<p>push当前的更改之后，当Vercel完成部署后，你可以使用下面这样的方式，拼接一个 URL，浏览器访问，看看手机微信能不能接收到消息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&lt; vercel_app_address&gt;/api/python?id=&lt;ww....&gt;&amp;secert=&lt;secret...&gt;&amp;agentId=&lt;agentId...&gt;&amp;msg=测试一下吧</span><br></pre></td></tr></table></figure>

<p>如果成功的话你的手机会接收到对应的推送（如果你的企业微信注册成功且所填信息正确）。</p>
<h4 id="在twikoo中配置"><a href="#在twikoo中配置" class="headerlink" title="在twikoo中配置"></a>在twikoo中配置</h4><p><del>在twikoo后台管理<code>WECOM_API_URL</code>中添加你拼接的url即可。注意<code>msg</code>后面不要有参数：</del></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;vercel_app_address&gt;/api/python?id=&lt;企业id&gt;&amp;secert=&lt;secret&gt;&amp;agentId=&lt;agentId&gt;&amp;msg=</span><br></pre></td></tr></table></figure>

<hr>
<p>2022.3.6 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://twikoo.js.org/">Twikoo</a> v1.5.0更新： 消息推送逻辑，从 1.5.0 之前的版本升级后，请在管理面板重新配置评论提醒的消息推送服务，增加了对 Bark、Telegram 等平台的支持</p>
<h5 id="企业微信-缩写-wecom"><a href="#企业微信-缩写-wecom" class="headerlink" title="企业微信 缩写: wecom"></a><a target="_blank" rel="noopener external nofollow noreferrer" href="https://guole.fun/posts/626/">企业微信</a> 缩写: <code>wecom</code></h5><p>企业微信应用消息推送，免费，限制较少。</p>
<ol>
<li>用电脑打开 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://work.weixin.qq.com/%EF%BC%8C%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E4%BC%81%E4%B8%9A">https://work.weixin.qq.com/，注册一个企业</a></li>
<li>注册成功后，点「管理企业」进入管理界面，选择「应用管理」 → 「自建」 → 「创建应用」</li>
<li>应用名称填入机器人的名称，应用 logo 选择机器人的头像，可见范围选择公司名</li>
<li>创建完成后进入应用详情页，可以得到应用ID( <code>agentid</code> )，应用Secret( <code>secret</code> )，复制<br>PS：获取应用Secret时，可能会将其推送到企业微信客户端，这时候微信里边是看不到的，需要在企业微信客户端里边才能看到</li>
<li>进入「<a target="_blank" rel="noopener external nofollow noreferrer" href="https://work.weixin.qq.com/wework_admin/frame#profile">我的企业</a>」页面，拉到最下边，可以看到企业ID，复制</li>
<li>进入「我的企业」 → 「<a target="_blank" rel="noopener external nofollow noreferrer" href="https://work.weixin.qq.com/wework_admin/frame#profile/wxPlugin">微信插件</a>」，拉到下边扫描二维码，关注以后即可收到推送的消息</li>
<li>将第 4 步和第 5 步取得的 <code>企业ID#应用Secret#应用ID</code> 拼到一起，中间用 “<code>#</code>” 号分隔，填入 pushoo 的 token 中</li>
</ol>
<p>示例 token：<code>ww97a01a*****1e5f1#xHapDXmgZtlBgRQQXMb4kfh3y75Ynoubl*****l9ytE#1000005</code></p>
<p>PS：如果出现接口请求正常，企业微信接受消息正常，个人微信无法收到消息的情况，请确认如下配置：</p>
<ul>
<li>进入「我的企业」 → 「微信插件」，拉到最下方，勾选「允许成员在微信插件中接收和回复聊天消息 」</li>
<li>在企业微信客户端 「我」 → 「设置」 → 「新消息通知」中关闭「仅在企业微信中接受消息」限制条件</li>
</ul>
<h4 id="在微信中接收企业微信消息"><a href="#在微信中接收企业微信消息" class="headerlink" title="在微信中接收企业微信消息"></a>在微信中接收企业微信消息</h4><p>在“企业微信——我的企业——微信插件”页面配置，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://work.weixin.qq.com/wework_admin/frame#profile/wxPlugin">点击这里查看</a>。</p>
<p>使用微信扫码，关注你的企业微信，并且在设置中打开<code>允许成员在微信插件中接收和回复聊天消息</code>选项。</p>
<h3 id="腾讯云版本"><a href="#腾讯云版本" class="headerlink" title="腾讯云版本"></a>腾讯云版本</h3><p>可以复用之前 Twikoo 那个云开发环境，直接创建一个新的云函数，名称自定义如 weixin-push，选择 helloworld 空白模板函数，Python3.6 环境， 128MB 就 OK 了。下一步粘贴下面的代码，点击创建：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getTocken</span>(<span class="params"><span class="built_in">id</span>,secert,msg,agentId</span>):</span><br><span class="line">    url = <span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&quot;</span> + <span class="built_in">id</span> + <span class="string">&quot;&amp;corpsecret=&quot;</span> + secert</span><br><span class="line"></span><br><span class="line">    r =requests.get(url)</span><br><span class="line">    tocken_json = json.loads(r.text)</span><br><span class="line">    <span class="comment"># print(tocken_json[&#x27;access_token&#x27;])</span></span><br><span class="line">    sendText(tocken=tocken_json[<span class="string">&#x27;access_token&#x27;</span>],agentId=agentId,msg=msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendText</span>(<span class="params">tocken,agentId,msg</span>):</span><br><span class="line">    sendUrl = <span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&quot;</span> + tocken</span><br><span class="line">    <span class="comment"># print(sendUrl)</span></span><br><span class="line">    data = json.dumps(&#123;</span><br><span class="line">        <span class="string">&quot;safe&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;touser&quot;</span> : <span class="string">&quot;@all&quot;</span>,</span><br><span class="line">        <span class="string">&quot;msgtype&quot;</span> : <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="string">&quot;agentid&quot;</span> : agentId,</span><br><span class="line">        <span class="string">&quot;text&quot;</span> : &#123;</span><br><span class="line">            <span class="string">&quot;content&quot;</span> : msg</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    requests.post(sendUrl,data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">event, context</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        apiid=event[<span class="string">&#x27;queryStringParameters&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        apisecert=event[<span class="string">&#x27;queryStringParameters&#x27;</span>][<span class="string">&#x27;secert&#x27;</span>]</span><br><span class="line">        apiagentId = event[<span class="string">&#x27;queryStringParameters&#x27;</span>][<span class="string">&#x27;agentId&#x27;</span>]</span><br><span class="line">        apimsg = event[<span class="string">&#x27;queryStringParameters&#x27;</span>][<span class="string">&#x27;msg&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        apimsg = <span class="string">&#x27;有必填参数没有填写，请检查是否填写正确和格式是否错误。详情可以参阅：https://blog.zhheo.com/p/1e9f35bc.html&#x27;</span></span><br><span class="line">        status = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 执行主程序</span></span><br><span class="line">            getTocken(<span class="built_in">id</span>=apiid,secert=apisecert,msg=apimsg,agentId=apiagentId)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            status = <span class="number">1</span></span><br><span class="line">            apimsg = <span class="string">&#x27;主程序运行时出现错误，请检查参数是否填写正确。详情可以参阅：https://blog.zhheo.com/p/1e9f35bc.html&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = <span class="number">0</span></span><br><span class="line">    <span class="comment"># print(event)</span></span><br><span class="line">    <span class="comment"># print(&quot;Received event: &quot; + json.dumps(event, indent = 2)) </span></span><br><span class="line">    <span class="comment"># print(&quot;Received context: &quot; + str(context))</span></span><br><span class="line">    <span class="comment"># print(&quot;Hello world&quot;)</span></span><br><span class="line">    status_str = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;status&quot;</span>:status,</span><br><span class="line">            <span class="string">&quot;msg&quot;</span>:apimsg</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">return</span>(status_str)</span><br></pre></td></tr></table></figure>

<p>配置好访问服务（如果第一次创建，参考 Twikoo 教程还需要配置安全域名等）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">域名：*</span><br><span class="line">触发路径：/weixin-push           (自定义)</span><br><span class="line">关联资源：云函数   weixin-push    (上文创建的云函数)</span><br></pre></td></tr></table></figure>

<p><img src="/../img/%E5%88%A9%E7%94%A8%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E5%AE%9E%E7%8E%B0twikoo%E6%96%B0%E6%B6%88%E6%81%AF%E6%8F%90%E9%86%92/202202061010000.jpg"></p>
<p>至此，云函数创建完成。可以使用下面这样的方式，拼接一个 URL，浏览器访问，看看手机微信能不能接收到消息。</p>
<p>云函数的访问服务 URL + 触发路径 + ?id &#x3D; 你的企业微信 ID + secert &#x3D; 上文记录的 secert + Id &#x3D; 上文记录的 AgentId + &amp;msg &#x3D; 随便测试一下吧</p>
<p>如我下面这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blogpkly-13278c-1258453354.ap-shanghai.app.tcloudbase.com/weixin-push?id=ww*******&amp;secert=Ne******&amp;agentId=1000003&amp;msg=随便测试一下吧</span><br></pre></td></tr></table></figure>

<p>浏览器返回以下内容，说明配置完成 (msg 后的内容，是 Unicode 编码后的 “随便测试一下吧” 内容，点击这里可以转换 )。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\u968f\u4fbf\u6d4b\u8bd5\u4e00\u4e0b\u5427&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Twikoo-配置"><a href="#Twikoo-配置" class="headerlink" title="Twikoo 配置"></a>Twikoo 配置</h4><p>在 Twikoo v1.4.5 及以上版本中，打开控制面板，在上述企业微信 API 搭建完成后，拼接成下述样式的 URL，填写在即时通知 ——WECOM_API_URL 中即可完成配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blogpkly-13278c-1258453354.ap-shanghai.app.tcloudbase.com/weixin-push?id=企业微信获取&amp;secert=企业微信获取&amp;agentId=企业微信获取&amp;msg=</span><br></pre></td></tr></table></figure>

<p>微信关注自己的企业微信账号，然后用其他非博主邮箱在网站留言，试试即时通知吧！</p>
<h2 id="更换-CDN-镜像"><a href="#更换-CDN-镜像" class="headerlink" title="更换 CDN 镜像"></a>更换 CDN 镜像</h2><blockquote>
<p>如果遇到默认 CDN 加载速度缓慢，可更换其他 CDN 镜像。以下为可供选择的公共 CDN，其中一些 CDN 可能需要数天时间同步最新版本：</p>
<ul>
<li><code>https://cdn.staticfile.org/twikoo/1.6.4/twikoo.all.min.js</code></li>
<li><code>https://lib.baomitu.com/twikoo/1.6.4/twikoo.all.min.js</code></li>
<li><code>https://cdn.bootcdn.net/ajax/libs/twikoo/1.6.4/twikoo.all.min.js</code></li>
<li><code>https://cdn.jsdelivr.net/npm/twikoo@1.6.4/dist/twikoo.all.min.js</code></li>
</ul>
</blockquote>
<p>例如<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly主题 </a>：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  custom_format:</span><br><span class="line">  </span><br><span class="line">  option:</span><br><span class="line">    # main_css:</span><br><span class="line">    # main:</span><br><span class="line">    # utils:</span><br><span class="line">    # translate:</span><br><span class="line">    # local_search:</span><br><span class="line">    # algolia_js:</span><br><span class="line">    # algolia_search_v4:</span><br><span class="line">    # instantsearch_v4:</span><br><span class="line">    # pjax:</span><br><span class="line">    # gitalk:</span><br><span class="line">    # gitalk_css:</span><br><span class="line">    # blueimp_md5:</span><br><span class="line">    # valine:</span><br><span class="line">    # disqusjs:</span><br><span class="line">    # disqusjs_css:</span><br><span class="line"><span class="addition">+     twikoo: https://cdn.staticfile.org/twikoo/1.6.4/twikoo.all.min.js</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>以前记得只需更改后端版本号即可，不知什么时候开始还要更改前端CDN才行。也许主题前端没有更新到最新的版本号。这时只有自定义CDN了，还好</p>
<p><code>butterfly</code>主题很容易就能自定义CDN</p>
</blockquote>
<h2 id="更换表情CDN"><a href="#更换表情CDN" class="headerlink" title="更换表情CDN"></a>更换表情CDN</h2><p>仓库地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/zhheo">zhheo</a>&#x2F;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/zhheo/Sticker-Heo">Sticker-Heo</a></p>
<p>使用：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//cdn.jsdelivr.net/npm/sticker-heo@2022.7.5/twikoo.json</span></span><br><span class="line">https<span class="punctuation">:</span><span class="comment">//cdn1.tianli0.top/npm/sticker-heo@2022.7.5/twikoo.json</span></span><br></pre></td></tr></table></figure>

<h2 id="Twikoo-导出评论数据"><a href="#Twikoo-导出评论数据" class="headerlink" title="Twikoo 导出评论数据"></a>Twikoo 导出评论数据</h2><blockquote>
<p>Twikoo前端后台只有导入数据功能，没有导出，要想导出数据，看下面。</p>
</blockquote>
<h3 id="导出-Twikoo-在-Vercel-的数据"><a href="#导出-Twikoo-在-Vercel-的数据" class="headerlink" title="导出 Twikoo 在 Vercel 的数据"></a>导出 Twikoo 在 Vercel 的数据</h3><p>1.下载并安装 MongoDB 数据库工具，下载地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.mongodb.com/try/download/database-tools%EF%BC%9B">https://www.mongodb.com/try/download/database-tools；</a></p>
<p>&#96;</p>
<p>然后添加环境变量：<code>D:\Program Files\mongodb-database-tools-windows-x86_64-100.5.4\bin</code>到<code>Path</code></p>
<p>2.登录 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://vercel.com/">Vercel 管理后台</a>，点开 Twikoo 的环境，点击上方的 Settings，点击左侧的 Environment Variables，在页面下方找到 MONGODB_URI，点击对应的小眼睛图标，会出现数据库连接地址，点击以复制这串地址；</p>
<p>3.如果地址中包含参数，请先删去参数，参数即 “?” 和 “?” 后面的部分，例如 <code>?journal=true&amp;w=majority</code>；</p>
<p>4.打开一个命令行窗口，粘贴以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongoexport --uri 这里换成刚才复制的地址 --collection comment --type json --out twikoo-comments.json</span><br></pre></td></tr></table></figure>

<p>5.如果成功，你可以在当前目录下找到导出的 twikoo-comments.json 文件。</p>
<h3 id="导出-Twikoo-在腾讯云的数据"><a href="#导出-Twikoo-在腾讯云的数据" class="headerlink" title="导出 Twikoo 在腾讯云的数据"></a>导出 Twikoo 在腾讯云的数据</h3><p>1.登录 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb">腾讯云</a>；</p>
<p>2.打开云开发 CloudBase；</p>
<p>3.选择要导出的环境；</p>
<p>4.点击左侧的数据库，点击 comment 集合，点击导出按钮；</p>
<p>5.导出格式选择 JSON（推荐，如果想用 Excel 等软件查看，可以选择 CSV），字段不填；</p>
<p>6.点击导出按钮，导出的数据会通过浏览器自动下载。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://guole.fun/posts/626/">搭建微信通知 API 实现 Twikoo 新消息提醒</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnblogs.com/yyyzyyyz/p/15542401.html#%E5%88%A9%E7%94%A8%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E5%AE%9E%E7%8E%B0twikoo%E6%96%B0%E6%B6%88%E6%81%AF%E6%8F%90%E9%86%92">利用企业微信实现twikoo新消息提醒(python.py错误)</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://lucheng.xyz/2022/01/09/wechat-message-vercel/">微信通知Twikoo新消息提醒（Vercel版本）（python.py正确)</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://pushoo.js.org/">twikoo即时消息推送</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.codeleading.com/article/43653014515/">pip安装virtualenv报错：ERROR: Exception: Traceback (most recent call last)—有效解决方法</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/weixin_45252106/article/details/121973562">pipenv install 包名 报错问题解决</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.imaegoo.com/2022/twikoo-data-export/">Twikoo 评论数据导出教程</a></li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hexo/">hexo</a></div><div class="post_share"></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Bore</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/iwyang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:455343442@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/20475120" rel="external nofollow noreferrer" target="_blank" title="Bilibili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="/rss2.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎访问我的博客</div></div><div class="card-widget latestBB"><div class="item-headline"><i class="fas fa-bolt"></i><span>Ispeak</span></div><div class="item-content"><div class="swiper-container swiper-container-aside">
  <div class="swiper-wrapper swiper-weapper-aside"></div>
</div>
<a class="bb-btn button--animated" href="/say/" title="查看全部"><i class="far fa-hand-point-right fa-fw"></i> 查看更多 </a>
<script>
  window.kkBBConfig = {
    limit: 10,
    blog:'/say/',
    api_url: 'https://kkapi.bore.vip',
    author: '62e664654423f520964e0d43'            
  }
</script>
<script src="/img/js/speak/butterfly-speak-swiper@1.1.0.min.js"></script>
      
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1"><span class="toc-number">1.</span> <span class="toc-text">注册企业微信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">企业微信创建一个应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-API-%E4%BA%91%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">创建 API 云函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vercel%E7%89%88%E6%9C%AC"><span class="toc-number">3.1.</span> <span class="toc-text">Vercel版本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85python"><span class="toc-number">3.1.1.</span> <span class="toc-text">安装python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85pipenv"><span class="toc-number">3.1.2.</span> <span class="toc-text">安装pipenv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDrequests"><span class="toc-number">3.1.3.</span> <span class="toc-text">下载requests</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%BB%BApython-py"><span class="toc-number">3.1.4.</span> <span class="toc-text">新建python.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8twikoo%E4%B8%AD%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.5.</span> <span class="toc-text">在twikoo中配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-%E7%BC%A9%E5%86%99-wecom"><span class="toc-number">3.1.5.1.</span> <span class="toc-text">企业微信 缩写: wecom</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E5%BE%AE%E4%BF%A1%E4%B8%AD%E6%8E%A5%E6%94%B6%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%B6%88%E6%81%AF"><span class="toc-number">3.1.6.</span> <span class="toc-text">在微信中接收企业微信消息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91%E7%89%88%E6%9C%AC"><span class="toc-number">3.2.</span> <span class="toc-text">腾讯云版本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Twikoo-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text">Twikoo 配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%8D%A2-CDN-%E9%95%9C%E5%83%8F"><span class="toc-number">4.</span> <span class="toc-text">更换 CDN 镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%8D%A2%E8%A1%A8%E6%83%85CDN"><span class="toc-number">5.</span> <span class="toc-text">更换表情CDN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Twikoo-%E5%AF%BC%E5%87%BA%E8%AF%84%E8%AE%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">6.</span> <span class="toc-text">Twikoo 导出评论数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA-Twikoo-%E5%9C%A8-Vercel-%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">6.1.</span> <span class="toc-text">导出 Twikoo 在 Vercel 的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA-Twikoo-%E5%9C%A8%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">6.2.</span> <span class="toc-text">导出 Twikoo 在腾讯云的数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">7.</span> <span class="toc-text">参考链接</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/c6592a10/" title="Alist挂载网盘">Alist挂载网盘</a><time datetime="2024-04-06T09:19:21.000Z" title="发表于 2024-04-06 17:19:21">2024-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/e0c4249b/" title="彻底卸载onedrive">彻底卸载onedrive</a><time datetime="2023-09-03T12:41:26.000Z" title="发表于 2023-09-03 20:41:26">2023-09-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/26d4b8da/" title="debian 10安装xfce桌面和配置vnc和wine">debian 10安装xfce桌面和配置vnc和wine</a><time datetime="2023-07-18T11:36:29.000Z" title="发表于 2023-07-18 19:36:29">2023-07-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/12dd937c/" title="利用Github Actions自动同步Fork">利用Github Actions自动同步Fork</a><time datetime="2023-07-13T10:02:15.000Z" title="发表于 2023-07-13 18:02:15">2023-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/144e85ab/" title="office更改默认字体">office更改默认字体</a><time datetime="2023-07-02T13:02:25.000Z" title="发表于 2023-07-02 21:02:25">2023-07-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Bore</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.33"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('/pluginsSrc/pangu/dist/browser/pangu.min.js?v=4.0.7')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://t.bore.vip',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://t.bore.vip',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.staticfile.org/twikoo/1.6.41/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>