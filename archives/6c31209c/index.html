<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>hexo配置哔哔点啥&amp;&amp;Speak | Bore's Notes</title><meta name="author" content="Bore"><meta name="copyright" content="Bore"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="2022.8.1 由于腾讯云开发要开始收费了，故将哔哔点啥改成Speak。点击直达：部署 Speak   2022.8.28 Vercel崩了，要绑定个二级域名才能用。或者使用服务器部署版。   服务部署1.首先保证成功激活腾讯云开发. 2.点击一键部署至云开发  推荐创建上海环境。如选择广州环境，需要在 twikoo.init() 时额外指定环境 region: “ap-guangzhou”">
<meta property="og:type" content="article">
<meta property="og:title" content="hexo配置哔哔点啥&amp;&amp;Speak">
<meta property="og:url" content="https://bore.vip/archives/6c31209c/index.html">
<meta property="og:site_name" content="Bore&#39;s Notes">
<meta property="og:description" content="2022.8.1 由于腾讯云开发要开始收费了，故将哔哔点啥改成Speak。点击直达：部署 Speak   2022.8.28 Vercel崩了，要绑定个二级域名才能用。或者使用服务器部署版。   服务部署1.首先保证成功激活腾讯云开发. 2.点击一键部署至云开发  推荐创建上海环境。如选择广州环境，需要在 twikoo.init() 时额外指定环境 region: “ap-guangzhou”">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bore.vip/img/avatar.jpg">
<meta property="article:published_time" content="2021-08-16T21:45:30.000Z">
<meta property="article:modified_time" content="2025-08-31T05:21:52.060Z">
<meta property="article:author" content="Bore">
<meta property="article:tag" content="hugo">
<meta property="article:tag" content="hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bore.vip/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://bore.vip/archives/6c31209c/index.html"><link rel="preconnect"/><meta name="google-site-verification" content="qEczu2lhPn2fSX-0ejGU0PZ7R60n_mDcTi-aQmUlrfA"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.33" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过了","messageNext":"天，文章所描述的內容可能已经发生变化，请留意。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hexo配置哔哔点啥&&Speak',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-31 13:21:52'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Bore's Notes" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-hot"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/say/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-user-friends"></i><span> 友圈</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Bore's Notes"><span class="site-name">Bore's Notes</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-hot"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/say/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-user-friends"></i><span> 友圈</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">hexo配置哔哔点啥&amp;&amp;Speak</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-16T21:45:30.000Z" title="发表于 2021-08-17 05:45:30">2021-08-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-31T05:21:52.060Z" title="更新于 2025-08-31 13:21:52">2025-08-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span></div></div></div><article class="post-content" id="article-container"><div class="note warning flat"><p>2022.8.1 由于腾讯云开发要开始收费了，故将<code>哔哔点啥</code>改成<code>Speak</code>。点击直达：<a class="btn-beautify blue larger" href="/archives/6c31209c/#%E9%83%A8%E7%BD%B2Speak" 
  title="部署 Speak"><i class="far fa-hand-point-right"></i><span>部署 Speak</span></a></p>
</div>

<div class="note warning flat"><p>2022.8.28 Vercel崩了，要绑定个二级域名才能用。或者使用服务器部署版。</p>
</div>

<h2 id="服务部署"><a href="#服务部署" class="headerlink" title="服务部署"></a>服务部署</h2><p>1.首先保证成功激活腾讯云开发.</p>
<p>2.<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/env/index?action=CreateAndDeployCloudBaseProject&appUrl=https://github.com/lmm214/bber&branch=main">点击一键部署至云开发</a></p>
<blockquote>
<p>推荐创建上海环境。如选择广州环境，需要在 twikoo.init() 时额外指定环境 region: “ap-guangzhou”</p>
</blockquote>
<p>3.进入环境-登录授权，启用“匿名登录”</p>
<p>4.进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/env/safety">环境-安全配置</a>，将博客网址添加到“WEB安全域名”</p>
<p>5.进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/env/access">环境-HTTP访问服务</a>，复制链接备用。</p>
<p>进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/scf/index">云函数</a>，修改自定义serverkey <code>bber</code> 并保存备用。</p>
<p>6.进入云函数，修改自定义serverkey bber 并保存备用。</p>
<p>7.扫码进入公众号，输入命名绑定。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/bber 你刚刚设置的key,https://你的云函数HTTP访问地址/bber</span><br><span class="line"></span><br><span class="line">比如: /bber mykey,https://balabala.ap-shanghai.app.tcloudbase.com/bber</span><br></pre></td></tr></table></figure>

<p><strong>8. 手动添加一条哔哔 <em>必须要有</em></strong></p>
<p>进入腾讯云数据库-&gt;talks-&gt;文档列表-&gt;添加文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">字段: content</span><br><span class="line">类型: string</span><br><span class="line">值: 随便</span><br></pre></td></tr></table></figure>

<p>点击确定</p>
<p>验证微信发送</p>
<p>9.微信发送一条文字，返回哔哔成功，talks文档列表里多出来一条，即为服务部署成功。</p>
<h2 id="前端部署"><a href="#前端部署" class="headerlink" title="前端部署"></a>前端部署</h2><p>1.打开Hugo的unsafe</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">markup:</span></span><br><span class="line">    <span class="attr">tableOfContents:</span></span><br><span class="line">        <span class="attr">endLevel:</span> <span class="number">4</span></span><br><span class="line">        <span class="attr">ordered:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">startLevel:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">highlight:</span></span><br><span class="line">        <span class="attr">noClasses:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">goldmark:</span></span><br><span class="line">        <span class="attr">renderer:</span></span><br><span class="line">            <span class="attr">unsafe:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>2.新建一个<em>markdown</em>文件（此法不通，jsdelivr用不了，需要更换地址，见下文）</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;speak&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">speak</span>&gt;</span></span></span><br><span class="line">&lt;!-- 使用markdown渲染 --&gt;</span><br><span class="line">&lt;!-- 使用markdown渲染 --&gt;</span><br><span class="line">&lt;!-- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak-bber/ispeak-bber-md.min.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> &gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> --&gt;</span><br><span class="line">&lt;!-- 不使用markdown渲染 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak-bber/ispeak-bber.min.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> &gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- 解析微信表情（参考：https://github.com/buddys/qq-wechat-emotion-parser） --&gt;</span><br><span class="line">&lt;!-- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/buddys/qq-wechat-emotion-parser@master/dist/qq-wechat-emotion-parser.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">ispeakBber</span><br><span class="line"><span class="code">    .init(&#123;</span></span><br><span class="line"><span class="code">      el: &#x27;#speak&#x27;, // 容器选择器</span></span><br><span class="line"><span class="code">      name: &#x27;bore&#x27;, // 显示的昵称</span></span><br><span class="line"><span class="code">      envId: &#x27;腾讯云开发环境id&#x27;, // 环境id</span></span><br><span class="line"><span class="code">      region: &#x27;ap-shanghai&#x27;, // 腾讯云地址，默认为上海</span></span><br><span class="line"><span class="code">      limit: 10, // 每次加载的条数，默认为5</span></span><br><span class="line"><span class="code">      avatar: &#x27;https://cdn.jsdelivr.net/gh/iwyang/pic/avatar.jpg&#x27;,</span></span><br><span class="line"><span class="code">      fromColor:&#x27;rgb(245, 150, 170)&#x27;, // 下方标签背景颜色 默认 rgb(245, 150, 170)</span></span><br><span class="line"><span class="code">      loadingImg: &#x27;https://7.dusays.com/2021/03/04/d2d5e983e2961.gif&#x27;, // 自定义loading的图片，示例值为默认值</span></span><br><span class="line"><span class="code">      dbName:&#x27;talks&#x27; // 数据的名称，默认talks，避免有人的命名不是这个，所以加入此配置字段。</span></span><br><span class="line"><span class="code">    &#125;)</span></span><br><span class="line"><span class="code">    .then(function() &#123;</span></span><br><span class="line"><span class="code">      // 哔哔加载完成后的回调函数，你可以写你自己的功能</span></span><br><span class="line"><span class="code">      console.log(&#x27;哔哔 加载完成&#x27;)</span></span><br><span class="line"><span class="code">    &#125;)</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>2022.5.18 <code>jsdelivr</code>用不了，需要修改地址（本地相对路径）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="string">.page-title</span> &#123;</span><br><span class="line">    <span class="attr">display:</span> <span class="string">none;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;!--</span>  <span class="string">自言自语</span>  <span class="string">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&lt;div</span> <span class="string">id=&#x27;speak&#x27;&gt;</span></span><br><span class="line"><span class="string">&lt;script</span> <span class="string">type=&quot;text/javascript&quot;</span> <span class="string">src=&quot;/img/js/ispeak-bber.min.js&quot;</span> <span class="string">charset=&quot;utf-8&quot;</span> <span class="string">&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">ispeakBber</span></span><br><span class="line">    <span class="string">.init(&#123;</span></span><br><span class="line">        <span class="attr">el:</span> <span class="string">&#x27;#speak&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">容器选择器</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">&#x27;Bore 🦄&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">显示的昵称</span></span><br><span class="line">        <span class="attr">envId:</span> <span class="string">&#x27;hello-cloudbase-0gc8y1np937491cb&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">环境id</span></span><br><span class="line">        <span class="attr">region:</span> <span class="string">&#x27;ap-shanghai&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">腾讯云地址，默认为上海</span></span><br><span class="line">        <span class="attr">limit:</span> <span class="number">10</span><span class="string">,</span> <span class="string">//</span> <span class="string">每次加载的条数，默认为5</span></span><br><span class="line">        <span class="attr">avatar:</span> <span class="string">&#x27;/img/avatar.jpg&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">头像地址</span></span><br><span class="line">        <span class="string">fromColor:&#x27;rgb(245,</span> <span class="number">150</span><span class="string">,</span> <span class="number">170</span><span class="string">)&#x27;,</span> <span class="string">//</span> <span class="string">下方标签背景颜色</span> <span class="string">默认</span> <span class="string">rgb(245,</span> <span class="number">150</span><span class="string">,</span> <span class="number">170</span><span class="string">)</span></span><br><span class="line">        <span class="attr">loadingImg:</span> <span class="string">&#x27;/img/loading.gif&#x27;</span><span class="string">,</span> <span class="string">//</span> <span class="string">自定义loading的图片，示例值为默认值</span></span><br><span class="line">        <span class="string">dbName:&#x27;talks&#x27;</span> <span class="string">//</span> <span class="string">数据的名称，默认talks，避免有人的命名不是这个，所以加入此配置字段。</span></span><br><span class="line">    <span class="string">&#125;)</span></span><br><span class="line">    <span class="string">.then(function()</span> &#123;</span><br><span class="line">        <span class="string">//</span> <span class="string">哔哔加载完成后的回调函数，你可以写你自己的功能</span></span><br><span class="line">        <span class="string">console.log(&#x27;哔哔</span> <span class="string">加载完成&#x27;)</span></span><br><span class="line">    &#125;<span class="string">)</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>



<p>3.bber 说说美化(调整了说说出现图片时，顶部空白过大问题；更换一种 timeago 方法，解决 “两周前”、“三周前” 等部分情况下显示实际日期的 bug；修复头像尺寸异常的 bug等)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  自言自语  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;speak&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/timeago.min.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/kuole-o/bber-ispeak@main/dist/ispeak-bber.min.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">ispeakBber</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#speak&#x27;</span>, <span class="comment">// 容器选择器</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&#x27;夜的第八章 🦄&#x27;</span>, <span class="comment">// 显示的昵称</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">envId</span>: <span class="string">&#x27;blogpkly-13278c&#x27;</span>, <span class="comment">// 环境id</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">region</span>: <span class="string">&#x27;ap-shanghai&#x27;</span>, <span class="comment">// 腾讯云地址，默认为上海</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">limit</span>: <span class="number">7</span>, <span class="comment">// 每次加载的条数，默认为5</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">avatar</span>: <span class="string">&#x27;https://cdn.guole.fun/img/gl.jpg&#x27;</span>, <span class="comment">// 头像地址</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">fromColor</span>:<span class="string">&#x27;rgb(245, 150, 170)&#x27;</span>, <span class="comment">// 下方标签背景颜色 默认 rgb(245, 150, 170)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loadingImg</span>: <span class="string">&#x27;https://7.dusays.com/2021/03/04/d2d5e983e2961.gif&#x27;</span>, <span class="comment">// 自定义loading的图片，示例值为默认值</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">dbName</span>:<span class="string">&#x27;talks&#x27;</span> <span class="comment">// 数据的名称，默认talks，避免有人的命名不是这个，所以加入此配置字段。</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 哔哔加载完成后的回调函数，你可以写你自己的功能</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;哔哔 加载完成&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="部署BBer-weixin公众号"><a href="#部署BBer-weixin公众号" class="headerlink" title="部署BBer-weixin公众号"></a>部署BBer-weixin公众号</h2><p>点击<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/env/index?action=CreateAndDeployCloudBaseProject&appUrl=https://github.com/lmm214/bber-weixin&branch=main">部署到云开发</a>将 BBer-weixin 微信公众号后端，一键部署到云开发。</p>
<p>对接的微信公众号简要流程：</p>
<p>1.点击 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/scf/index">bber-weixin</a> 云函数，右上角<strong>【编辑】</strong>，开启<strong>【固定IP】</strong>，留存<strong>公网固定IP</strong>。</p>
<blockquote>
<p>我将from <code>微信公众号</code>改成了<code>💎 WeChat</code></p>
</blockquote>
<p>2.进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/env/access">环境-HTTP访问服务</a>，获取<code>触发路径链接</code>并留存，如以下格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://bb-f5c0f-222222.ap-shanghai.app.tcloudbase.com/bber-weixin</span><br></pre></td></tr></table></figure>

<p>3.打开 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/">微信公众平台</a>，进入开发-基本配置，获取<code>AppID</code>和<code>AppSecret</code>留存，修改<code>IP白名单</code>为上一步的公网固定IP。继续服务器配置：</p>
<blockquote>
<p>消息加密方式选择<code>兼容模式</code></p>
</blockquote>
<p>一个<code>URL</code>，即第2步留存的触发链接；</p>
<p>一个<code>Token</code>，预设为 <code>weixin</code></p>
<p><strong>!!!先不点，不点，不点，不点提交！！！</strong></p>
<p>4.回 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/scf/index">bber-weixin</a> 云函数，填入<code>微信公众号appid</code>、<code>微信公众号appsecret</code> 保存。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const token = <span class="string">&#x27;weixin&#x27;</span> // 微信公众号的服务器验证用的令牌 token</span><br><span class="line">//填入自己的微信公众号appid和appsecret</span><br><span class="line">var wxappid = <span class="string">&#x27;微信公众号appid&#x27;</span>,</span><br><span class="line">    wxappsecret = <span class="string">&#x27;微信公众号appsecret&#x27;</span>,</span><br></pre></td></tr></table></figure>

<p>5.回 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/">微信公众平台</a>，提交，验证成功！</p>
<p>6.回 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.cloud.tencent.com/tcb/scf/index">bber-weixin</a> 云函数，注释第44行代码，保存。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(tmpStr == signature)&#123;</span><br><span class="line">     //请求来源鉴权</span><br><span class="line">     //成功后注释下行代码</span><br><span class="line">     //return event.queryStringParameters.echostr //成功后注释本行代码</span><br><span class="line">     //成功后注释上行代码</span><br></pre></td></tr></table></figure>

<p>7.手动配置或更新代码： <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/lmm214/bber-weixin/tree/main/bber-weixin">https://github.com/lmm214/bber-weixin/tree/main/bber-weixin</a></p>
<h2 id="公众号发布说说"><a href="#公众号发布说说" class="headerlink" title="公众号发布说说"></a>公众号发布说说</h2><p><del>接上面，部署好自己的公众号就可以用公众号发布了。这里注意利用公众号发图片。</del></p>
<p>1.先在公众号发一张图片</p>
<p>2.接着输入<code>/a &lt;br&gt;文字说明</code></p>
<p>(输入<code>&lt;br&gt;</code>是为了使图片和文字不处于同一行)</p>
<p>注意：用公众号发图片会一连发几张，不知道是什么原因，以后就用浏览器插件发图片，注意<strong>比例 16:9，长度568px</strong></p>
<h2 id="Chrome-Edge-发布说说"><a href="#Chrome-Edge-发布说说" class="headerlink" title="Chrome + Edge 发布说说"></a>Chrome + Edge 发布说说</h2><h3 id="安装本地插件"><a href="#安装本地插件" class="headerlink" title="安装本地插件"></a>安装本地插件</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cdn.guole.fun/others/bber%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%91%E5%B8%83%E6%8F%92%E4%BB%B6.zip">点此下载我提取并修改的浏览器插件包</a></p>
<p>Chrome 安装本地插件：</p>
<p>访问 Chrome——更多工具——扩展程序——左上角“加载已解压的扩展程序”，选择我提供的附件，解压缩后的文件夹 1.0.0_0_Chrome，然后回到 Chrome，点开右上角<code>扩展程序</code>来固定插件。</p>
<p>注意：插件文件移动或丢失后，浏览器扩展失效，因为不是云端的，所以要保存在可靠路径。</p>
<h3 id="应用商店安装插件"><a href="#应用商店安装插件" class="headerlink" title="应用商店安装插件"></a>应用商店安装插件</h3><p>下载地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://chrome.google.com/webstore/detail/ispeak-bber%E6%97%B6%E5%85%89%E6%9C%BA/mmehomnjakoijcfmmofbmkaigcdkkbke/related">iSpeak-bber时光机</a></p>
<p>本地插件<code>from</code>默认为<code>🌈 Chrome</code></p>
<h2 id="Android-捷径发布说说"><a href="#Android-捷径发布说说" class="headerlink" title="Android 捷径发布说说"></a>Android 捷径发布说说</h2><p>从 Github 下载安装这款 “HTTP 快捷方式” apk，安装后继续下文操作。</p>
<p>下载地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Waboodoo/HTTP-Shortcuts/releases">HTTP-Shortcuts</a></p>
<p>打开 HTTP 快捷方式 App，选择新建快捷方式，自定义名称、描述，在 “基本设置” 中，设置方法为 “POST” 或 “GET”，URL 为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bber?key=</span><br></pre></td></tr></table></figure>

<p>至于 key、from，我们设置为常量，text 则设置为变量 content，每次发布的时候填写说说内容。</p>
<p>点击 URL 右侧的 {}，选择添加变量。常量 key 为你云函数里的 key，如果没有特别设置就是 bber。from 我们设置一个好玩的如<code>📱 Android 11</code>。添加一个变量 content。（个人觉得from直接设置为<code>Android</code>就行，不然免得以后安卓升级版本，还要跟着修改。）</p>
<p>接着回到 URL 页面，补充完刚才添加的常量和变量，如以下格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bber?key=&#123;key&#125;&amp;from=&#123;from&#125;&amp;text=&#123;content&#125;</span><br></pre></td></tr></table></figure>

<p>右上角，保存这个快捷方式，然后长按发送到桌面，搞定！</p>
<h2 id="修改ispeak-bber样式"><a href="#修改ispeak-bber样式" class="headerlink" title="修改ispeak-bber样式"></a>修改<code>ispeak-bber</code>样式</h2><h3 id="隐藏页面标题"><a href="#隐藏页面标题" class="headerlink" title="隐藏页面标题"></a>隐藏页面标题</h3><p>将以下代码放在文章正文最上方。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/CaiJimmy/hugo-theme-stack">hugo-stack</a>主题：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.article-header</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">hexo-butterfly</a>主题：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.page-title</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="修改顶部文字"><a href="#修改顶部文字" class="headerlink" title="修改顶部文字"></a>修改顶部文字</h3><p>自己胡乱改的，居然起了作用。不管了先用再说。</p>
<p>1.首先下载：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cdn.jsdelivr.net/npm/ispeak-bber/ispeak-bber-md.min.js">ispeak-bber-md.min.js</a></p>
<p>2.用<code>Notepad++</code>打开，搜索<code>My BiBi</code>改成<code>我的说说</code>。</p>
<p>3.按F12，打开浏览器控制台，定位标题。可以发现<code>color: #49b1f5</code>前面就是标题字体大小，搜索<code>color: #49b1f5</code>，将前面的字体改成22px：<code>font-size: 22px</code></p>
<p>4.接着改图标大小，一样方法定位图标，可以发现<code>color: black</code>后面就是图标大小，搜索<code>color: black</code>，将后面图标大小改成22px：<code>font-size: 22px</code></p>
<h3 id="修复说说出现图片时，顶部空白过大问题"><a href="#修复说说出现图片时，顶部空白过大问题" class="headerlink" title="修复说说出现图片时，顶部空白过大问题"></a>修复说说出现图片时，顶部空白过大问题</h3><p>搜索<code>white-space</code>作如下修改</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- &#123;\n  padding: 10px 0;\n  white-space: pre-wrap;\n&#125;</span></span><br><span class="line"><span class="addition">+ &#123;\n  padding: 0.8rem 0;\n&#125;</span></span><br></pre></td></tr></table></figure>

<p><del>注意：利用微信公众号发图片后追加文字说明，前面要加个换行符，要不然图片和文字处在同一行。</del></p>
<p>注意：用公众号发图片会一连发几张，不知道是什么原因，以后就用浏览器插件发图片，注意<strong>比例 16:9，长度568px</strong></p>
<h3 id="解决公众号连续发多张图片"><a href="#解决公众号连续发多张图片" class="headerlink" title="解决公众号连续发多张图片"></a>解决公众号连续发多张图片</h3><p>云函数代码问题，改成下面这样即可（<strong>还未测试</strong>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">104行</span><br><span class="line"><span class="built_in">let</span> res = await cloudRequest(cloudHttpUrl,cloudKey,createTime,content)</span><br><span class="line"></span><br><span class="line">124行</span><br><span class="line"><span class="built_in">let</span> res = await cloudRequest(cloudHttpUrl,cloudKey,createTime,content)</span><br><span class="line"></span><br><span class="line">160行</span><br><span class="line"><span class="keyword">function</span> cloudRequest(cloudHttpUrl,cloudKey,createTime,content)&#123;</span><br></pre></td></tr></table></figure>

<p>中，删掉 “createTime,”，接着</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">162行</span><br><span class="line">var param1 = &#123;<span class="string">&#x27;key&#x27;</span>: cloudKey,<span class="string">&#x27;time&#x27;</span>: createTime,<span class="string">&#x27;text&#x27;</span>: content,<span class="string">&#x27;from&#x27;</span>:<span class="string">&#x27;微信公众号&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>删掉 “’time’: createTime,” 就解决了。</p>
<h3 id="取消显示’一周前’-’一小时前’"><a href="#取消显示’一周前’-’一小时前’" class="headerlink" title="取消显示’一周前’,’一小时前’"></a>取消显示’一周前’,’一小时前’</h3><p>去掉“周前”，”月前“这些时间点：</p>
<ul>
<li><ol>
<li>找到<code>ispeak-bber-md.min.js</code> or <code>ispeak-bber.min.js</code></li>
</ol>
</li>
<li><p>2.复制下面这段代码，查找，然后删掉它们 (未测试)</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(l&gt;=<span class="number">1</span>&amp;&amp;l&lt;=<span class="number">3</span>)n=<span class="string">&quot; &quot;</span>+<span class="built_in">parseInt</span>(l)+<span class="string">&quot; 月前&quot;</span>;<span class="keyword">else</span> <span class="keyword">if</span>(f&gt;=<span class="number">1</span>&amp;&amp;f&lt;=<span class="number">3</span>)n=<span class="string">&quot; &quot;</span>+<span class="built_in">parseInt</span>(f)+<span class="string">&quot; 周前&quot;</span>;<span class="keyword">else</span> <span class="keyword">if</span>(c&gt;=<span class="number">1</span>&amp;&amp;c&lt;=<span class="number">6</span>)n=<span class="string">&quot; &quot;</span>+<span class="built_in">parseInt</span>(c)+<span class="string">&quot; 天前&quot;</span>;<span class="keyword">else</span> <span class="keyword">if</span>(u&gt;=<span class="number">1</span>&amp;&amp;u&lt;=<span class="number">23</span>)n=<span class="string">&quot; &quot;</span>+<span class="built_in">parseInt</span>(u)+<span class="string">&quot; 小时前&quot;</span>;<span class="keyword">else</span> <span class="keyword">if</span>(a&gt;=<span class="number">1</span>&amp;&amp;a&lt;=<span class="number">59</span>)n=<span class="string">&quot; &quot;</span>+<span class="built_in">parseInt</span>(a)+<span class="string">&quot; 分钟前&quot;</span>;<span class="keyword">else</span> <span class="keyword">if</span>(s&gt;=<span class="number">0</span>&amp;&amp;s&lt;=r)n=<span class="string">&quot;刚刚&quot;</span>;<span class="keyword">else</span></span><br></pre></td></tr></table></figure>

<h2 id="butterfly-主题添加首页轮播"><a href="#butterfly-主题添加首页轮播" class="headerlink" title="butterfly 主题添加首页轮播"></a>butterfly 主题添加首页轮播</h2><p>添加首页轮播借助了 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://butterfly.js.org/posts/ea33ab97/">butterfly 主题自定义组件</a>的功能实现，通过在自定义组件处加载 JavaScript 生成首页的轮播展示。</p>
<h3 id="创建-widget-yml"><a href="#创建-widget-yml" class="headerlink" title="创建 widget.yml"></a>创建 widget.yml</h3><p>在Hexo博客目录中的<code>source/_data</code>（如果没有 _data 文件夹，请自行创建），创建一个文件 widget.yml，代码如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">latestBB</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">最新说说</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-bolt</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;swiper-container swiper-container-aside&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;swiper-wrapper swiper-weapper-aside&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;a class=&quot;bb-btn button--animated&quot; href=&quot;/say/&quot; title=&quot;查看全部&quot;&gt;&lt;i class=&quot;far fa-hand-point-right fa-fw&quot;&gt;&lt;/i&gt; 查看更多 &lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;script&gt;</span></span><br><span class="line"><span class="string">        window.kkBBConfig = &#123;</span></span><br><span class="line"><span class="string">          limit: 10,</span></span><br><span class="line"><span class="string">          blog:&#x27;/say/&#x27;,</span></span><br><span class="line"><span class="string">          api_url:</span></span><br><span class="line"><span class="string">            &#x27;https://xxx/json/bber.json&#x27;//你的json url</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script src=&quot;https://cdn.jsdelivr.net/npm/butterfly-bber-swiper/dist/index.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>2022.5.18 <code>jsdelivr</code>用不了，需要修改地址（本地相对路径）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">latestBB</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">最新说说</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-bolt</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;swiper-container swiper-container-aside&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;swiper-wrapper swiper-weapper-aside&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;a class=&quot;bb-btn button--animated&quot; href=&quot;/say/&quot; title=&quot;查看全部&quot;&gt;&lt;i class=&quot;far fa-hand-point-right fa-fw&quot;&gt;&lt;/i&gt; 查看更多 &lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;script&gt;</span></span><br><span class="line"><span class="string">        window.kkBBConfig = &#123;</span></span><br><span class="line"><span class="string">          limit: 10,</span></span><br><span class="line"><span class="string">          blog:&#x27;/say/&#x27;,</span></span><br><span class="line"><span class="string">          api_url:</span></span><br><span class="line"><span class="string">            &#x27;https://xxx/json/bber.json&#x27;//你的json url</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script src=&quot;/img/js/butterfly-bber-swiper.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="去掉侧边栏最新说说"><a href="#去掉侧边栏最新说说" class="headerlink" title="去掉侧边栏最新说说"></a>去掉侧边栏最新说说</h3><p>在 <code>blog/source/css/custom.css</code> 文件中，加入以下代码即可。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 去掉侧边栏最新吐槽 */</span></span><br><span class="line"><span class="selector-class">.latestBB</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="解决移动端二级菜单缩进问题"><a href="#解决移动端二级菜单缩进问题" class="headerlink" title="解决移动端二级菜单缩进问题"></a>解决移动端二级菜单缩进问题</h3><p>设置完首页轮播后，移动端二级菜单会出现缩进问题，浏览器F12发现问题：</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/QQ%E6%88%AA%E5%9B%BE20220521125739.jpg"></p>
<p>解决方法：</p>
<p><code>butterfly-bber-swiper.min.js</code>(轮播js文件)，<del>搜索<code>bbTimeList</code>删除前面的<code>padding: 0;\n</code></del>；直接搜索<code>padding: 0;\n</code>将其删除，注意后面就是<code>bbTimeList</code>，搜索<code>bbTimeList</code>会出现多个结果，故搜索后者较好。</p>
<h2 id="部署Speak"><a href="#部署Speak" class="headerlink" title="部署Speak"></a>部署Speak</h2><p>2022.8.1 由于腾讯云开发要开始收费了，故将<code>哔哔点啥</code>改成<code>Speak</code>。官方文档：</p>
<ul>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.antmoe.com/speak/">小康Speak</a></p>
</li>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi-doc.vercel.app/">kkAPI-Doc</a></p>
<ul>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/kkfive/kkapi-open">kkapi-open</a></p>
</li>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/kkfive/kkadmin-open">kkadmin-open</a></p>
</li>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/kkfive/iSpeak/">iSpeak</a></p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>首先要参考上面官方文档搭建好API、后台管理等内容。然后再弄前端。Vercel搭建见官方文档，<strong>下面主要记录服务器部署。</strong></p>
</blockquote>
<h3 id="Docker-安装-MongoDB"><a href="#Docker-安装-MongoDB" class="headerlink" title="Docker 安装 MongoDB"></a>Docker 安装 MongoDB</h3><p>1.先安装docker，参考：<a href="/archives/9755dbc8/">Debian 10 安装 Docker &amp; Docker Compose</a></p>
<p>2.取最新版的 MongoDB 镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mongo:latest</span><br></pre></td></tr></table></figure>

<p>3.查看本地镜像，使用以下命令来查看是否已安装了 mongo：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p>4.运行容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name mongodb \</span><br><span class="line">	-p 27017:27017 \</span><br><span class="line">	-v /my/own/datadir:/data/db \</span><br><span class="line">	-e MONGO_INITDB_ROOT_USERNAME=mongoadmin \</span><br><span class="line">	-e MONGO_INITDB_ROOT_PASSWORD=secret \</span><br><span class="line">	mongo</span><br></pre></td></tr></table></figure>

<p>之后可以使用工具测试一下连接。如<code>navicat</code></p>
<p>5.使容器开机启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker update --restart=always mongodb</span><br></pre></td></tr></table></figure>

<h3 id="kkapi-部署"><a href="#kkapi-部署" class="headerlink" title="kkapi 部署"></a>kkapi 部署</h3><p>1.首先克隆项目源码 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://ghproxy.com/https://github.com/kkfive/kkapi-open.git</span><br></pre></td></tr></table></figure>

<p>2.接下来j进入项目目录，安装项目需要安装的工具 <code>yarn</code> 和 <code>pm2</code>，分别是 :</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd kkapi-open</span><br><span class="line">apt install npm -y</span><br><span class="line">npm i yarn -g</span><br><span class="line">npm i pm2 -g</span><br></pre></td></tr></table></figure>

<p>3.<strong>升级node版本</strong>，仓库给的构建版本是16+的，node版本过低，下一步会出错，最后一步项目无法启动。(上面安装npm时默认会安装低版本node，所以要更新node版本)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br><span class="line">curl -fsSL https://deb.nodesource.com/setup_current.x | sudo -E bash -</span><br><span class="line">sudo apt install nodejs -y</span><br><span class="line">node --version</span><br></pre></td></tr></table></figure>

<p>上面操作会安装最新版的node，安装nodeV16：<code>curl -sL https://deb.nodesource.com/setup_16.x | sudo bash -</code></p>
<p>4.然后安装项目所需依赖 <code>yarn install</code></p>
<p>5.之后再执行 <code>yarn build</code> 编译项目。<del>这里我的小鸡顶不住编译所以自己在本地编译传上去了。</del></p>
<p>6.在项目文件夹创建环境变量文件，格式如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi local.env</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PORT=3000</span><br><span class="line">DATABASE_URL=mongodb://127.0.0.1:27017/kkpaiopen?authSource=admin</span><br><span class="line">DATABASE_USER=mongoadmin</span><br><span class="line">DATABASE_PASSWORD=secret</span><br><span class="line"><span class="comment"># 加密密钥 测试</span></span><br><span class="line">SECRETKEY=xxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure>

<p>7.使用 <code>pm2</code> 使用守护线程启动项目 <code>pm2 start pm2.json</code></p>
<p>我启动项目遇到了 <code>[PM2][WARN] Expect “restart_delay” to be a typeof [object Number], but now is [object String]</code> 错误，这个错误原因是作者的 pm2.json 中的 <code>restart_delay</code> 值是字符串类型 <code>60s</code> 改成数值 <code>60</code> 就可以了。</p>
<p>8.测试项目是否成功启动 可以使用 <code>lsof -i:端口</code> 查看端口是否被监听判断项目是否成功启动。没成功的原因大概率是因为数据库连接地址、数据库账号密码不正确。</p>
<p>9.创建初始化用户 <code>curl http://127.0.0.1:3000/api/user/init?userName=bore</code> 创建的默认用户名和密码是 <code>bore</code> 和 <code>123456</code>，这个用户名密码用来登陆可视化的管理后台，并且用户似乎<strong>只能拥有一个</strong>。</p>
<p>10.更新项目</p>
<p>进入项目并执行一下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br><span class="line">yarn build</span><br><span class="line">pm2 restart pm2.json</span><br></pre></td></tr></table></figure>

<p><strong>11.备份</strong></p>
<p><code>/my/own/datadir</code> 这一段就是数据库的文件，把这个打包搞走就行，然后换到新地方以后，部署mongodb数据库还要对应上。</p>
<p><strong>首先完整搭建好（要初始化账号，能访问后台，这时后台会显示什么都没有），然后删除<code>my</code>文件夹，将备份的数据库文件夹上传到相应目录，重启容器即可登录后台，查看到原来的数据了。</strong></p>
<p>定时备份数据库，参考：<a href="https://bore.vip/archives/3a4bd17/">halo 定时备份的方法</a></p>
<h3 id="开机启动kkapi"><a href="#开机启动kkapi" class="headerlink" title="开机启动kkapi"></a>开机启动kkapi</h3><p>1.编辑脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi s.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!<span class="regexp">/bin/</span>bash</span><br><span class="line">cd /root/kkapi-open</span><br><span class="line">/usr/local/bin/pm2 start pm2.<span class="property">json</span></span><br></pre></td></tr></table></figure>

<p>2.赋予脚本执行权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /root/s.sh</span><br></pre></td></tr></table></figure>

<p>运行的时候就输入下面的代码即可：<code>./s.sh</code></p>
<p>3.设定开机自动运行脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@reboot /root/s.sh</span><br></pre></td></tr></table></figure>

<h3 id="配置域名访问"><a href="#配置域名访问" class="headerlink" title="配置域名访问"></a>配置域名访问</h3><p>参考：</p>
<p><a href="/archives/d5e37958/#%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE">配置域名访问</a></p>
<p><a href="/archives/d5e37958/#%E7%94%B3%E8%AF%B7SSL%E8%AF%81%E4%B9%A6">申请 SSL 证书</a></p>
<p><a href="/archives/58fed3fc/#%E4%BD%BF%E7%94%A8-webroot-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6-1">SSL证书自动续期</a></p>
<p><strong>注意修改反代端口号，如果SSL443端口不能用，将<code>listen 443</code>改成<code>listen 1314</code></strong></p>
<h3 id="kkapiadmin（可视化管理后台）"><a href="#kkapiadmin（可视化管理后台）" class="headerlink" title="kkapiadmin（可视化管理后台）"></a>kkapiadmin（可视化管理后台）</h3><p>见官方文档：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi.js.org/guide/admin/setup.html">kkapi后台配置</a></p>
<p>之后登录就是用前面初始化的用户名密码，进入后台以后可以修改密码。登陆后台以后需要设置：</p>
<ul>
<li>ISpeak 标签。因为发布说说是需要选择标签的，标签中的背景颜色值是<strong>十六进制的颜色</strong>代码</li>
<li>添加用户token。<strong>需要注意！！！</strong>，添加的token的<strong>标题</strong>只能是 <code>speak</code> 不能是其他的，否则发布说说时会提示token不存在，发布时验证的就是字段为 <code>speak</code> 的token的值。</li>
</ul>
<h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi-doc.vercel.app/posts/ispeak/front.html#%E5%8D%9A%E5%AE%A2%E5%89%8D%E7%AB%AF%E6%96%B9%E6%A1%88">博客前端方案</a>，新建一个<code>Markdown</code>文件：</p>
<h3 id="v4-4-0以前"><a href="#v4-4-0以前" class="headerlink" title="v4.4.0以前"></a>v4.4.0以前</h3><p><strong>官方：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span>ipseak加载中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;ispeak&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/styles/atom-one-dark.min.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak@4.2.0/style.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#article-container</span> <span class="selector-class">.D-avatar</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.D-footer</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/marked/2.0.0/marked.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/discuss/dist/Discuss.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak@4.2.0/ispeak.umd.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> head = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> meta = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;meta&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">name</span> = <span class="string">&#x27;referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">content</span> = <span class="string">&#x27;no-referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  head.<span class="title function_">appendChild</span>(meta)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (ispeak) &#123;</span></span><br><span class="line"><span class="language-javascript">    ispeak</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#ispeak&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">api</span>: <span class="string">&#x27;https://kkapi-dev.vercel.app/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">author</span>: <span class="string">&#x27;61fe93508fd621d39a155725&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">pageSize</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading_img</span>: <span class="string">&#x27;https://bu.dusays.com/2022/05/01/626e88f349943.gif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">initCommentName</span>: <span class="string">&#x27;Discuss&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">initCommentOptions</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">serverURLs</span>: <span class="string">&#x27;https://kkdiscuss.vercel.app/&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ispeak 加载完成&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">&#x27;ipseak依赖加载失败！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>自用：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js-pjax&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span>ipseak加载中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js-pjax&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ispeak&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/styles/atom-one-dark.min.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn1.tianli0.top/npm/ispeak@4.3.3/style.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#article-container</span> <span class="selector-class">.D-avatar</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.D-footer</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/marked/2.0.0/marked.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn1.tianli0.top/npm/ispeak@4.3.3/ispeak.umd.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> head = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> meta = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;meta&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">name</span> = <span class="string">&#x27;referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">content</span> = <span class="string">&#x27;no-referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  head.<span class="title function_">appendChild</span>(meta)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (ispeak) &#123;</span></span><br><span class="line"><span class="language-javascript">    ispeak</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#ispeak&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">api</span>: <span class="string">&#x27;https://kkapi-open-six.vercel.app/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">author</span>: <span class="string">&#x27;这里填个人ID&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">pageSize</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading_img</span>: <span class="string">&#x27;https://bu.dusays.com/2022/05/01/626e88f349943.gif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">speakPage</span>: <span class="string">&#x27;/say&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">githubClientId</span>: <span class="string">&#x27;这里填githubClientId&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">hideComment</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ispeak 加载完成&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">&#x27;ipseak依赖加载失败！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>如若CDN用不了，上面的<code>CSS</code>、<code>JS</code>、<code>图像</code>等可以用本地路径，如：<code>/img/loading.gif</code>  <code>/img/js/speak/style.css</code>，不用使用：<del>..&#x2F;img&#x2F;loading.gif</del>，使用上面的相对路径即可。</li>
<li>hugo loveit主题要把 KaTeX 在这个页面单独关闭，因为和说说冲突了。<code>math: false</code></li>
</ul>
</blockquote>
<h3 id="v4-4-0以后"><a href="#v4-4-0以后" class="headerlink" title="v4.4.0以后"></a>v4.4.0以后</h3><p><strong>官方：</strong> （以<a target="_blank" rel="noopener external nofollow noreferrer" href="https://artalk.js.org/">Artalk</a>评论为例）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span>ipseak加载中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;ispeak&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/styles/atom-one-dark.min.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak@4.4.0/style.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/marked/2.0.0/marked.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/ispeak@4.4.0/ispeak.umd.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- CSS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://unpkg.com/artalk@2.3.4/dist/Artalk.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- JS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/artalk@2.3.4/dist/Artalk.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> head = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> meta = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;meta&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">name</span> = <span class="string">&#x27;referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">content</span> = <span class="string">&#x27;no-referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  head.<span class="title function_">appendChild</span>(meta)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (ispeak) &#123;</span></span><br><span class="line"><span class="language-javascript">    ispeak</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#ispeak&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">api</span>: <span class="string">&#x27;https://kkapi-dev.vercel.app/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">author</span>: <span class="string">&#x27;61fe93508fd621d39a155725&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">pageSize</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading_img</span>: <span class="string">&#x27;https://bu.dusays.com/2021/03/04/d2d5e983e2961.gif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">comment</span>: <span class="keyword">function</span> (<span class="params">speak</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 4.4.0 之后在此回调函数中初始化评论</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> &#123; _id, title, content &#125; = speak</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> contentSub = content.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">30</span>)</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">new</span> <span class="title class_">Artalk</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">el</span>: <span class="string">&#x27;.ispeak-comment&#x27;</span>, <span class="comment">// 默认情况下 ipseak 生成class为 ispeak-comment 的div</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">pageKey</span>: <span class="string">&#x27;/speak/info.html?q=&#x27;</span> + _id, <span class="comment">// 手动传入当前speak的唯一id</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">pageTitle</span>: title || contentSub, <span class="comment">// 手动传入当前speak的标题(由于content可能过长，因此截取前30个字符)</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">server</span>: <span class="string">&#x27;https://api.antmoe.com/artalk/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">site</span>: <span class="string">&#x27;speak&#x27;</span> <span class="comment">// 你的站点名</span></span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ispeak 加载完成&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">&#x27;ipseak依赖加载失败！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi.js.org/posts/ispeak/comment.html#%E8%AF%B4%E6%98%8E">官方设置评论</a>：</p>
<p><code>info.md</code>页面内容：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Speak</span><br><span class="line">date: 2022-08-21 14:11:00</span><br><span class="line">update: 2022-08-21 14:11:00</span><br><span class="line">top<span class="emphasis">_img: https://tva1.sinaimg.cn/large/005B3XPgly1ghkxqgvmy0j30zk0irn2q.jpg</span></span><br><span class="line"><span class="emphasis">aside: false</span></span><br><span class="line"><span class="emphasis">comments: false</span></span><br><span class="line"><span class="emphasis">description: 欢迎来到小康的Speak页面，快来看看小康分享了什么speak！</span></span><br><span class="line"><span class="emphasis">---</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&lt;!-- CSS --&gt;</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://unpkg.com/artalk@2.3.4/dist/Artalk.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/styles/atom-one-dark.min.css&quot;</span> /&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;content&#x27;</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://bu.dusays.com/2022/05/01/626e88f349943.gif&#x27;</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">&#123;% btn &#x27;https://www.antmoe.com/speak/&#x27;,查看全部,far fa-hand-point-right,block center blue larger %&#125;</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;ispeak-comment&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">&lt;!-- JS --&gt;</span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/artalk@2.3.4/dist/Artalk.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/marked@4.0.18/marked.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span></span><br><span class="line"><span class="emphasis">  const searchParams = new URLSearchParams(window.location.search);</span></span><br><span class="line"><span class="emphasis">  const speakId = searchParams.get(&#x27;q&#x27;);</span></span><br><span class="line"><span class="emphasis">  const path = window.location.pathname;</span></span><br><span class="line"><span class="emphasis">  const apiURL = &#x27;https://kkapi.vercel.app/api/ispeak&#x27;;</span></span><br><span class="line"><span class="emphasis">  const markedRender = (body, loading_</span>img=&#x27;https://bu.dusays.com/2022/05/01/626e88f349943.gif&#x27;) =&gt; &#123;</span><br><span class="line"><span class="code">    const renderer = &#123;</span></span><br><span class="line"><span class="code">      image(href, title, text) &#123;</span></span><br><span class="line"><span class="code">        return `&lt;a href=&quot;$&#123;href&#125;&quot; target=&quot;_blank&quot; data-fancybox=&quot;group&quot; class=&quot;fancybox&quot;&gt;</span></span><br><span class="line"><span class="code">            &lt;img speak-src=&quot;$&#123;href&#125;&quot; src=$&#123;loading_img&#125; alt=&#x27;$&#123;text&#125;&#x27;&gt;</span></span><br><span class="line"><span class="code">            &lt;/a&gt;`</span></span><br><span class="line"><span class="code">      &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">    marked.setOptions(&#123;</span></span><br><span class="line"><span class="code">      renderer: new marked.Renderer(),</span></span><br><span class="line"><span class="code">      highlight: function (code) &#123;</span></span><br><span class="line"><span class="code">        if (hljs) &#123;</span></span><br><span class="line"><span class="code">          return hljs.highlightAuto(code).value</span></span><br><span class="line"><span class="code">        &#125; else &#123;</span></span><br><span class="line"><span class="code">          return code</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">      &#125;,</span></span><br><span class="line"><span class="code">      pedantic: false,</span></span><br><span class="line"><span class="code">      gfm: true,</span></span><br><span class="line"><span class="code">      tables: true,</span></span><br><span class="line"><span class="code">      breaks: true,</span></span><br><span class="line"><span class="code">      sanitize: false,</span></span><br><span class="line"><span class="code">      smartLists: true,</span></span><br><span class="line"><span class="code">      smartypants: false,</span></span><br><span class="line"><span class="code">      xhtml: false</span></span><br><span class="line"><span class="code">    &#125;)</span></span><br><span class="line"><span class="code">    marked.use(&#123; renderer &#125;)</span></span><br><span class="line"><span class="code">    return marked.parse(body)</span></span><br><span class="line"><span class="code">  &#125;</span></span><br><span class="line"><span class="code">  fetch(`$&#123;apiURL&#125;/get/$&#123;speakId&#125;`)</span></span><br><span class="line"><span class="code">  .then(response =&gt; response.json())</span></span><br><span class="line"><span class="code">  .then(res =&gt; &#123;</span></span><br><span class="line"><span class="code">    const data = res.data;</span></span><br><span class="line"><span class="code">    if(data)&#123;</span></span><br><span class="line"><span class="code">      const &#123;title,content&#125; = data;</span></span><br><span class="line"><span class="code">      const contentSub = content.substring(0, 30);</span></span><br><span class="line"><span class="code">      document.querySelector(&#x27;.content&#x27;).innerHTML = markedRender(content);</span></span><br><span class="line"><span class="code">      if(title)&#123;</span></span><br><span class="line"><span class="code">        document.title = title;</span></span><br><span class="line"><span class="code">      &#125;</span></span><br><span class="line"><span class="code">      new Artalk(&#123;</span></span><br><span class="line"><span class="code">        el: &#x27;.ispeak-comment&#x27;,</span></span><br><span class="line"><span class="code">        pageKey: path + &#x27;?q=&#x27; + speakId,</span></span><br><span class="line"><span class="code">        pageTitle: title || contentSub,</span></span><br><span class="line"><span class="code">        server: &#x27;https://api.antmoe.com/artalk/&#x27;,</span></span><br><span class="line"><span class="code">        site: &#x27;speak&#x27;, // 你的站点名</span></span><br><span class="line"><span class="code">        useBackendConf: true,</span></span><br><span class="line"><span class="code">      &#125;)</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">  &#125;);</span></span><br><span class="line"><span class="code">  </span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>自用：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js-pjax&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span>ipseak加载中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js-pjax&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ispeak&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/styles/atom-one-dark.min.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">&quot;https://cdn1.tianli0.top/npm/ispeak@4.4.0/style.css&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#article-container</span> <span class="selector-class">.D-avatar</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.D-footer</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/marked/2.0.0/marked.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn1.tianli0.top/npm/ispeak@4.4.0/ispeak.umd.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> head = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> meta = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;meta&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">name</span> = <span class="string">&#x27;referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  meta.<span class="property">content</span> = <span class="string">&#x27;no-referrer&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  head.<span class="title function_">appendChild</span>(meta)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (ispeak) &#123;</span></span><br><span class="line"><span class="language-javascript">    ispeak</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#ispeak&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">api</span>: <span class="string">&#x27;https://kkapi-open-six.vercel.app/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">author</span>: <span class="string">&#x27;你的个人ID&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">pageSize</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading_img</span>: <span class="string">&#x27;https://bu.dusays.com/2022/05/01/626e88f349943.gif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">speakPage</span>: <span class="string">&#x27;/say&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">githubClientId</span>: <span class="string">&#x27;你的githubClientId&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">hideComment</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ispeak 加载完成&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tip&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">&#x27;ipseak依赖加载失败！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<ol>
<li>从v4.4.0的上一个版本v4.3.3就可以添加<code>hideComment: true,</code>隐藏评论</li>
<li><del>Artalk还未搭建好，故没有加入相关字段。</del>评论搞不定，算了。感觉说说没必要弄评论。只能用V4.3.3了，或者新版本关闭评论。</li>
</ol>
</blockquote>
<h2 id="首页轮播"><a href="#首页轮播" class="headerlink" title="首页轮播"></a>首页轮播</h2><p>参考上面，在Hexo博客目录中的<code>source/_data</code>（如果没有 _data 文件夹，请自行创建），创建一个文件 widget.yml，代码如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">latestBB</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Ispeak</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-bolt</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;swiper-container swiper-container-aside&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;swiper-wrapper swiper-weapper-aside&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;a class=&quot;bb-btn button--animated&quot; href=&quot;/say/&quot; title=&quot;查看全部&quot;&gt;&lt;i class=&quot;far fa-hand-point-right fa-fw&quot;&gt;&lt;/i&gt; 查看更多 &lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;script&gt;</span></span><br><span class="line"><span class="string">        window.kkBBConfig = &#123;</span></span><br><span class="line"><span class="string">          limit: 10,</span></span><br><span class="line"><span class="string">          blog:&#x27;/say/&#x27;,</span></span><br><span class="line"><span class="string">          api_url: &#x27;你的api地址（末尾不要/）&#x27;,</span></span><br><span class="line"><span class="string">          author: &#x27;你的个人ID&#x27;            </span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script src=&quot;https://cdn1.tianli0.top/npm/iwyang@1.0.8/speak/butterfly-speak-swiper@1.1.0.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>如若轮播j<code>js</code>CDN用不了，上面轮播<code>js</code>可改成本地：<code>/img/js/speak/butterfly-speak-swiper@1.1.0.min.js</code></p>
</blockquote>
<p>上面是自己瞎改的，不过能用。最后可以看上面<code>解决移动端二级菜单缩进问题</code>，解决缩进问题。<strong>下面是官方解答：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/kkfive/kkapi-open/issues/2">怎样使ispeak实现首页轮播</a></strong></p>
<blockquote>
<p>我个人的方法是通过挂载在侧边栏，然后侧边栏引用js动态插入顶部轮播位置。</p>
<p>参考代码：</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">latestBB</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Ispeak</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-bolt</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;swiper-container swiper-container-aside&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;swiper-wrapper swiper-weapper-aside&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;a class=&quot;bb-btn button--animated&quot; href=&quot;/speak/&quot; title=&quot;查看全部&quot;&gt;&lt;i class=&quot;far fa-hand-point-right fa-fw&quot;&gt;&lt;/i&gt; 查看更多 &lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;script&gt;</span></span><br><span class="line"><span class="string">        window.kkBBConfig = &#123;</span></span><br><span class="line"><span class="string">          limit: 9,</span></span><br><span class="line"><span class="string">          blog:&#x27;/speak&#x27;,</span></span><br><span class="line"><span class="string">          api_url: &#x27;api地址&#x27;,</span></span><br><span class="line"><span class="string">          author: &#x27;你的用户token&#x27;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;script src=&quot;https://cdn1.tianli0.top/npm/butterfly-speak-swiper@1.1.0/dist/index.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="去掉侧边栏最新说说-1"><a href="#去掉侧边栏最新说说-1" class="headerlink" title="去掉侧边栏最新说说"></a>去掉侧边栏最新说说</h3><p>在 <code>blog/source/css/custom.css</code> 文件中，加入以下代码即可。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 去掉侧边栏最新吐槽 */</span></span><br><span class="line"><span class="selector-class">.latestBB</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="发送speak方式"><a href="#发送speak方式" class="headerlink" title="发送speak方式"></a>发送speak方式</h2><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi-doc.vercel.app/posts/ispeak/send-mode.html">发送方式</a></p>
<h3 id="安卓手机上快捷方式发送"><a href="#安卓手机上快捷方式发送" class="headerlink" title="安卓手机上快捷方式发送"></a>安卓手机上快捷方式发送</h3><blockquote>
<p>此部分转自：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.leonus.cn/2022/talkInAndroid.html">https://blog.leonus.cn/2022/talkInAndroid.html</a></p>
</blockquote>
<h4 id="获取api的url"><a href="#获取api的url" class="headerlink" title="获取api的url"></a>获取api的url</h4><p>这个很好弄，只需要在你部署的API地址后面加上<code>/api/ispeak/addByToken</code>即可<br>如：<code>https://xxx.vercel.app/api/ispeak/addByToken</code>（不是后台的地址，而是api的地址，也就是你部署的时候第一个部署的那个）</p>
<h4 id="获取标签id"><a href="#获取标签id" class="headerlink" title="获取标签id"></a>获取标签id</h4><blockquote>
<p>用谷歌浏览器简单些，如果开发者工具是英语，可点击右上角小齿轮切换成中文。</p>
</blockquote>
<p>1.先登录到<code>Ispeak管理后台</code>，并切换到<code>Ispeak标签管理</code>。</p>
<p>2.然后按F12打开<code>开发者工具</code>，依次点击<code>Network(网络)</code>—<code>Fetch/XHR</code>—刷新网页—找到<code>getByPage...</code>(总共就两个，鼠标<strong>选择下面一个</strong>。)— 选中<code>响应</code>然后点击左下角的一个<code>&#123;&#125;</code>进行格式化（美观输出），我们分别复制id(name上面的id，不是user厘米俺的id，别弄混了)发送到手机即可(<strong>记清楚对应的标签</strong>，别到时候弄混了)<br>详细请看下图：</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/kzt.png"></p>
<h4 id="获取token网页端发送"><a href="#获取token网页端发送" class="headerlink" title="获取token网页端发送"></a>获取token网页端发送</h4><p>在后台的设置里，找到 设置 &gt; 个人设置 &gt; Tokens &gt; 添加token<br>标题填写<code>speak</code>，值随便填。将填写的值发送到手机。</p>
<h4 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h4><p>下载<code>HTTP Shortcuts</code>，可以直接使用谷歌搜索下载(推荐)<br>也可以通过Github下载：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Waboodoo/HTTP-Shortcuts/releases">https://github.com/Waboodoo/HTTP-Shortcuts/releases</a><br>不确定手机什么内核的可以下载<code>app-universal-release.apk</code></p>
<h4 id="添加变量"><a href="#添加变量" class="headerlink" title="添加变量"></a><strong>添加变量</strong></h4><p>1.点击右上角三个点 &gt; 变量，点击加号，选择<code>输入文本</code>，名称填<code>content</code>，标题可以填：说说内容，下面的对话框可填可不填，这都不是必须的。</p>
<p>输入选项选中<code>多行</code>,高级设置选中<code>JSON编码</code>，然后点右上角对号进行保存。</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/content.jpg"></p>
<p>2.再点击加号，选择<code>选项</code>，名称填<code>tag</code>，对话框标题可填：标签，然后添加选项。标签填写你的标签的名字，值填写你的标签对应的ID，然后点确定。<br>如果有多个标签可以继续添加，高级设置选中<code>JSON编码</code>，都添加完之后点右上角对号进行保存。</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/tags.jpg"></p>
<p>3.再点击加号，选择<code>选项</code>，名称填<code>type</code>，对话框标题可填：<code>可视范围</code>，然后添加以下3个选项。标签填写你的标签的名字，值填写<code>0</code>、<code>1</code>、<code>2</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.标签：公开         值：0</span><br><span class="line">2.标签：登录可见      值：1</span><br><span class="line">3.标签：仅自己        值：2</span><br></pre></td></tr></table></figure>

<p>填完后记得高级设置选中<code>JSON编码</code>，都添加完之后点右上角对号进行保存。</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/type.jpg"></p>
<h4 id="添加快捷方式"><a href="#添加快捷方式" class="headerlink" title="添加快捷方式"></a>添加快捷方式</h4><p>返回主页面，点击加号，选择最上面的<code>新建快捷方式</code>，名称随便，描述随便。</p>
<p>1.点击<code>基本设置</code>，方法选择<code>POST</code>，URL填写上面获取的<code>API的URL</code>，然后返回</p>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/kj.jpg"></p>
<p>2.点击<code>请求头</code>，点击加号，头部填写<code>Content-Type</code>，值填写<code>application/json</code>，确定然后返回</p>
<p>3.再点击<code>响应体/响应参数</code>，选择<code>自定义类型</code>，Content-Type填写<code>application/json</code>，请求体填写：(最好不要直接点复制按钮复制代码，直接拖动选择所有行代码，这样张贴就会保留空格)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;token&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你的token值&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;tag&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;content&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;type&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;showComment&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<div class="note warning flat"><p>注意：上面的<code>{tag}</code>和<code>{content}</code>以及<code>{type}</code>需要先删除，然后点击旁边的<code>{}</code>插入变量（插入的变量颜色是蓝色）。不能直接填写！！！<br>tag和content还有type顺序决定你发布时弹窗的先后，tag在上就是先选择标签再输入内容，content在上就是先输入内容再选择标签。</p>
</div>

<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/url.jpg"></p>
<p>全部填写完之后保存即可，点击快捷方式就可以实现发送说说了。<br>长按快捷方式可以将此快捷方式添加到桌面，想发说说时直接点击即可，方便至极。</p>
<h3 id="网页端发送"><a href="#网页端发送" class="headerlink" title="网页端发送"></a>网页端发送</h3><p>进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ispeak-biubiu.vercel.app/">ispeak-biubiu</a>页面，首先配置基础配置。</p>
<blockquote>
<ul>
<li>API地址：URL后面要加<code>/api</code></li>
<li>Token：token的名称必须为<code>speak</code></li>
</ul>
</blockquote>
<p><img src="/../img/hexo%E9%85%8D%E7%BD%AE%E5%93%94%E5%93%94%E7%82%B9%E5%95%A5&&Speak/speak.jpg"></p>
<h4 id="自己部署ispeak-biubiu"><a href="#自己部署ispeak-biubiu" class="headerlink" title="自己部署ispeak-biubiu"></a>自己部署<code>ispeak-biubiu</code></h4><p>仓库地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/kkfive/speak-biubiu">speak-biubiu</a>，（直接部署到Vercel不会，所以采用了一种笨方法）</p>
<p>1.首先fork一份备份，然后下载一份源码到本地，进入项目目录，执行以下命令（过程会很慢）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run build</span><br><span class="line">npm run preview</span><br></pre></td></tr></table></figure>
<p>2.然后将<code>dist</code> 这个文件夹里面的网页上传到GitHub，最后再部署到Vercel。</p>
<blockquote>
<p>ispeak-biubiu为Vite项目，更多使用说明查看：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cn.vitejs.dev/">https://cn.vitejs.dev/</a></p>
<p><strong>默认情况下，执行<code>npm run build</code>构建会输出到 <code>dist</code> 文件夹中。你可以部署这个 <code>dist</code> 文件夹到任何你喜欢的平台。</strong></p>
</blockquote>
<blockquote>
<p>PS：可以直接fork此仓库：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/iwyang/say">iwyang&#x2F;say</a>，然后部署到<code>Vercel</code></p>
</blockquote>
<h3 id="后台发送"><a href="#后台发送" class="headerlink" title="后台发送"></a>后台发送</h3><p>进入后台新增即可。<strong>更多发送方式查看：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://kkapi-doc.vercel.app/posts/ispeak/send-mode.html">发送方式</a></strong></p>
<h2 id="speak-amp-amp-twikoo-amp-amp-Verce域名绑定"><a href="#speak-amp-amp-twikoo-amp-amp-Verce域名绑定" class="headerlink" title="speak&amp;&amp;twikoo&amp;&amp;Verce域名绑定"></a>speak&amp;&amp;twikoo&amp;&amp;Verce域名绑定</h2><p><code>Vercel崩了，要绑定个二级域名才能用</code></p>
<ol>
<li><p>speak首页轮播api地址：<code>\source\_data\widget.yml</code>，改为可以访问的api url</p>
</li>
<li><p>speak页面api地址：<code>\source\say\index.md</code>，改为可以访问的api url</p>
</li>
<li><p>安卓快捷方式speak api地址，改为可以访问的api url</p>
</li>
<li><p>speak后台管理github秘钥：VITE_GLOB_API_URL改为可以访问的api url</p>
</li>
<li><p>speak后台、speak url发布 访问url，改为可以访问的url（还未更改）</p>
</li>
<li><p>twikoo envId地址：<code>_config.butterfly.yml</code>，改为可以访问的url</p>
</li>
<li><p>友链朋友圈api地址：<code>\source\fcircle\index.md</code>，改为可以访问的api url</p>
</li>
</ol>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://immmmm.com/bb-by-wechat-pro/">「哔哔点啥」微信公众号 2.0</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.fanziqi.site/posts/af935eab.html">手把手教你配置哔哔点啥</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://guole.fun/posts/bber-caikeng/">Android “捷径”・木木 bber 踩坑记录 + 电脑 or 手机 4 种方式直发说说</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.antmoe.com/posts/7ec820ee/">给 bber 换个皮肤</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://guole.fun/posts/butterfly-custom/#bber%E8%AF%B4%E8%AF%B4%E9%A6%96%E9%A1%B5%E8%BD%AE%E6%92%AD">bber说说首页轮播</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://gitlab.com/DreamyTZK/ispeak-bber/-/issues/2">bber的style导致’child menu items’缩进问题</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.leonus.cn/2022/bb.html">Hexo博客哔哔更换记录</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.ccknbc.cc/essay">短文 | CC的部落格</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://discuss.js.org/guide/Get-MongoDB-DataBase.html">申请免费的 MongoDB 数据库 | Discuss 开源免费评论系统</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.leonus.cn/2022/talkInAndroid.html">在安卓手机上快捷发送说说(哔哔)</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://braindance.top/posts/kkapi+ispeak%E8%AF%B4%E8%AF%B4%E9%A1%B5%E9%9D%A2%E9%83%A8%E7%BD%B2/">KKapi+ISpeak说说页面部署</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hugo/">hugo</a><a class="post-meta__tags" href="/tags/hexo/">hexo</a></div><div class="post_share"></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Bore</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/iwyang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:455343442@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/20475120" rel="external nofollow noreferrer" target="_blank" title="Bilibili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="/rss2.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎访问我的博客</div></div><div class="card-widget latestBB"><div class="item-headline"><i class="fas fa-bolt"></i><span>Ispeak</span></div><div class="item-content"><div class="swiper-container swiper-container-aside">
  <div class="swiper-wrapper swiper-weapper-aside"></div>
</div>
<a class="bb-btn button--animated" href="/say/" title="查看全部"><i class="far fa-hand-point-right fa-fw"></i> 查看更多 </a>
<script>
  window.kkBBConfig = {
    limit: 10,
    blog:'/say/',
    api_url: 'https://kkapi.bore.vip',
    author: '62e664654423f520964e0d43'            
  }
</script>
<script src="/img/js/speak/butterfly-speak-swiper@1.1.0.min.js"></script>
      
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">服务部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2"><span class="toc-number">2.</span> <span class="toc-text">前端部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2BBer-weixin%E5%85%AC%E4%BC%97%E5%8F%B7"><span class="toc-number">3.</span> <span class="toc-text">部署BBer-weixin公众号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E4%BC%97%E5%8F%B7%E5%8F%91%E5%B8%83%E8%AF%B4%E8%AF%B4"><span class="toc-number">4.</span> <span class="toc-text">公众号发布说说</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chrome-Edge-%E5%8F%91%E5%B8%83%E8%AF%B4%E8%AF%B4"><span class="toc-number">5.</span> <span class="toc-text">Chrome + Edge 发布说说</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%9C%AC%E5%9C%B0%E6%8F%92%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">安装本地插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%95%86%E5%BA%97%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-number">5.2.</span> <span class="toc-text">应用商店安装插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Android-%E6%8D%B7%E5%BE%84%E5%8F%91%E5%B8%83%E8%AF%B4%E8%AF%B4"><span class="toc-number">6.</span> <span class="toc-text">Android 捷径发布说说</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9ispeak-bber%E6%A0%B7%E5%BC%8F"><span class="toc-number">7.</span> <span class="toc-text">修改ispeak-bber样式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E9%A1%B5%E9%9D%A2%E6%A0%87%E9%A2%98"><span class="toc-number">7.1.</span> <span class="toc-text">隐藏页面标题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E9%A1%B6%E9%83%A8%E6%96%87%E5%AD%97"><span class="toc-number">7.2.</span> <span class="toc-text">修改顶部文字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D%E8%AF%B4%E8%AF%B4%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87%E6%97%B6%EF%BC%8C%E9%A1%B6%E9%83%A8%E7%A9%BA%E7%99%BD%E8%BF%87%E5%A4%A7%E9%97%AE%E9%A2%98"><span class="toc-number">7.3.</span> <span class="toc-text">修复说说出现图片时，顶部空白过大问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%85%AC%E4%BC%97%E5%8F%B7%E8%BF%9E%E7%BB%AD%E5%8F%91%E5%A4%9A%E5%BC%A0%E5%9B%BE%E7%89%87"><span class="toc-number">7.4.</span> <span class="toc-text">解决公众号连续发多张图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E6%98%BE%E7%A4%BA%E2%80%99%E4%B8%80%E5%91%A8%E5%89%8D%E2%80%99-%E2%80%99%E4%B8%80%E5%B0%8F%E6%97%B6%E5%89%8D%E2%80%99"><span class="toc-number">7.5.</span> <span class="toc-text">取消显示’一周前’,’一小时前’</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#butterfly-%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E9%A6%96%E9%A1%B5%E8%BD%AE%E6%92%AD"><span class="toc-number">8.</span> <span class="toc-text">butterfly 主题添加首页轮播</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-widget-yml"><span class="toc-number">8.1.</span> <span class="toc-text">创建 widget.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%8E%89%E4%BE%A7%E8%BE%B9%E6%A0%8F%E6%9C%80%E6%96%B0%E8%AF%B4%E8%AF%B4"><span class="toc-number">8.2.</span> <span class="toc-text">去掉侧边栏最新说说</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%95%E7%BC%A9%E8%BF%9B%E9%97%AE%E9%A2%98"><span class="toc-number">8.3.</span> <span class="toc-text">解决移动端二级菜单缩进问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Speak"><span class="toc-number">9.</span> <span class="toc-text">部署Speak</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E5%AE%89%E8%A3%85-MongoDB"><span class="toc-number">9.1.</span> <span class="toc-text">Docker 安装 MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kkapi-%E9%83%A8%E7%BD%B2"><span class="toc-number">9.2.</span> <span class="toc-text">kkapi 部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8kkapi"><span class="toc-number">9.3.</span> <span class="toc-text">开机启动kkapi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE"><span class="toc-number">9.4.</span> <span class="toc-text">配置域名访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kkapiadmin%EF%BC%88%E5%8F%AF%E8%A7%86%E5%8C%96%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0%EF%BC%89"><span class="toc-number">9.5.</span> <span class="toc-text">kkapiadmin（可视化管理后台）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF"><span class="toc-number">10.</span> <span class="toc-text">前端</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#v4-4-0%E4%BB%A5%E5%89%8D"><span class="toc-number">10.1.</span> <span class="toc-text">v4.4.0以前</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v4-4-0%E4%BB%A5%E5%90%8E"><span class="toc-number">10.2.</span> <span class="toc-text">v4.4.0以后</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E8%BD%AE%E6%92%AD"><span class="toc-number">11.</span> <span class="toc-text">首页轮播</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%8E%89%E4%BE%A7%E8%BE%B9%E6%A0%8F%E6%9C%80%E6%96%B0%E8%AF%B4%E8%AF%B4-1"><span class="toc-number">11.1.</span> <span class="toc-text">去掉侧边栏最新说说</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E9%80%81speak%E6%96%B9%E5%BC%8F"><span class="toc-number">12.</span> <span class="toc-text">发送speak方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%E6%89%8B%E6%9C%BA%E4%B8%8A%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%8F%91%E9%80%81"><span class="toc-number">12.1.</span> <span class="toc-text">安卓手机上快捷方式发送</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96api%E7%9A%84url"><span class="toc-number">12.1.1.</span> <span class="toc-text">获取api的url</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%A0%87%E7%AD%BEid"><span class="toc-number">12.1.2.</span> <span class="toc-text">获取标签id</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96token%E7%BD%91%E9%A1%B5%E7%AB%AF%E5%8F%91%E9%80%81"><span class="toc-number">12.1.3.</span> <span class="toc-text">获取token网页端发送</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E8%BD%AF%E4%BB%B6"><span class="toc-number">12.1.4.</span> <span class="toc-text">下载软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%8F%98%E9%87%8F"><span class="toc-number">12.1.5.</span> <span class="toc-text">添加变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"><span class="toc-number">12.1.6.</span> <span class="toc-text">添加快捷方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E7%AB%AF%E5%8F%91%E9%80%81"><span class="toc-number">12.2.</span> <span class="toc-text">网页端发送</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E9%83%A8%E7%BD%B2ispeak-biubiu"><span class="toc-number">12.2.1.</span> <span class="toc-text">自己部署ispeak-biubiu</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E5%8F%91%E9%80%81"><span class="toc-number">12.3.</span> <span class="toc-text">后台发送</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#speak-amp-amp-twikoo-amp-amp-Verce%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A"><span class="toc-number">13.</span> <span class="toc-text">speak&amp;&amp;twikoo&amp;&amp;Verce域名绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">14.</span> <span class="toc-text">参考链接</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/c6592a10/" title="Alist挂载网盘">Alist挂载网盘</a><time datetime="2024-04-06T09:19:21.000Z" title="发表于 2024-04-06 17:19:21">2024-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/e0c4249b/" title="彻底卸载onedrive">彻底卸载onedrive</a><time datetime="2023-09-03T12:41:26.000Z" title="发表于 2023-09-03 20:41:26">2023-09-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/26d4b8da/" title="debian 10安装xfce桌面和配置vnc和wine">debian 10安装xfce桌面和配置vnc和wine</a><time datetime="2023-07-18T11:36:29.000Z" title="发表于 2023-07-18 19:36:29">2023-07-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/12dd937c/" title="利用Github Actions自动同步Fork">利用Github Actions自动同步Fork</a><time datetime="2023-07-13T10:02:15.000Z" title="发表于 2023-07-13 18:02:15">2023-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/144e85ab/" title="office更改默认字体">office更改默认字体</a><time datetime="2023-07-02T13:02:25.000Z" title="发表于 2023-07-02 21:02:25">2023-07-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Bore</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.33"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('/pluginsSrc/pangu/dist/browser/pangu.min.js?v=4.0.7')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://t.bore.vip',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://t.bore.vip',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.staticfile.org/twikoo/1.6.41/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>